(self.webpackChunkvk=self.webpackChunkvk||[]).push([[12222],{961943:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});const s=(0,r(28178).makeIcon)("Icon20GearOutline","gear_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="gear_outline_20"><path fill-rule="evenodd" d="m7.222 3.378.01-.033a4.147 4.147 0 0 1 .17-.476c.358-.821.944-1.285 1.854-1.36l.166-.009h1.208c1.051.033 1.735.608 2.095 1.692l.057.186.044.166c.016.064.037.132.06.203l.05.137.03.015.06-.02.116-.044.135-.059a5.36 5.36 0 0 1 .168-.074l.036-.015a4.23 4.23 0 0 1 .424-.15c.932-.27 1.685-.075 2.32.618l.108.125.714.88c.636.833.617 1.723-.004 2.683l-.109.161-.102.139c-.04.054-.082.113-.123.177l-.062.1-.029.05.004.017.08.052.11.066.133.072c1.209.614 1.707 1.42 1.515 2.541l-.032.162-.213.916c-.137.593-.245.873-.67 1.258a2.135 2.135 0 0 1-1.059.518l-.01.003a3.917 3.917 0 0 1-.438.059l-.191.012-.173.006-.052.001h-.006c-.05.002-.102.006-.156.01l-.158.02.012.123.011.083.029.154c.068.322.101.618.098.89v.012c-.015.84-.38 1.45-1.132 1.87l-.147.076-1.023.494c-.901.403-1.722.234-2.484-.467a3.934 3.934 0 0 1-.144-.14l-.133-.142-.113-.13a2.938 2.938 0 0 0-.147-.161l-.085-.083-.043-.04-.08.076-.091.093-.103.115c-.828.981-1.703 1.334-2.763.923l-.153-.063-.915-.443-.271-.138c-.415-.225-.647-.44-.874-.918a2.153 2.153 0 0 1-.209-1.01v-.016c.006-.19.03-.388.07-.603l.038-.195.001-.004c.014-.064.025-.133.035-.206l.016-.148-.003-.003-.09-.012-.128-.012-.151-.006a4.145 4.145 0 0 1-.862-.098l-.012-.003c-.837-.198-1.363-.69-1.608-1.524l-.043-.16-.254-1.102c-.204-1.026.205-1.818 1.186-2.41l.17-.098.152-.08c.06-.03.123-.065.188-.105l.134-.087.004-.017-.055-.093-.07-.108-.089-.124a5.194 5.194 0 0 1-.286-.423c-.54-.905-.534-1.72.046-2.523l.1-.132.717-.877c.687-.792 1.566-.958 2.64-.554l.18.072.158.07a2.9 2.9 0 0 0 .193.08l.118.042.032-.014.029-.077.04-.12.04-.143c.013-.056.028-.112.044-.166Zm4.24.841.013.038.05.138a1.5 1.5 0 0 0 .743.833l.03.014a1.5 1.5 0 0 0 1.136.082l.06-.02a1.47 1.47 0 0 0 .065-.023l.117-.044.062-.025.135-.059.035-.015a2.698 2.698 0 0 1 .415-.16c.268-.078.407-.06.47-.043.057.015.16.056.314.22l.077.09.682.84c.138.185.15.295.15.359 0 .084-.03.267-.225.573l-.082.122-.08.108a4.406 4.406 0 0 0-.18.26l-.014.022-.062.099-.008.013-.01.018-.03.05a1.5 1.5 0 0 0-.178 1.056l.004.017a1.5 1.5 0 0 0 .648.959l.08.052.05.032.11.066.06.034.133.072.034.018c.456.231.62.421.676.516.036.06.084.162.042.417l-.023.117-.207.892c-.066.285-.095.35-.105.369 0 0 0 .003-.01.013a.974.974 0 0 1-.101.103c-.082.074-.166.124-.354.161a2.357 2.357 0 0 1-.257.035l-.153.01-.138.004-.071.002a4.554 4.554 0 0 0-.28.02l-.158.019a1.5 1.5 0 0 0-1.318 1.628l.011.123.008.07.012.083.01.06.028.154.008.045c.05.236.068.419.066.557-.003.206-.046.301-.073.348-.028.046-.094.131-.276.235l-.105.056-.977.471c-.204.088-.317.082-.382.07-.076-.015-.228-.068-.456-.279a2.382 2.382 0 0 1-.08-.076l-.1-.107-.088-.102a4.389 4.389 0 0 0-.217-.236l-.018-.018-.084-.082a1.433 1.433 0 0 0-.036-.034l-.043-.04a1.5 1.5 0 0 0-2.047.014l-.08.075a1.43 1.43 0 0 0-.042.041l-.09.094a1.534 1.534 0 0 0-.048.05l-.103.116-.025.03c-.315.371-.532.495-.646.535-.073.025-.183.05-.415-.038l-.094-.039-.864-.418-.238-.12a1.186 1.186 0 0 1-.13-.083l-.004-.003-.003-.003a1.077 1.077 0 0 1-.083-.147.666.666 0 0 1-.063-.34c.003-.09.015-.207.043-.365l.035-.174a4.384 4.384 0 0 0 .058-.35l.016-.149a1.5 1.5 0 0 0-.434-1.224l-.004-.003a1.5 1.5 0 0 0-.86-.423l-.09-.012a1.405 1.405 0 0 0-.064-.008l-.128-.01a1.539 1.539 0 0 0-.068-.005l-.15-.007-.04-.001a2.663 2.663 0 0 1-.549-.06c-.215-.05-.305-.115-.346-.154-.04-.038-.109-.12-.17-.319l-.03-.114-.242-1.052c-.042-.224-.006-.329.023-.387.038-.076.146-.23.459-.42l.128-.074.119-.063a4.431 4.431 0 0 0 .316-.179l.134-.087a1.5 1.5 0 0 0 .65-.947l.004-.017a1.5 1.5 0 0 0-.171-1.066l-.055-.093a1.49 1.49 0 0 0-.037-.062l-.07-.108a1.496 1.496 0 0 0-.04-.057l-.088-.124a1.516 1.516 0 0 0-.024-.031c-.307-.406-.369-.647-.378-.754-.006-.067-.004-.18.148-.395l.072-.094.684-.838c.154-.173.262-.211.33-.225.09-.018.28-.027.623.1l.138.055.123.055a4.42 4.42 0 0 0 .316.13l.118.042a1.5 1.5 0 0 0 1.134-.058l.031-.015a1.5 1.5 0 0 0 .764-.823l.03-.077.023-.066.04-.12.02-.065.04-.143.01-.037.03-.119c.037-.128.076-.235.114-.323.1-.23.192-.319.243-.357.044-.033.134-.086.343-.105l.1-.006h1.14c.234.01.333.071.386.114.067.056.192.195.308.538l.043.14.034.129c.026.1.056.2.088.298ZM10 11.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm0 1.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},819169:(e,t,r)=>{"use strict";r.d(t,{POLLING_VERSION:()=>a,MINIMUM_TIME_INTERVAL_API:()=>n,CaptchaType:()=>s});var s,a=10,n=1133;!function(e){e.API="API",e.DIRECT_AUTH="DIRECT_AUTH",e.IMPLICIT_FLOW_AUTH="IMPLICIT_FLOW_AUTH",e.ACCOUNT_VERIFICATION="ACCOUNT_VERIFICATION"}(s||(s={}))},737204:(e,t,r)=>{"use strict";r.d(t,{APIError:()=>n});var s=r(250500),a=r(458656);class n extends a.VKError{constructor(e){var t=Number(e.error_code);switch(super({code:t,message:`Code №${t} - ${e.error_msg}`}),this.params=e.request_params,t===s.API_ERROR_CAPTCHA&&(this.captchaSid=Number(e.captcha_sid),this.captchaImg=e.captcha_img),t){case s.API_ERROR_CAPTCHA:this.captchaSid=Number(e.captcha_sid),this.captchaImg=e.captcha_img;break;case s.API_ERROR_AUTH_VALIDATION:this.redirectUri=e.redirect_uri;break;case s.API_ERROR_NEED_CONFIRMATION:this.confirmationText=e.confirmation_text}}}},488006:(e,t,r)=>{"use strict";r.d(t,{ExecuteError:()=>a});var s=r(737204);class a extends s.APIError{constructor(e){super({error_code:e.error_code,error_msg:e.error_msg,request_params:[]}),this.method=e.method}}},364058:(e,t,r)=>{"use strict";r.d(t,{OAuthError:()=>a});var s=r(458656);class a extends s.VKError{constructor(e){super({code:e.error,message:e.error_description})}}},396817:(e,t,r)=>{"use strict";r.d(t,{UpdatesError:()=>a});var s=r(458656);class a extends s.VKError{}},458656:(e,t,r)=>{"use strict";var s;r.d(t,{SharedErrorCode:()=>s,VKError:()=>a}),function(e){e.UNSUPPORTED_MODE="UNSUPPORTED_MODE",e.MISSING_CAPTCHA_HANDLER="MISSING_CAPTCHA_HANDLER",e.MISSING_TOKEN_REGENERATE_HANDLER="MISSING_TOKEN_REGENERATE_HANDLER"}(s||(s={}));class a extends Error{constructor(e){var t=e.code;super(e.message),this.code=t,this.name=this.constructor.name}}},992741:(e,t,r)=>{"use strict";r.d(t,{CallbackService:()=>a});var s=r(458656);class a{get hasCaptchaHandler(){return void 0!==this.captchaHandler}onCaptcha(e){return this.captchaHandler=e,this}processingCaptcha(e){var t=this.captchaHandler;return t?new Promise(((r,s)=>{t(e,(e=>new Promise(((t,a)=>{if(e instanceof Error)return a(e),void s(e);r({key:e,validate:{resolve:t,reject:a}})}))))})):Promise.reject(new s.VKError({code:s.SharedErrorCode.MISSING_CAPTCHA_HANDLER,message:"Missing captcha handler"}))}get hasTokenRegenerateHandler(){return void 0!==this.tokenRegenerateHandler}onTokenRegenerate(e){return this.tokenRegenerateHandler=e,this}processingTokenRegenerate(){var e=this.tokenRegenerateHandler;return void 0===e?Promise.reject(new s.VKError({code:s.SharedErrorCode.MISSING_TOKEN_REGENERATE_HANDLER,message:"Missing token regenerate handler"})):new Promise(((t,r)=>{e((e=>new Promise(((s,a)=>{if(e instanceof Error)return a(e),void r(e);t({token:e,validate:{resolve:s,reject:a}})}))))}))}}},430041:(e,t,r)=>{"use strict";r.d(t,{EventDispatcher:()=>s});class s{constructor(){this.listeners=[]}hasEventListener(e,t){return this.listeners.some((r=>r.type===e&&r.listener===t))}addEventListener(e,t,r){return void 0===r&&(r={}),this.hasEventListener(e,t)||this.listeners.push({type:e,listener:t,options:r}),this}removeEventListener(e,t){var r=this.listeners.findIndex((r=>r.type===e&&r.listener===t));return-1!==r&&this.listeners.splice(r,1),this}removeEventListeners(){return this.listeners=[],this}dispatchEvent(e){return this.listeners.filter((t=>t.type===e.type)).forEach((t=>{var r=t.type,s=t.listener,a=t.options.once;s.call(this,e),a&&this.removeEventListener(r,s)})),this}}},218517:(e,t,r)=>{"use strict";r.d(t,{APIRequest:()=>s.APIRequest,CallbackService:()=>a.CallbackService});var s=r(670973),a=r(992741)},670973:(e,t,r)=>{"use strict";r.d(t,{APIRequest:()=>c});var s=r(887757),a=r(692137),n=r(722122),i=r(363476),o=r(144636),d=r(792269);class c{constructor(e){var t,r=e.api,s=e.method,a=e.params,i=void 0===a?{}:a,o=e.options,d=void 0===o?{}:o;this.retries=0,this.api=r,this.method=s,this.params=(0,n.default)({},i),this.options=(0,n.default)({},d),null!=(t=this.options).abortController||(t.abortController=new AbortController),this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}toString(){return(0,d.getExecuteMethod)(this.method,this.params)}get filteredParams(){var e=this.api.options,t=e.token,r=e.version,s=e.language;return Object.fromEntries([...Object.entries((0,n.default)({v:r,lang:s,access_token:t},this.params)),...this.api.globalParams.entries()].filter((e=>void 0!==e[1])))}make(){var e=this;return(0,a.default)(s.mark((function t(){var r,a,n;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.api.options,a=r.timeout,n=r.requestMethod,e.timeout=setTimeout((()=>{var t;return null==(t=e.options.abortController)?void 0:t.abort()}),a),t.prev=2,t.next=5,e[n]();case 5:return t.abrupt("return",t.sent);case 6:return t.prev=6,clearTimeout(e.timeout),t.finish(6);case 9:case"end":return t.stop()}}),t,null,[[2,,6,9]])})))()}fetch(){var e=this.options.abortController,t=this.api.options.baseUrl;return fetch(new URL(`/method/${this.method}`,t),{method:"POST",signal:null==e?void 0:e.signal,headers:{connection:"keep-alive"},body:new URLSearchParams(this.filteredParams)}).then((e=>e.json()))}bridge(){var e=this.options.abortController;return new Promise(((t,r)=>{(null==e?void 0:e.signal.aborted)&&r(e.signal.reason),null==e||e.signal.addEventListener("abort",(()=>{r(e.signal.reason)})),i.send("VKWebAppCallAPIMethod",{method:this.method,params:this.filteredParams}).then(t).catch((e=>{var r=e.error_data;t({error:(null==r?void 0:r.error_reason)||r||e})}))}))}script(){var e=this.options.abortController,t=this.api.options.baseUrl;return new Promise(((r,s)=>{(null==e?void 0:e.signal.aborted)&&s(e.signal.reason);var a=(0,o.generateId)(20),n=new URLSearchParams(this.filteredParams);n.set("callback",a);var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=new URL(`/method/${this.method}?${n}`,t).toString(),window[a]=e=>{i.remove(),delete window[a],r(e)},null==e||e.signal.addEventListener("abort",(()=>{i.remove(),delete window[a],s(e.signal.reason)})),document.head.appendChild(i)}))}}},455835:(e,t,r)=>{"use strict";r(667294)},137395:(e,t,r)=>{"use strict";r.d(t,{APIRequestMode:()=>i,API:()=>w,VKError:()=>v.VKError,UpdatesSource:()=>h.UpdatesSource,VmojiQueueEventType:()=>h.VmojiQueueEventType,getRandomId:()=>m.getRandomId});var s,a,n,i,o,d=r(722122),c=r(746283),u=r(218517),l=r(314809),p=r(829432),g=r(33019),h=r(87862),v=(r(364058),r(396817),r(488006),r(458656)),m=(r(737204),r(455835),r(670793));r(787302),r(729117);function f(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var s=0;return function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}!function(e){e.PARALLEL="parallel",e.SEQUENTIAL="sequential"}(n||(n={})),function(e){e.SEQUENTIAL="sequential",e.BURST="burst"}(i||(i={})),function(e){e.FETCH="fetch",e.SCRIPT="script",e.BRIDGE="bridge"}(o||(o={}));var _="undefined"!=typeof window&&(null==(s=window.vk)||null==(a=s.apiConfigDomains)?void 0:a.apiDomain)||"api.vk.com";class w extends u.CallbackService{constructor(e,t){var r;void 0===t&&(t={}),super(),r=this,this.globalParams=new Map,this.options=(0,d.default)({mode:n.SEQUENTIAL,requestMode:i.SEQUENTIAL,requestMethod:o.FETCH,wait:3e3,limit:3,bridge:!1,version:c.API_VERSION,baseUrl:`https://${_}`,retryLimit:3,timeout:6e4,executeCount:25,language:"ru",executeUnsupportedMethods:["photos.save","photos.saveWallPhoto","photos.saveOwnerPhoto","photos.saveMessagesPhoto","messages.setChatPhoto","photos.saveMarketPhoto","photos.saveMarketAlbumPhoto","audio.save","docs.save","photos.saveOwnerCoverPhoto","stories.save","polls.savePhoto"]},e);for(var s,a=function(e){r[e]=new Proxy(Object.create(null),{get:(t,s)=>(t,a)=>r.callWithRequest(new u.APIRequest({api:r,method:`${e}.${s}`,params:t,options:a}))})},l=f(g.methodGroups);!(s=l()).done;){a(s.value)}this.worker=this.getWorker(),this.updates=new h.Updates(this,t)}execute(e){return this.call("execute",e)}procedure(e,t){return this.call(`execute.${e}`,t)}call(e,t){return this.callWithRequest(new u.APIRequest({method:e,params:t,api:this}))}callWithRequest(e){return this.worker.enqueue(e),e.promise}getWorker(){switch(this.options.mode){case n.PARALLEL:return new l.ParallelWorker(this);case n.SEQUENTIAL:return new p.SequentialWorker(this)}}}},33019:(e,t,r)=>{"use strict";r.d(t,{methodGroups:()=>s});var s=["account","actionLinks","address","adex","admins","ads","adsint","adsweb","aliexpress","antispam","appWidgets","apps","articles","asr","audio","audioSearch","auth","autotests","badges","bestFriends","biz","board","bot","botsConf","bugtracker","calls","captcha","cashout","catalog","channels","classifieds","combo","coupons","crowd","database","deliveryClub","docs","documentation","donut","downloadedGames","education","educationForeign","educationParents","educationPolls","educationUser","email","esia","exchange","exchangeRates","execute","experts","explore","externalAudioMatching","externalUsers","fave","finance","findMe","forbiddenRegistry","fortuneSquare","fortuneWheel","friends","gamesPromo","getUserInfo","getUserInfoEx","gifts","golunch","goodsOrders","groups","healthApp","healthCommon","healthLoyalty","identity","instManager","interests","internal","leadForms","leads","lifeEvents","likes","lovina","loyalty","loyaltyTeen","market","marusia","masks","matching","memories","messages","microlandings","mobile","money","musicManager","narratives","newsfeed","nft","nospam","notes","notifications","odnoklassniki","onboarding","orders","pages","phones","photos","places","platform","platformConsole","podcasts","podcastsOffice","polls","prettyCards","promoCodes","questions","queue","reports","restore","rewardedAds","rightholders","search","secure","serverCalls","serverEffects","settings","shortVideo","signals","situationalSuggests","sms","social","specials","statEvents","stats","statsDashboard","status","storage","store","stories","streaming","studentsVerification","studio","superApp","support","survey","tags","tariffs","textlives","tickets","translations","uma","users","utils","uxpolls","verification","video","videoPostcards","vkCharity","vkMusic","vkRun","vkStart","vkTaxi","vkUp","vkdrive","vkstore","vmoji","voicerooms","wall","weather","widgets","widgetsIOS","widgetsKit","wishlists"]},823919:(e,t,r)=>{"use strict";r.d(t,{VmojiQueueEvent:()=>s.VmojiQueueEvent,VmojiQueueEventType:()=>s.VmojiQueueEventType});var s=r(143211)},143211:(e,t,r)=>{"use strict";var s;r.d(t,{VmojiQueueEventType:()=>s,VmojiQueueEvent:()=>a}),function(e){e.AVATAR="avatar",e.STICKERS="stickers",e.CHARACTER="character",e.STICKERS_PRINT_REQUEST="stickers_print_request"}(s||(s={}));class a extends CustomEvent{constructor(e,t){super(e,{detail:t})}}},87862:(e,t,r)=>{"use strict";r.d(t,{UpdatesSource:()=>s,Updates:()=>f,VmojiQueueEventType:()=>p.VmojiQueueEventType});var s,a,n,i=r(722122),o=r(419756),d=r(887757),c=r(692137),u=r(396817),l=r(430041),p=r(823919),g=r(470060),h=r(819169);function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var s=0;return function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}!function(e){e.USER="user",e.GROUP="group",e.VMOJI="vmoji"}(s||(s={})),function(e){e.CHECK="a_check",e.RELEASE="a_release"}(a||(a={})),function(e){e.NEED_RESTART="NEED_RESTART",e.POLLING_REQUEST_FAILED="POLLING_REQUEST_FAILED"}(n||(n={}));class f extends l.EventDispatcher{constructor(e,t){void 0===t&&(t={}),super(),this.mode=202,this.started=!1,this.ts=0,this.pts=0,this.restarted=0,this.api=e;var r=t,s=r.source,a=r.userId,n=r.groupId,i=r.wait,o=r.retryLimit;this.source=s,this.userId=a,this.groupId=n,this.wait=i||3e3,this.retryLimit=o||3}start(){var e=this;return(0,c.default)(d.mark((function t(){var r,n,i,o;return d.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.started){t.next=2;break}return t.abrupt("return");case 2:return e.started=!0,t.prev=3,t.next=6,e.getLongPollServer();case 6:r=t.sent,n=r.server,i=r.key,o=r.ts,0===e.ts&&(e.ts=o),e.url=new URL(n),e.url.searchParams.set("key",i),e.url.searchParams.set("act",a.CHECK),e.url.searchParams.set("wait","25"),e.url.searchParams.set("mode",String(e.mode)),e.url.searchParams.set("version",String(h.POLLING_VERSION)),t.t0=e.source,t.next=t.t0===s.VMOJI?20:22;break;case 20:return e.url.searchParams.set("id",String(e.userId)),t.abrupt("break",22);case 22:e.startFetchLoop(),t.next=29;break;case 25:throw t.prev=25,t.t1=t.catch(3),e.started=!1,t.t1;case 29:case"end":return t.stop()}}),t,null,[[3,25]])})))()}getLongPollServer(){var e=this;return(0,c.default)(d.mark((function t(){var r,a;return d.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.source,t.next=t.t0===s.GROUP?3:t.t0===s.VMOJI?7:(t.t0,s.USER,11);break;case 3:return t.next=5,e.api.groups.getLongPollServer({group_id:e.groupId});case 5:case 9:case 13:return r=t.sent,t.abrupt("break",15);case 7:return t.next=9,e.api.vmoji.subscribeToQueue().then((e=>{var t=e.base_url,r=(0,o.default)(e,["base_url"]);return(0,i.default)({server:t},r)}));case 11:return t.next=13,e.api.messages.getLongPollServer({lp_version:h.POLLING_VERSION});case 15:return a=r.server,r.server=`${a.startsWith("https")?"":"https://"}${a}`,t.abrupt("return",r);case 18:case"end":return t.stop()}}),t)})))()}stop(){var e=this;return(0,c.default)(d.mark((function t(){return d.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.started=!1,e.restarted=0;case 2:case"end":return t.stop()}}),t)})))()}startFetchLoop(){var e=this;return(0,c.default)(d.mark((function t(){return d.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0;case 1:if(!e.started){t.next=6;break}return t.next=4,e.fetchUpdates();case 4:t.next=1;break;case 6:t.next=33;break;case 8:if(t.prev=8,t.t0=t.catch(0),t.t0.code===n.NEED_RESTART||e.restarted===e.retryLimit){t.next=16;break}return e.restarted+=1,t.next=14,(0,g.wait)(3e3);case 14:return e.startFetchLoop(),t.abrupt("return");case 16:if(!e.started){t.next=33;break}return t.prev=17,t.next=20,e.stop();case 20:return t.next=22,e.start();case 22:return t.abrupt("break",33);case 25:return t.prev=25,t.t1=t.catch(17),console.log(t.t1),e.started=!0,t.next=31,(0,g.wait)(e.wait);case 31:t.next=16;break;case 33:case"end":return t.stop()}}),t,null,[[0,8],[17,25]])})))()}fetchUpdates(){var e=this;return(0,c.default)(d.mark((function t(){var r,s,a,i,o,c,l;return d.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.url.searchParams.set("ts",String(e.ts)),r=new AbortController,s=setTimeout((()=>r.abort()),3e4),t.prev=3,t.next=6,fetch(e.url,{method:"GET",signal:r.signal,headers:{connection:"keep-alive"}});case 6:if((i=t.sent).ok){t.next=9;break}throw new u.UpdatesError({code:n.POLLING_REQUEST_FAILED,message:"Polling request failed"});case 9:return t.next=11,i.json();case 11:a=t.sent;case 12:return t.prev=12,clearTimeout(s),t.finish(12);case 15:if(void 0===a.failed){t.next=21;break}if(1!==a.failed){t.next=19;break}return e.ts=a.ts,t.abrupt("return");case 19:throw e.ts=0,new u.UpdatesError({code:n.NEED_RESTART,message:"The server has been failed"});case 21:for(e.restarted=0,e.ts=a.ts,a.pts&&(e.pts=Number(a.pts)),a.updates=a.updates||a.events||[],o=v(a.updates);!(c=o()).done;)l=c.value,e.handleUpdate(l);case 26:case"end":return t.stop()}}),t,null,[[3,,12,15]])})))()}handleUpdate(e){if(this.source===s.VMOJI){var t=e.data,r=t.type,a=t.query_id;a&&this.dispatchEvent(new p.VmojiQueueEvent(a,t)),this.dispatchEvent(new p.VmojiQueueEvent(r,t))}}}},144636:(e,t,r)=>{"use strict";function s(e){for(var t="abcdefghijklmnopqrstuvwxyz",r="",s=0;s<e;s++)r+=t.charAt(Math.floor(Math.random()*t.length));return r}r.d(t,{generateId:()=>s})},729117:(e,t,r)=>{"use strict";var s;r(363476);!function(e){e.WALL="wall",e.DOCS="docs",e.STATS="stats",e.VIDEO="video",e.PAGES="pages",e.NOTES="notes",e.MANAGE="manage",e.MARKET="market",e.PHOTOS="photos",e.STATUS="status",e.GROUPS="groups",e.OFFLINE="offline",e.STORIES="stories",e.FRIENDS="friends",e.MESSAGES="messages",e.APP_WIDGET="app_widget"}(s||(s={}))},8087:(e,t,r)=>{"use strict";function s(e){return`return [${e.join(",")}];`}r.d(t,{getChainReturn:()=>s})},792269:(e,t,r)=>{"use strict";r.d(t,{getExecuteMethod:()=>a});var s=r(951017);function a(e,t){return void 0===t&&(t={}),`API.${e}(${(0,s.getExecuteParams)(t)})`}},951017:(e,t,r)=>{"use strict";function s(e){return JSON.stringify(e,((t,r)=>"object"==typeof r&&r!==e?String(r):r))}r.d(t,{getExecuteParams:()=>s})},787302:(e,t,r)=>{"use strict";r(887757),r(692137),r(737204),r(364058),r(470060)},670793:(e,t,r)=>{"use strict";function s(){return Math.floor(1e4*Math.random())*Date.now()}r.d(t,{getRandomId:()=>s})},13841:(e,t,r)=>{"use strict";function s(e,t){var r=0;t.response.forEach(((s,a)=>{var n=e[a];!1===s?(n.reject(t.errors[r]),r++):n.resolve(s)}))}r.d(t,{resolveExecuteTask:()=>s})},470060:(e,t,r)=>{"use strict";function s(e){return new Promise((t=>{setTimeout(t,e)}))}r.d(t,{wait:()=>s})},314809:(e,t,r)=>{"use strict";r.d(t,{ParallelWorker:()=>l});var s=r(887757),a=r(692137),n=r(218517),i=r(829432),o=r(8087),d=r(13841);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var s=0;return function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}class l extends i.SequentialWorker{execute(){var e=()=>super.execute,t=this;return(0,a.default)(s.mark((function r(){var a,i,u,l,p,g,h;return s.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=t.queue,!t.isAllowedMethod(a[0].method)){r.next=4;break}return e().call(t),r.abrupt("return");case 4:i=t.api.options.executeCount,u=[],l=0;case 7:if(!(l<t.queue.length)){r.next=17;break}if(!t.isAllowedMethod(a[l].method)){r.next=10;break}return r.abrupt("continue",14);case 10:if(u.push(a.splice(l,1)[0]),l-=1,!(u.length>=i)){r.next=14;break}return r.abrupt("break",17);case 14:l+=1,r.next=7;break;case 17:if(0!==u.length){r.next=19;break}return r.abrupt("return");case 19:return p=new n.APIRequest({api:t.api,method:"execute",params:{code:(0,o.getChainReturn)(u.map(String))}}),e().call(t,p),r.prev=21,r.t0=d.resolveExecuteTask,r.t1=u,r.next=26,p.promise;case 26:r.t2=r.sent,(0,r.t0)(r.t1,r.t2),r.next=33;break;case 30:for(r.prev=30,r.t3=r.catch(21),g=c(u);!(h=g()).done;)h.value.reject(r.t3);case 33:case"end":return r.stop()}}),r,null,[[21,30]])})))()}isAllowedMethod(e){return e.startsWith("execute")||this.api.options.executeUnsupportedMethods.includes(e)}}},829432:(e,t,r)=>{"use strict";r.d(t,{SequentialWorker:()=>l});var s=r(887757),a=r(692137),n=r(250500),i=r(349805),o=r(737204),d=r(488006),c=r(470060),u=r(819169);class l extends i.APIWorker{execute(e){var t=this;return(0,a.default)(s.mark((function r(){var a,n,i,u,l,p;return s.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e||(e=t.queue.shift()),e){r.next=3;break}return r.abrupt("return");case 3:return i=e.method,r.prev=4,r.next=7,e.make();case 7:u=r.sent,r.next=22;break;case 10:if(r.prev=10,r.t0=r.catch(4),l=t.api.options,e.retries!==l.limit){r.next=17;break}return null==(p=e.captchaValidate)||p.reject(r.t0),e.reject(r.t0),r.abrupt("return");case 17:return e.retries+=1,r.next=20,(0,c.wait)(l.wait);case 20:return t.requeue(e),r.abrupt("return");case 22:if(void 0===u.error){r.next=25;break}return t.handleError(e,new o.APIError(u.error)),r.abrupt("return");case 25:if(null==(a=e.captchaValidate)||a.resolve(),!i.startsWith("execute")){r.next=29;break}return e.resolve({response:u.response,errors:(u.execute_errors||[]).map((e=>new d.ExecuteError(e)))}),r.abrupt("return");case 29:e.resolve(null!=(n=u.response)?n:u);case 30:case"end":return r.stop()}}),r,null,[[4,10]])})))()}handleError(e,t){var r=this;return(0,a.default)(s.mark((function a(){var i,o,d,l,p,g,h,v,m,f;return s.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if((d=t.code)!==n.API_ERROR_TOO_MANY){s.next=11;break}if(!r.paused){s.next=5;break}return r.requeue(e),s.abrupt("return");case 5:return r.pause(),s.next=8,(0,c.wait)(u.MINIMUM_TIME_INTERVAL_API);case 8:return r.requeue(e),r.resume(),s.abrupt("return");case 11:if(null==(i=e.captchaValidate)||i.reject(t),null==(o=e.tokenRegenerateValidate)||o.reject(t),d!==n.API_ERROR_CAPTCHA||!r.api.hasCaptchaHandler){s.next=31;break}return s.prev=14,l=t.captchaSid,s.next=18,r.api.processingCaptcha({type:u.CaptchaType.API,src:t.captchaImg,sid:l,request:e});case 18:p=s.sent,g=p.key,h=p.validate,e.captchaValidate=h,e.params.captcha_sid=l,e.params.captcha_key=g,r.requeue(e),s.next=30;break;case 27:s.prev=27,s.t0=s.catch(14),e.reject(s.t0);case 30:return s.abrupt("return");case 31:if(d!==n.API_ERROR_AUTH||!r.api.hasTokenRegenerateHandler){s.next=47;break}return s.prev=32,s.next=35,r.api.processingTokenRegenerate();case 35:v=s.sent,m=v.token,f=v.validate,r.api.options.token=m,e.tokenRegenerateValidate=f,r.requeue(e),s.next=46;break;case 43:s.prev=43,s.t1=s.catch(32),e.reject(s.t1);case 46:return s.abrupt("return");case 47:e.reject(t);case 48:case"end":return s.stop()}}),a,null,[[14,27],[32,43]])})))()}}},349805:(e,t,r)=>{"use strict";r.d(t,{APIWorker:()=>n});var s=r(137395),a=r(819169);class n{constructor(e){this.busy=!1,this.paused=!1,this.queue=[],this.api=e,this.intervalPerRequests=Math.ceil(a.MINIMUM_TIME_INTERVAL_API/this.api.options.limit)}enqueue(e){this.queue.push(e),this.immediateHeat()}requeue(e){this.queue.unshift(e),this.immediateHeat()}pause(){this.paused=!0}resume(){this.paused=!1,this.immediateHeat()}heat(){if(!this.paused&&!this.busy&&this.queue.length)switch(this.busy=!0,this.api.options.requestMode){case s.APIRequestMode.SEQUENTIAL:this.execute(),setTimeout((()=>{this.busy=!1,this.immediateHeat()}),this.intervalPerRequests);break;case s.APIRequestMode.BURST:for(var e=Math.min(this.api.options.limit,this.queue.length),t=0;t<e&&0!==this.queue.length;t+=1)this.execute();var r=Math.ceil(a.MINIMUM_TIME_INTERVAL_API-e*this.intervalPerRequests);setTimeout((()=>{this.busy=!1,this.immediateHeat()}),r<=0?a.MINIMUM_TIME_INTERVAL_API:r)}}immediateHeat(){setTimeout((()=>this.heat()))}}},197501:(e,t,r)=>{"use strict";r.d(t,{WebStatEvents:()=>d});var s=r(887757),a=r(692137),n=r(189798),i=r(137395),o=r(248018);var d=new class{constructor(){var e;this.userId="undefined"!=typeof window&&(null==(e=window.vk)?void 0:e.id)||0,this.queue=new Set,this.initialized=!1}setAPI(e){this.api=e}setUserId(e){this.userId=e}add(e){var t=this;return(0,a.default)(s.mark((function r(){var a;return s.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.init();case 2:null!=e.id||(e.id=(0,i.getRandomId)()),null!=e.prev_id||(e.prev_id=null==(a=t.previousEvent)?void 0:a.id),null!=e.timestamp||(e.timestamp=String((0,o.nowMicroseconds)())),"undefined"!=typeof window&&(null!=e.url||(e.url=window.location.href)),e.type_navgo&&t.previousNavigationEvent&&(e.type_navgo.prev_navgo_id=t.previousNavigationEvent.id,e.type_navgo.prev_navgo_timestamp=t.previousNavigationEvent.timestamp),t.previousEvent=e,e.type_navgo&&(t.previousNavigationEvent=e),t.queue.add(e),t.send();case 11:case"end":return r.stop()}}),r)})))()}init(){var e=this;return(0,a.default)(s.mark((function t(){var r,o;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.initialized){t.next=2;break}return t.abrupt("return");case 2:if(e.initialized=!0,!e.api){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,(0,n.login)("web_token").catch((()=>{}));case 7:if(r=t.sent){t.next=11;break}return e.initialized=!1,t.abrupt("return");case 11:o=r.access_token,e.api=new i.API({token:o}),e.api.onTokenRegenerate(function(){var t=(0,a.default)(s.mark((function t(r){var a,i;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,n.login)("web_token").catch((()=>{}));case 2:if(a=t.sent){t.next=6;break}return e.initialized=!1,t.abrupt("return");case 6:i=a.access_token,r(i);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 14:case"end":return t.stop()}}),t)})))()}send(){this.api&&this.queue.size&&(this.api.statEvents.addWeb({events:JSON.stringify([...this.queue.values()]),user_id:this.userId}),this.queue.clear())}}},248018:(e,t,r)=>{"use strict";r.d(t,{nowMicroseconds:()=>a});var s=performance.timeOrigin||performance.timing.navigationStart||Date.now();function a(){return Math.floor(1e3*(s+performance.now()))}},746408:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});const s={counter:"BadgeCounter-module__counter--RLCgS"}},833223:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});const s={root:"BadgeItem-module__root--NDr99",wrapper:"BadgeItem-module__wrapper--Dk1KX"}},391342:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});const s={root:"BadgeItems-module__root--G6uJV"}},532013:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});const s={items:"BadgesOwnerBlockSkeleton-module__items--j4QSs"}},784637:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});const s={card:"BadgesOwnerInfoCard-module__card--RGQgs",preview:"BadgesOwnerInfoCard-module__preview--PQEuE",title:"BadgesOwnerInfoCard-module__title--fa7Jo",description:"BadgesOwnerInfoCard-module__description--XYkSi",users:"BadgesOwnerInfoCard-module__users--IahmE"}},598872:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});const s={items:"BadgesOwnerInfoModal-module__items--QIXCF",counter:"BadgesOwnerInfoModal-module__counter--G6cIu",body:"BadgesOwnerInfoModal-module__body--GxnQm",settings:"BadgesOwnerInfoModal-module__settings--ERtTg",previewItems:"BadgesOwnerInfoModal-module__previewItems--GUGep",previewItem:"BadgesOwnerInfoModal-module__previewItem--izjjE",preview:"BadgesOwnerInfoModal-module__preview--TOuL8",previewImage:"BadgesOwnerInfoModal-module__previewImage--WCuFZ",previewTitle:"BadgesOwnerInfoModal-module__previewTitle--qSCls",previewDescription:"BadgesOwnerInfoModal-module__previewDescription--bouGo"}},404887:(e,t,r)=>{"use strict";r.d(t,{getUserFullName:()=>s});const s=e=>{const{first_name:t,last_name:r}=e;return`${t} ${r}`}},372418:(e,t,r)=>{"use strict";r.d(t,{BadgeCounter:()=>o});var s=r(570655),a=r(785893),n=r(86894),i=r(746408);const o=e=>{var t=(0,s.__rest)(e,[]);return(0,a.jsx)(n.Counter,Object.assign({className:i.default.counter,mode:"inherit"},t),void 0)}},22340:(e,t,r)=>{"use strict";r.d(t,{BadgeSenderItem:()=>l});var s=r(570655),a=r(785893),n=r(197501),i=r(86894),o=r(608021),d=r(342269),c=r(799336),u=r(404887);function l(e){var{entry:t,user:{id:r,first_name:l,last_name:p,domain:g,photo_100:h,photo_200:v}}=e,m=(0,s.__rest)(e,["entry","user"]);const f=(0,u.getUserFullName)({first_name:l,last_name:p}),b=((0,d.isRetina)()?v:h)||h||"";let _=null;return t.object_description&&(_=(0,c.parseReactWikiLinks)(t.object_description,{target:"_blank"})),_=(0,a.jsxs)(a.Fragment,{children:[_,(0,a.jsx)("br",{},void 0),o.getLang("awards_private_text")]},void 0),(0,a.jsx)(i.RichCell,Object.assign({before:(0,a.jsx)(i.Avatar,{size:100,src:b,title:f},void 0),caption:_,href:g?`/${g}`:void 0,target:"_blank",onClick:()=>{n.WebStatEvents.add({screen:"badge",type:"type_click",type_click:{type:"type_badges_screen_item",item:{type:"badges",id:r},type_badges_screen_item:{type_badges_event:{event_name:"open_sender"}}}})}},m,{children:f}),void 0)}},590790:(e,t,r)=>{"use strict";r.d(t,{BadgeItemWrapper:()=>o,BadgeItem:()=>d});var s=r(785893),a=r(334606),n=r(372418),i=r(833223);const o=({children:e})=>(0,s.jsx)("div",Object.assign({className:i.default.wrapper},{children:e}),void 0),d=({badge:e,counter:t})=>{if(!e)return null;const r=(0,a.getBadgeImage)(e.image,128);return(0,s.jsx)(o,{children:(0,s.jsx)("div",Object.assign({style:{backgroundImage:`url('${r}')`},className:i.default.root},{children:(0,s.jsx)(n.BadgeCounter,Object.assign({size:"s"},{children:t}),void 0)}),void 0)},void 0)}},814672:(e,t,r)=>{"use strict";r.d(t,{BadgeItems:()=>d});var s=r(785893),a=r(667294),n=r(86894),i=r(590790),o=r(391342);const d=({counters:e,badges:t,onClick:r})=>{const d=(0,a.useMemo)((()=>((null==e?void 0:e.filter((e=>"total"!==e.type)))||[]).map((({value:e,badge_id:r})=>{if(!r)return null;const a=t.find((({id:e})=>r===e));return(0,s.jsx)(i.BadgeItem,{counter:e,badge:a},r)}))),[e,t]);return(0,s.jsx)(n.HorizontalScroll,Object.assign({arrowSize:"m"},{children:(0,s.jsx)("div",Object.assign({className:o.default.root,onClick:r,tabIndex:0,role:"button"},{children:d}),void 0)}),void 0)}},933275:(e,t,r)=>{"use strict";r.d(t,{BadgesOwnerBlockSkeleton:()=>l});var s=r(785893),a=r(667294),n=r(495882),i=r(86894),o=r(659397),d=r(590790),c=r(532013);const u=(0,o.createArray)(4),l=e=>{const t=(0,a.useMemo)((()=>u.map(((e,t)=>(0,s.jsx)(d.BadgeItemWrapper,{children:(0,s.jsx)(n.Skeleton,{width:56,height:56,circle:!0},void 0)},t)))),[56,4]);return(0,s.jsx)(i.Group,Object.assign({header:(0,s.jsx)(i.Header,{children:(0,s.jsx)(n.Skeleton,{width:192},void 0)},void 0)},e,{children:(0,s.jsx)("div",Object.assign({className:c.default.items},{children:t}),void 0)}),void 0)}},999386:(e,t,r)=>{"use strict";r.d(t,{BadgesOwnerInfoCard:()=>c});var s=r(785893),a=r(86894),n=r(70162),i=r(334606),o=r(372418),d=r(784637);const c=({badge:e,counter:t,recentSenderUsers:r,sendersCount:c,onClick:u})=>{const l=null==r?void 0:r.slice(0,3).map((({photo_200:e})=>String(e)));return(0,s.jsxs)(a.Tappable,Object.assign({className:d.default.card,onClick:u},{children:[(0,s.jsx)("div",Object.assign({className:d.default.preview,"aria-label":e.title,style:{backgroundImage:`url('${(0,i.getBadgeImage)(e.image,128)}')`}},{children:(0,s.jsx)(o.BadgeCounter,{children:t},void 0)}),void 0),(0,s.jsx)(a.Title,Object.assign({className:d.default.title,level:"2",weight:"1"},{children:e.title}),void 0),(0,s.jsx)(a.Text,Object.assign({className:d.default.description,weight:"3"},{children:e.description}),void 0),Boolean(r.length)&&(0,s.jsx)("div",Object.assign({className:d.default.users},{children:(0,s.jsx)(a.UsersStack,Object.assign({size:"m",photos:l},{children:n.getLang("awards_senders_count",c).replace("{count}",String(c))}),void 0)}),void 0)]}),void 0)}},521518:(e,t,r)=>{"use strict";r.d(t,{BadgesOwnerInfoModal:()=>x});var s=r(785893),a=r(667294),n=r(844142),i=r(189798),o=r(197501),d=r(420637),c=r(961943),u=r(86894),l=r(531286),p=r(809177),g=r(623122),h=r(651024),v=r(999386),m=r(22340),f=r(372418),b=r(226323),_=r(70162),w=r(334606),I=r(254581),E=r(598872);class x extends a.Component{constructor(e){super(e),this.selectBadge=e=>{e&&o.WebStatEvents.add({screen:"badge",type:"type_navgo",type_navgo:{type:"type_badges_screen_item",subtype:"go",item:{type:"badges",id:e,owner_id:this.props.ownerId},type_badges_screen_item:{type_badges_event:{event_name:"open_badges_collection_badge__"+(n.Ranges.isUserId(this.props.ownerId)?"u":"c")}}}}),this.setState({currentBadgeId:e})};const{isAdmin:t=!1}=e;this.state={isOwnerInfoLoaded:!1,totalCount:0,counters:[],badges:{},users:{},currentBadgeId:null,loadedBadgeEntries:{},isAdmin:t}}componentDidMount(){o.WebStatEvents.add({screen:"badge",type:"type_navgo",type_navgo:{type:"type_badges_screen_item",subtype:"go",item:{type:"badges",owner_id:this.props.ownerId},type_badges_screen_item:{type_badges_event:{event_name:"open_badges_collection_all__"+(n.Ranges.isUserId(this.props.ownerId)?"u":"c")}}}}),this.fetchOwnerInfo()}componentDidUpdate(){const{currentBadgeId:e}=this.state;e&&!this.getBadgeEntries(e)&&this.fetchOwnerEntries()}fetchOwnerInfo(){const{ownerId:e}=this.props;(0,i.api)("badges.getOwnerInfo",{owner_id:e,with_senders:1,fields:"photo_100,photo_200,domain"}).then((({owner_info:e,badges:t,users:r})=>{var s;this.setState({isOwnerInfoLoaded:!0,totalCount:(null===(s=((null==e?void 0:e.counters)||[]).find((e=>"total"===e.type)))||void 0===s?void 0:s.value)||0,counters:((null==e?void 0:e.counters)||[]).filter((e=>"total"!==e.type)),badges:x.convertBadges(t||[]),users:x.convertUsers(r||[])})})).catch((e=>{var t;this.props.close(),(0,b.topError)((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.error_msg)||_.getLang("global_unknown_error"))}))}fetchOwnerEntries(){const{ownerId:e}=this.props,{loadedBadgeEntries:t,currentBadgeId:r}=this.state;if(!r)return;const s=this.getBadgeEntries(r),a={fields:"photo_100,photo_200,domain"};(null==s?void 0:s.next_query)?Object.assign(a,{query:s.next_query}):Object.assign(a,{owner_id:e,badge_id:r,count:100}),(0,i.api)("badges.getOwnerEntries",a).then((({entries:e,badges:a,next_query:n,users:i})=>{this.setState({users:Object.assign(Object.assign({},this.state.users),x.convertUsers(i||[])),badges:Object.assign(Object.assign({},this.state.badges),x.convertBadges(a||[])),loadedBadgeEntries:Object.assign(Object.assign({},t),{[r]:{entries:[...(null==s?void 0:s.entries)||[],...e||[]],next_query:n}})})})).catch((e=>{var t;this.props.close(),(0,b.topError)((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.error_msg)||_.getLang("global_unknown_error"))}))}renderHeader(){const{isOwnerInfoLoaded:e,currentBadgeId:t,isAdmin:r}=this.state,{ownerId:a}=this.props;return(0,s.jsx)(l.ModalHeader,Object.assign({closeAriaLabel:_.getLang("awards_back_button"),onClose:this.props.close,before:e&&t&&(0,s.jsxs)(p.ModalHeaderButton,Object.assign({"aria-label":_.getLang("awards_back_button"),onClick:()=>this.selectBadge(null)},{children:[(0,s.jsx)(d.default,{},void 0),_.getLang("awards_back_button")]}),void 0),after:r&&(0,s.jsx)(u.Link,Object.assign({className:E.default.settings,href:(()=>{const e=`${location.protocol}//${window.vk.host}`;let t;return n.Ranges.isGroupId(a)?(t=new URL(`public${Math.abs(a)}`,e),t.searchParams.set("act","sections")):(t=new URL("settings",e),t.searchParams.set("act","privacy"),t.searchParams.set("hl","badges")),t.toString()})(),target:"_blank"},{children:(0,s.jsx)(c.default,{},void 0)}),void 0)},{children:e&&!t?this.renderHeaderTitle():null}),void 0)}renderHeaderTitle(){const{ownerId:e}=this.props,{totalCount:t}=this.state,r=t>0?(0,s.jsx)("span",Object.assign({className:E.default.counter},{children:t}),void 0):null;return(0,s.jsxs)(s.Fragment,{children:[e===window.vk.id?_.getLang("awards_my_badges"):_.getLang("awards_profile_block_header")," ",r]},void 0)}renderContent(){const{counters:e,currentBadgeId:t}=this.state;return t?this.renderBadgeInfo():(0,s.jsx)("div",Object.assign({className:E.default.items},{children:e.map((({badge_id:e,value:t,recent_sender_ids:r,senders_count:a},n)=>(0,s.jsx)(v.BadgesOwnerInfoCard,{badge:this.getBadgeById(e||0),counter:t,recentSenderUsers:this.getUsersById(r||[]),sendersCount:a||0,onClick:()=>this.selectBadge(e||null)},n)))}),void 0)}renderBadgeInfo(){var e,t;const{currentBadgeId:r,counters:a}=this.state,n=this.getBadgeEntries(r||0),i=this.getBadgeById(r||0),o=(null===(e=a.find((e=>e.badge_id===r)))||void 0===e?void 0:e.value)||0;return n?(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",Object.assign({className:E.default.preview},{children:[(0,s.jsx)("div",Object.assign({className:E.default.previewImage,"aria-label":i.title,style:{backgroundImage:`url('${(0,w.getBadgeImage)(i.image,100)}')`}},{children:(0,s.jsx)(f.BadgeCounter,{children:o},void 0)}),void 0),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Title,Object.assign({className:E.default.previewTitle,level:"2",weight:"2"},{children:i.title}),void 0),(0,s.jsx)(u.Text,Object.assign({className:E.default.previewDescription,weight:"3"},{children:i.description}),void 0)]},void 0)]}),void 0),(0,s.jsx)(u.Spacing,{size:25},void 0),(0,s.jsx)(u.Separator,{},void 0),(0,s.jsx)(u.Spacing,{size:25},void 0),(0,s.jsx)(I.ReexportInfiniteScroll,Object.assign({className:E.default.previewItems,hasMore:Boolean(n.next_query),loadMore:this.fetchOwnerEntries},{children:null===(t=n.entries)||void 0===t?void 0:t.map(((e,t)=>{const r=e.sender_id;return r?(0,s.jsx)(m.BadgeSenderItem,{className:E.default.previewItem,entry:e,user:this.getUserById(r)},t):null}))}),void 0)]},void 0):(0,s.jsx)(u.Spinner,{},void 0)}getBadgeById(e){return this.state.badges[e]}getUserById(e){return this.state.users[e]}getUsersById(e){return e.map((e=>this.getUserById(e)))}getBadgeEntries(e){return this.state.loadedBadgeEntries[e]}static convertBadges(e){return e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.id]:t})),{})}static convertUsers(e){return e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.id]:t})),{})}render(){const{isOwnerInfoLoaded:e}=this.state;return(0,s.jsxs)(g.ModalBox,{children:[this.renderHeader(),(0,s.jsx)(u.CustomScrollView,{children:(0,s.jsx)(h.ModalBody,Object.assign({className:E.default.body},{children:e?this.renderContent():(0,s.jsx)(u.Spinner,{},void 0)}),void 0)},void 0)]},void 0)}}},522581:(e,t,r)=>{"use strict";r.d(t,{GroupBadges:()=>m});var s=r(785893),a=r(667294),n=r(86894),i=r(99656),o=r(126827),d=r(832678),c=r(189798),u=r(629401),l=r(70162),p=r(814672),g=r(163703),h=r(371063),v=r(452645);const m=(0,g.withErrorBoundary)((e=>{var t,r,g;const{ownerId:m,isAdmin:f}=e,[b,_]=(0,a.useState)(),[w,I]=(0,a.useState)(d.LoadingStatus.pending);if((0,a.useEffect)((()=>{I(d.LoadingStatus.pending),(0,c.api)("badges.getOwnerInfo",{fields:String(["photo_100","photo_200","domain"]),owner_id:m}).then(_).then((()=>{I(d.LoadingStatus.loaded)})).catch((e=>{I(d.LoadingStatus.failed),(0,v.badgesLogger)("Failed badges.getOwnerInfo in GroupBadges",e)}))}),[m]),w!==d.LoadingStatus.loaded&&w!==d.LoadingStatus.failed)return(0,s.jsx)(h.BadgesOwnerBlockSkeleton,{separator:"hide"},void 0);if(!(null===(t=null==b?void 0:b.badges)||void 0===t?void 0:t.length)||w===d.LoadingStatus.failed)return null;const{badges:E,owner_info:x}=b,k=(null===(g=null===(r=null==x?void 0:x.counters)||void 0===r?void 0:r.find((e=>"total"===e.type)))||void 0===g?void 0:g.value)||0,O=()=>{(0,u.initBadgesOwnerInfo)({ownerId:m,isAdmin:f})};return(0,s.jsx)(i.AppRootProvider,Object.assign({viewWidth:n.ViewWidth.DESKTOP},{children:(0,s.jsx)(n.Group,Object.assign({header:(0,s.jsx)(o.Header,Object.assign({indicator:k,onClick:O},{children:l.getLang("awards_profile_block_header")}),void 0),separator:"hide"},{children:(0,s.jsx)(p.BadgeItems,{badges:E,counters:null==x?void 0:x.counters,onClick:O},void 0)}),void 0)}),void 0)}))},163703:(e,t,r)=>{"use strict";r.d(t,{withErrorBoundary:()=>d});var s=r(785893),a=r(667294),n=r(86894),i=r(70162),o=r(452645);function d(e){return t=>(0,s.jsx)(c,{children:(0,s.jsx)(e,Object.assign({},t),void 0)},void 0)}class c extends a.Component{constructor(){super(...arguments),this.state={hasError:!1,isReloading:!1},this.onClick=()=>{this.setState({isReloading:!0}),window.nav.reload({force:!0})}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){(0,o.badgesLogger)("Rendering error has happened in component GroupBadges",e)}render(){return this.state.hasError?(0,s.jsx)(n.Group,Object.assign({separator:"hide"},{children:(0,s.jsx)(n.Placeholder,Object.assign({header:i.getLang("global_error"),action:(0,s.jsx)(n.Button,Object.assign({mode:"tertiary",loading:this.state.isReloading,onClick:this.onClick},{children:i.getLang("global_reload")}),void 0)},{children:i.getLang("awards_group_block_unknown_error")}),void 0)}),void 0):this.props.children}}},371063:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BadgesOwnerInfo:()=>u,BadgesOwnerBlockSkeleton:()=>d.BadgesOwnerBlockSkeleton,GroupBadges:()=>c.GroupBadges});var s=r(785893),a=r(521518),n=r(452645),i=r(856330),o=r(832678),d=r(933275),c=r(522581);const u={init(e,t){e?(0,i.showMessageBoxModal)((({onClose:r})=>(0,s.jsx)(a.BadgesOwnerInfoModal,{ownerId:e,isAdmin:t,close:r},void 0)),{width:o.BADGES_BOX_WIDTH}):(0,n.badgesLogger)(`Wrong arguments: ownerId=${e}`)}}},832678:(e,t,r)=>{"use strict";r.d(t,{BADGES_BOX_WIDTH:()=>s,LINK_TO_HELP_FOR_AUTHORS:()=>a,ERRORS:()=>n,BadgesEventRef:()=>i,BADGE_COMMENT_SELECTOR:()=>o,LoadingStatus:()=>d});const s=640,a="/@authors-badges";var n,i;!function(e){e[e.ERROR_PARAM=100]="ERROR_PARAM",e[e.NEED_CONFIRMATION=24]="NEED_CONFIRMATION",e[e.BALANCE=504]="BALANCE"}(n||(n={})),function(e){e.TAB="tab",e.SENDER_LIST="sender_list"}(i||(i={}));const o="BadgeComment";var d;!function(e){e[e.pending=0]="pending",e[e.loaded=1]="loaded",e[e.failed=2]="failed"}(d||(d={}))},334606:(e,t,r)=>{"use strict";r.d(t,{getBadgeImage:()=>n,getBadgesStackHTMLForPost:()=>i,buildHtmlAttributesString:()=>o});var s=r(342269),a=r(873589);function n(e,t,r=!1){const{base_url:a,version:n}=e,i=n?`?${n}`:"";return!r&&(0,s.isRetina)()&&(t*=2),`${a}/${t}.png${i}`}function i(e,t,r){return r?(0,a.rs)(r,{object_owner_id:e,object_id:t}):""}const o=e=>Object.entries(e).reduce(((e,[t,r])=>{if(r){e+=` ${t}="${(0,s.escapeAttr)(String(r))}"`}return e}),"")},254581:(e,t,r)=>{"use strict";r.d(t,{ReexportInfiniteScroll:()=>s});const s=r(468916).default},380401:(e,t,r)=>{"use strict";r.d(t,{tqOpenBadgesObjectInfo:()=>l,initBadgesTqInteractiveHandlers:()=>p,initGroupBadgesTq:()=>g,initStartupBadgesStackTq:()=>h});var s=r(785893),a=r(182804),n=r(629401),i=r(973935),o=r(371063),d=r(45722),c=r(997109),u=r(511417);const l=()=>{(0,a.tq)().setInteractiveHandler("Badges/openBadgesObjectInfo",(e=>{if(!e.payload.dataAttrs)return;const{badgeId:t,objectType:r,objectOwnerId:s,objectId:a}=e.payload.dataAttrs;if(!r||!s||!a)throw new Error("No required attributes in tq Badges/openBadgesObjectInfo");(0,n.initBadgesObjectInfo)(Number(r),Number(s),Number(a),Number(t))}))},p=()=>{l(),(0,a.tq)().setInteractiveHandler("Badges/openBadgesCatalog",(e=>{if(!e.payload.dataAttrs)return;const{objectType:t,objectOwnerId:r,objectId:s,eventRef:a}=e.payload.dataAttrs;if(!t||!r||!s)throw new Error("No required attributes in tq Badges/openBadgesCatalog");(0,n.initBadgesCatalog)(Number(t),Number(r),Number(s),a)}))},g=()=>{(0,a.tq)().setStartupHandler("BadgesOwner/render_group_badges",(e=>{const{data:{owner_id:t,is_admin:r},target:a}=e.payload;a&&void 0!==t&&(0,d.isBadgesEnabled)()&&(i.render((0,s.jsx)(o.GroupBadges,{ownerId:Number(t),isAdmin:Boolean(r)},void 0),a),(0,c.pushNavDestroy)((()=>i.unmountComponentAtNode(a))))}))},h=()=>{(0,a.tq)().setStartupHandler("BadgesStack/init",(e=>{const{target:t}=e.payload;t&&u.colorScheme.subscribe((()=>{t.querySelectorAll(".BadgesStackItem").forEach((e=>{let t=e.src;const{srcLight:r=t,srcDark:s=t}=e.dataset;t=u.colorScheme.isDarkScheme()?s:r,e.src=t}))}))}))}},629401:(e,t,r)=>{"use strict";r.d(t,{initBadgesTqInteractiveHandlers:()=>o.initBadgesTqInteractiveHandlers,initStartupBadgesStackTq:()=>o.initStartupBadgesStackTq,initBadgesCatalog:()=>d,initBadgesObjectInfo:()=>c,initBadgesOwnerInfo:()=>u,loadBadgesWallOnboarding:()=>l});var s=r(452645),a=r(659397),n=r(45722),i=r(501389),o=r(380401);const d=(e,t,o,d)=>{(0,n.isBadgesEnabled)()&&((0,i.showBoxLoader)(),(window.BadgesCatalog?Promise.resolve():(0,a.asyncImportLoader)((()=>Promise.all([r.e(56990),r.e(98066),r.e(18669)]).then(r.bind(r,281172)))).then((({BadgesCatalog:e})=>{window.BadgesCatalog=e}))).then((()=>window.BadgesCatalog.init(e,t,o,d))).catch((e=>{(0,s.badgesLogger)("Error loading module BadgesCatalog",e)})).finally((()=>{(0,i.hideBoxLoader)()})))},c=(e,t,o,d,c)=>{(0,n.isBadgesEnabled)()&&((0,i.showBoxLoader)(),(window.BadgesObjectInfo?Promise.resolve():(0,a.asyncImportLoader)((()=>Promise.all([r.e(98066),r.e(83803)]).then(r.bind(r,474859)))).then((({BadgesObjectInfo:e})=>{window.BadgesObjectInfo=e}))).then((()=>window.BadgesObjectInfo.init(e,t,o,d,c))).catch((e=>{(0,s.badgesLogger)("Error loading module BadgesObjectInfo",e)})).finally((()=>{(0,i.hideBoxLoader)()})))},u=e=>{if(!(0,n.isBadgesEnabled)())return;(0,i.showBoxLoader)();const{ownerId:t,isAdmin:o}=e;(window.BadgesOwnerInfo?Promise.resolve():(0,a.asyncImportLoader)((()=>Promise.resolve().then(r.bind(r,371063)))).then((({BadgesOwnerInfo:e})=>{window.BadgesOwnerInfo=e}))).then((()=>window.BadgesOwnerInfo.init(t,o))).catch((e=>{(0,s.badgesLogger)("Error loading module BadgesOwnerInfo",e)})).finally((()=>{(0,i.hideBoxLoader)()}))},l=({target:e})=>{(0,n.isBadgesEnabled)()&&(0,a.asyncImportLoader)((()=>r.e(9603).then(r.bind(r,464329)))).then((({initBadgesWallOnboarding:t})=>{t({target:e})})).catch((e=>{(0,s.badgesLogger)("Error loading module badges_wall_onboarding_init",e)}))}},452645:(e,t,r)=>{"use strict";r.d(t,{badgesLogger:()=>a});var s=r(66433);const a=(e,t)=>{window.vk.dev&&console.log(t),(0,s.logError)(new Error(e),{environment:"badges"})}},45722:(e,t,r)=>{"use strict";r.d(t,{isBadgesEnabled:()=>a});var s=r(506770);const a=()=>(0,s.partConfigEnabled)("web2_badges")&&(0,s.partConfigEnabled)("badges")}}]);try{stManager.done("dist/2bba2d07471d8f28f7731036759051f9.2089cb0bd32ce5414e47.js")}catch(e){}