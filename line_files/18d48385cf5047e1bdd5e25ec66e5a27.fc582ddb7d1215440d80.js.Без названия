(self.webpackChunkvk=self.webpackChunkvk||[]).push([[88869],{189214:(e,t,r)=>{"use strict";function a(e){var t=new Date;return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function o(e){return a(new Date(e.getTime()+864e5))}function s(e){return a(new Date(e.getTime()-864e5))}r.d(t,{isToday:()=>a,isTomorrow:()=>s,isYesterday:()=>o})},939008:(e,t,r)=>{"use strict";r.d(t,{initLang:()=>o,langNumeric:()=>n,langSex:()=>s,langWordNumeric:()=>i});var a;r(189214);function o(e){e.source,a=e.config}function s(e,t){if(!Array.isArray(t))return t;var r=a(),o=t[1];return r?(r.sexRules.some((function(r){return"*"===r[0]||e==r[0]&&t[r[1]]?(o=t[r[1]],!0):void 0})),o):o}function n(e,t,r){var o,s=a();if(!t||!s)return e;Array.isArray(t)?(o=t[1],e!==Math.floor(e)?o=t[s.numRules.float]:s.numRules.int.some((function(r){if("*"===r[0])return o=t[r[2]],!0;var a=r[0]?e%r[0]:e;return Array.isArray(r[1])&&-1!==r[1].indexOf(a)?(o=t[r[2]],!0):void 0}))):o=t;var n=e+"";if(r){for(var i=e.toString().split("."),u=[],c=i[0].length-3;c>-3;c-=3)u.unshift(i[0].slice(c>0?c:0,c+3));i[0]=u.join(s.numDel),n=i.join(s.numDec)}return o=(o||"%s").replace("%s",n)}function i(e,t,r){return Array.isArray(t)&&e<t.length?t[e]:n(e,r)}},760484:(e,t,r)=>{"use strict";r.d(t,{Lang:()=>c});var a=r(722122),o=r(939008),s=r(659397),n=r(997864),i=r(701069),u="reforged-lang-debug";class c{constructor(e,t){var r=this;this.logger=void 0,this.translations=void 0,this.isDebug=!1,this.locale=void 0,this.decodedKeys={},this.toggleDebug=()=>{this.isDebug=!this.isDebug;try{this.isDebug?localStorage.setItem(u,"true"):localStorage.removeItem(u)}catch(e){}window.location.reload()},this.use=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];return r.fold(e,(e=>e),(e=>e.join("")),...a)},this.fold=function(e,t,s){if(r.isDebug)return t(e);try{var n=arguments.length<=3?void 0:arguments[3],i=r.getTemplate(e);if(!i)return t(e);if(!n)return Array.isArray(i)?t(e):t(i);if("num"in n)n.values=(0,a.default)({formatted:r.formatNumber(n.num,n.formatted)},n.values||{}),"short"===n.formatted&&(n.num=Math.min(1e3,n.num)),i="fallback"in n?(0,o.langWordNumeric)(n.num,i,r.getTemplate(n.fallback)).toString():(0,o.langNumeric)(n.num,i).toString();else if("sex"in n){var u={female:"1",male:"2",unknown:"*"};i=(0,o.langSex)(u[n.sex],i)}else if("now"in n){var c=new Date(n.now),l=new Date(n.date);i=h(c,l)?i[3]:m(c,l)?i[2]:p(c,l)?i[4]:i[1],n.values=(0,a.default)({},r.splitDate(l,{shortMonths:n.shortMonths,genMonths:n.genMonths,capMonths:n.capMonths,shortWeekdays:n.shortWeekdays}),{},n.values||{})}if(Array.isArray(i)||!i)return t(e);if("values"in n&&Object.keys(n.values).length>0){var d=g.Grammar.tryParse(i),f=(e,r)=>{switch(r.type){case"StaticPlaceholder":var a=n.values[r.name];e.push(a);break;case"FunctionPlaceholder":var o=n.values[r.name],i=r.inner.reduce(f,[]);e.push(o(s(i)));break;case"Text":e.push(t(r.text));break;default:}return e},v=d.reduce(f,[]);return s(v)}return t(i)}catch(r){return t(e)}},this.formatDate=(e,t)=>{var r=new Date(e),a=new Date(t.now);try{switch(t.variant){case"time":var o=this.splitDate(r);return`${o.hour}:${o.minute} ${o.am_pm}`;case"time-ago":var s=Math.floor((a.getTime()-e)/1e3);switch(!0){case s<60:return this.use("global_just_now");case s<3600:var n=Math.floor(s/60);return this.use("global_word_mins_ago",{num:n,fallback:"global_mins_ago"});case s<43200:var u=Math.floor(s/60/60);return this.use("global_word_hours_ago",{num:u,fallback:"global_hours_ago"});default:return(0,i.isSameYear)(a,new Date(e))?this.use("global_short_date_time",{now:a.getTime(),date:e}):this.use("global_date_year_time",{now:a.getTime(),date:e})}default:return(0,i.exhaustivenessCheck)(t.variant)}}catch(e){return this.logger.error(`[LANG] Ошибка форматирования даты ${t.variant}`,e),r.toISOString()}},this.formatNumber=function(e,t){if(void 0===t&&(t="regular"),"regular"===t)return e.toString().split(".").join(r.translations.config.numDec);var a,o;switch(!0){case e>1e9:a=e/1e9,o="B";break;case e>1e6:a=e/1e6,o="M";break;case e>1e3:a=e/1e3,o="K";break;default:a=e,o=""}var s=a.toFixed(1).split("."),n=s[0],i=s[1];return(Number(i)?[n,i]:[n]).join(r.translations.config.numDec)+o},this.getTemplate=e=>{if(!this.decodedKeys[e]){var t=this.translations.keys[e];if(!t)return;this.decodedKeys[e]=Array.isArray(t)?t.map(l):l(t)}return this.decodedKeys[e]},this.splitDate=function(e,t){void 0===t&&(t={});var a=(()=>{var e,a,o,s=null!=(e=t.shortMonths)&&e,n=null==(a=t.genMonths)||a,u=null!=(o=t.capMonths)&&o;if(s)return r.getTemplate("global_months_short_of");var c=`${n}_${u}`;switch(c){case"false_false":return r.getTemplate("global_months");case"true_true":return r.getTemplate("global_months_cap_of");case"true_false":return r.getTemplate("global_months_of");case"false_true":return r.getTemplate("global_months_cap");default:return(0,i.exhaustivenessCheck)(c)}})(),o=t.shortWeekdays?r.getTemplate("global_week_days_short"):r.getTemplate("global_week_days"),s=e.getMinutes().toString().padStart(2,"0"),n=e.getHours().toString().padStart(2,"0"),u=e.getDate(),c=a[e.getMonth()]||a[0],l=o[(e.getDay()+6)%7]||o[0],d=e.getFullYear(),h="",m=r.translations.config.timeSys;return"12hour"===m[0]&&(h=e.getHours()>11?m[2]:m[1],n=(e.getHours()%12==0?12:e.getHours()%12).toString().padStart(2,"0")),{year:d,month:c,weekday:l,day:u,hour:n,minute:s,am_pm:h}},this.logger=e,this.translations=t,(0,o.initLang)({source:()=>t.keys,config:()=>t.config}),this.locale=t.config.locale;try{this.isDebug=!!localStorage.getItem(u)}catch(e){}}}function l(e){return(0,s.unescape)(e).replace(/<br\s*\/?>/gi,"\n")}var d=864e5;function h(e,t){var r=e.getDate(),a=e.getMonth(),o=e.getFullYear();return t.getFullYear()===o&&t.getMonth()===a&&t.getDate()===r}function m(e,t){return h(e,new Date(t.getTime()+d))}function p(e,t){return h(e,new Date(t.getTime()-d))}var g=n.createLanguage({Grammar:e=>n.alt(e.FunctionPlaceholder,e.StaticPlaceholder,e.Text).many(),StaticPlaceholder:e=>n.seqObj(n.string("{"),["name",e.Name],n.string("}")).map((e=>({type:"StaticPlaceholder",name:e.name}))),FunctionPlaceholder:e=>n.seqObj(n.string("{"),["name",e.Name],n.string("}")).chain((t=>{var r=t.name;return n.alt(e.StaticPlaceholder,e.Text).many().skip(n.string(`{/${r}}`)).map((e=>({type:"FunctionPlaceholder",name:r,inner:e})))})),Name:()=>n.regex(/[a-zA-Z0-9_]+/),Text:()=>n.regex(/[^{}]+/).map((e=>({type:"Text",text:(0,s.unescape)(e)})))})},600729:(e,t,r)=>{"use strict";r.d(t,{DEFAULT_FEATURE_FLAGS:()=>a});var a={me_fc_tooltips:!0,me_fc_multiple_windows:!0,me_fc_pinned_message:!1,me_fc_message_actions:!1,me_fc_blue_unread_counters:!1,me_fc_simple_composer:!1,me_sticker_packs:{helloKeywordPack:[],helloStickersPack:[]},me_community_messages_enabled:!1,me_message_selecting:!1,vkm_folders:!1,vkm_pwa:!1,me_channels:!1,vkm_new_read_indicator:!1,vkm_global_search:!1,vkm_convo_member_temporary_ban:!1,vkm_profile_info_screen_name:!1,vkm_hide_forward_author:!1,vkm_video_messages_shapes:!1,vkm_channels_temp:!1,vkm_convo_new_history_load:!1,vkm_composer_new:!1,vkm_send_promoted_stickers:!1,vkm_reactions:!1,vkm_convo_profile:!1,vkm_mediascope_collect:!1,vkm_settings:!1,vkm_widget_attaches:!1,vkm_who_read_message:!1,vkm_calls_history:!1,vkm_photo_viewer_rotating:!1}},298258:(e,t,r)=>{"use strict";r.d(t,{resolveCmid:()=>n,insertReplies:()=>i,toWallReplyAttach:()=>u,toPlainText:()=>c,isEmpty:()=>l,markDeleted:()=>d,restoreDeleted:()=>h,findReplyByCmid:()=>m,replaceReply:()=>p,findLastReply:()=>g});var a=r(722122),o=r(335571),s=r(529122);function n(e){return(Number.isNaN(e)||void 0===e)&&(e=0),e}function i(e,t){e.replies.history=[...e.replies.history,...t]}function u(e){return{kind:"WallReply",attaches:e.attaches,chunks:e.chunks,id:e.cmid,postId:e.postCmid,authorId:e.peerId,date:e.sentAt,ownerId:s.resolveId(e.channelId)}}function c(e,t){return o.toPlainText(e.chunks,t)}function l(e){return 0===e.chunks.length&&!Object.keys(e.attaches).find((e=>"unknown"!==e))}function d(e){return(0,a.default)({},e,{kind:"MarkedDeleted"})}function h(e){return(0,a.default)({},e,{kind:"Normal"})}function m(e,t){return e.replies.history.find((e=>e.cmid===t))}function p(e,t){var r=e.replies.history.findIndex((e=>e.cmid===t.cmid));-1!==r&&(e.replies.history[r]=t)}function g(e,t){for(var r=e=>e.kind===t,a=e.replies.history.length-1;a>=0;a--){var o=e.replies.history[a];if(o&&r(o))return o}}},832557:(e,t,r)=>{"use strict";r.d(t,{Router:()=>g});var a=r(722122),o=r(997864),s=r(645704),n=r(606972),i=r(701069),u=r(10122),c=r(298258),l=r(811129),d=r(529122),h=r(194739),m=r(897181),p=r(228450);class g{constructor(e,t,r,a){this.featureFlags=void 0,this.vkDomain=void 0,this.basePath=void 0,this.utils=void 0,this.history=void 0,this.screenRoute={kind:"MainRoute"},this.modalRoute=null,this.runtimeRoute=null,this.listeners=new Set,this.checkIsolation=()=>!1,this.notifyListeners=(e,t)=>{[...this.listeners].forEach((r=>r(e,t)))},this.handleRuntimeRouteChange=(e,t)=>{this.runtimeRoute="EmptyRuntimeRoute"===e.kind?null:e,this.notifyListeners(this.currentRoute,t)},this.handleRouteChange=e=>{var t=this.currentRoute;this.runtimeRoute=null,s.IRouter.isModalRoute(e)?(this.modalRoute=e,s.IRouter.isModalRoute(t)||(this.screenRoute=t)):(this.screenRoute=e,this.modalRoute=null)},this.addBasePath=e=>this.basePath?`${this.basePath}${"/"===e?"":e}`:e,this.removeBasePath=e=>{return this.basePath?e.replace(new RegExp(`^${t=this.basePath,t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}`),""):e;var t},this.openLink=(e,t)=>{if(!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey)){var r=s.IRouter.isProxyRoute(t)?this.fromProxyRoute(t):t;r&&(e.preventDefault(),this.push(r))}},this.push=e=>{s.IRouter.isRuntimeRoute(e)?this.handleRuntimeRouteChange(e,n.Action.Push):this.history.push(this.toUrl(e),{screenRoute:this.screenRoute})},this.replace=e=>{s.IRouter.isRuntimeRoute(e)?this.handleRuntimeRouteChange(e,n.Action.Replace):this.history.replace(this.toUrl(e),{screenRoute:this.screenRoute})},this.back=()=>{this.history.back()},this.forward=()=>{this.history.forward()},this.subscribe=e=>{var t=this.history.listen((t=>{var r=t.location,a=t.action,o=this.fromUrl(f(r));this.handleRouteChange(o),e(o,a)}));return this.listeners.add(e),()=>{this.listeners.delete(e),t()}},this.fromExternalUrl=e=>{var t,r=this.fromUrl(e);if("NotFoundRoute"!==r.kind)return r;try{t=new URL(e)}catch(e){return r}var a=(t.searchParams.get("w")||"").slice(4).split("_"),o=a[0],s=a[1],n=a[2],i=o?u.resolveId(parseInt(o)):void 0,l=s?m.resolveCmid(parseInt(s)):void 0,d=n?c.resolveCmid(parseInt(n.slice(1))):void 0;if(i&&l)return{kind:"ChannelRoute",channelId:i,postCmid:l,commentCmid:d};var h=t.pathname.split("/"),p=h[1];return t.hostname===this.vkDomain&&2===h.length&&p&&p.length>=3&&p.length<=25&&"reforged.php"!==p?"groups"===p?{kind:"ChannelsListRoute"}:{kind:"ScreenNameProxyRoute",screenName:p}:r},this.fromUrl=e=>this.utils.fromUrl(this.removeBasePath(e)),this.featureFlags=e,this.vkDomain=t,this.basePath=r,this.utils=new v(e),this.toUrl=this.toUrl.bind(this),this.fromProxyRoute=this.fromProxyRoute.bind(this),this.history=a?(0,n.createMemoryHistory)():(0,n.createBrowserHistory)();var o=this.currentRoute;s.IRouter.isModalRoute(o)?(this.modalRoute=o,this.screenRoute=this.state.screenRoute||this.screenRoute):this.screenRoute=o}get state(){return this.history.location.state||{}}get currentRoute(){return this.fromUrl(f(this.history.location))}toUrl(e){if(s.IRouter.isProxyRoute(e)){var t=this.fromProxyRoute(e);if(t)return this.toUrlInternal(t);switch(e.kind){case"AttachMediaProxyRoute":return null;case"AttachProxyRoute":return this.checkIsolation()?null:this.utils.getAttachLink(e.attach,this.vkDomain)||e.fallbackUrl||null;case"HashtagProxyRoute":return this.checkIsolation()?null:`https://${this.vkDomain}/feed?q=${encodeURIComponent(e.tag)}&section=search`;case"HashtagMentionProxyRoute":return this.checkIsolation()||!e.authorId?null:`https://${this.vkDomain}/wall${e.authorId}?q=${encodeURIComponent(e.tag)}`;case"ScreenNameProxyRoute":return this.checkIsolation()?null:`https://${this.vkDomain}/${e.screenName}`;default:(0,i.exhaustivenessCheck)(e)}}return this.toUrlInternal(e)}toUrlInternal(e){return this.addBasePath(this.utils.toUrl(e))}fromProxyRoute(e){switch(e.kind){case"AttachProxyRoute":switch(e.attach.kind){case"MiniApp":return{kind:"MiniAppModalRoute",miniAppId:e.attach.id};case"Wall":return this.featureFlags.me_channels&&u.isChannelId(e.attach.authorId)?{kind:"ChannelRoute",channelId:u.resolveId(e.attach.authorId),postCmid:m.resolveCmid(e.attach.id)}:null;case"WallReply":return this.featureFlags.me_channels&&u.isChannelId(e.attach.authorId)?{kind:"ChannelRoute",channelId:u.resolveId(e.attach.ownerId),postCmid:m.resolveCmid(e.attach.postId),commentCmid:c.resolveCmid(e.attach.id)}:null;case"Audio":case"AudioPlaylist":case"Podcast":case"Doc":case"Sticker":case"Link":case"Voice":case"Market":case"MoneyTransfer":case"MoneyRequest":case"Gift":case"Graffiti":case"MarketAlbum":case"FinishedCall":case"Poll":case"Story":case"Article":case"WallHistory":case"Geo":case"ActiveCall":case"DonutLink":case"InviteLink":case"VideoMessage":case"Widget":return null;default:return(0,i.exhaustivenessCheck)(e.attach)}case"AttachMediaProxyRoute":var t;if(e.source)switch(e.source.kind){case"message":t={kind:s.IRouter.RouteSourceKind.Message,cmid:e.source.cmid,peerId:e.source.peerId,messageAccessKey:e.attach.messageAccessKey};break;case"post":t={kind:s.IRouter.RouteSourceKind.Post,cmid:e.source.cmid,channelId:e.source.channelId};break;case"comment":t={kind:s.IRouter.RouteSourceKind.Comment,commentCmid:e.source.commentCmid,postCmid:e.source.postCmid,channelId:e.source.channelId};break;case"composer":t={kind:s.IRouter.RouteSourceKind.Composer};break;case"channelComposer":t={kind:s.IRouter.RouteSourceKind.ChannelComposer};break;default:(0,i.exhaustivenessCheck)(e.source)}return{kind:{Photo:"PhotoModalRoute",Video:"VideoModalRoute"}[e.attach.kind],id:e.attach.id,ownerId:e.attach.ownerId,accessKey:e.attach.accessKey,source:t,tab:e.tab};case"HashtagProxyRoute":case"HashtagMentionProxyRoute":case"ScreenNameProxyRoute":return null;default:(0,i.exhaustivenessCheck)(e)}}}function f(e){return`${e.pathname}${e.search}${e.hash||"#"}`}class v{constructor(e){var t=this;this.featureFlags=void 0,this.routeParamsDelimiter="_",this.routeParamsDelimiterParser=o.string(this.routeParamsDelimiter),this.parser=o.createLanguage({ModalRoutes:e=>o.alt(e.Peer,e.Poll,e.Important,e.MiniApp,e.PhotoSourceMessage,e.PhotoSourcePost,e.PhotoSourceComment,e.PhotoSourceComposer,e.PhotoSourceChannelComposer,e.PhotoSourceLess,e.VideoSourceMessage,e.VideoSourcePost,e.VideoSourceComment,e.VideoSourceComposer,e.VideoSourceChannelComposer,e.VideoSourceLess),ScreenRoutes:e=>o.alt(e.Convo,e.Channel,e.ChannelsList,e.CallJoin,e.ChatJoin,e.Settings,e.SettingsMain,e.Main),Main:()=>o.regexp(/\/?/).map((()=>({kind:"MainRoute"}))),CallJoin:()=>o.seqObj(o.string("/call/join/"),["callJoinHash",o.regexp(/^(.*)+$/)]).map((e=>({kind:"CallJoinRoute",callJoinHash:e.callJoinHash}))),ChatJoin:()=>o.seqObj(o.string("/chat/join/"),["chatJoinHash",o.regexp(/^(.*)+$/)]).map((e=>({kind:"ChatJoinRoute",chatJoinHash:e.chatJoinHash}))),Convo:()=>o.seqObj(o.string("/convo/"),["peerId",o.regexp(/(-)?[0-9]{1,10}$/)]).map((e=>({kind:"ConvoRoute",peerId:d.resolveId(Number(e.peerId)),entrypoint:"list_all"}))),Channel:()=>o.seqObj(o.string("/channels/"),["channelId",o.regexp(/(-)[0-9]{1,10}$/)]).map((e=>({kind:"ChannelRoute",channelId:u.resolveId(Number(e.channelId))}))),ChannelsList:()=>o.regexp(/\/channels\/?/).map((()=>({kind:"ChannelsListRoute"}))),Settings:()=>o.seqObj(o.string("/settings/"),["section",o.alt(...s.IRouter.SettingsRouteSectionKeys.map((e=>o.string(e))))]).map((e=>({kind:"SettingsRoute",section:e.section}))),SettingsMain:()=>o.regexp(/\/settings\/?/).map((()=>({kind:"SettingsRoute"}))),Peer:()=>o.seqObj(o.string("/peer/"),["peerId",o.regexp(/(-)?\d*/)]).map((e=>({kind:"PeerModalRoute",peerId:d.resolveId(Number(e.peerId))}))),Poll:()=>o.seqObj(o.string("/poll/"),["ownerId",o.regexp(/(-)?\d*/)],o.string("_"),["pollId",o.regexp(/(-)?\d*/)]).map((e=>({kind:"PollModalRoute",ownerId:d.resolveId(Number(e.ownerId)),pollId:Number(e.pollId)}))),Important:()=>o.string("/important").map((()=>({kind:"ImportantMessagesModalRoute"}))),MiniApp:()=>o.seqObj(o.string("/miniapp/"),["miniAppId",o.regexp(/(-)?\d+/)],["groupPeerId",o.regexp(/(_-\d+)?/)]).map((e=>{var t=e.groupPeerId&&Number(e.groupPeerId.slice(1)),r=t?d.resolveId(t):void 0,o=r&&d.isGroupPeerId(r)?r:void 0;return(0,a.default)({kind:"MiniAppModalRoute",miniAppId:(0,p.resolveMiniAppId)(Number(e.miniAppId))},o&&{groupPeerId:o})})),Photo:e=>o.seqObj(o.string("/photo/"),["ownerId",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["id",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["accessKey",e.AccessKey]),PhotoSourceLess:e=>o.seqObj(["photo",e.Photo]).map((e=>({kind:"PhotoModalRoute",ownerId:d.resolveId(Number(e.photo.ownerId)),id:Number(e.photo.id),accessKey:e.photo.accessKey}))),PhotoSourceMessage:e=>o.seqObj(["photo",e.PhotoSourceLess],this.routeParamsDelimiterParser,o.string(s.IRouter.RouteSourceKind.Message.toString()),this.routeParamsDelimiterParser,["peerId",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["cmid",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["messageAccessKey",e.AccessKey]).map((e=>(0,a.default)({},e.photo,{source:{kind:s.IRouter.RouteSourceKind.Message,peerId:d.resolveId(Number(e.peerId)),cmid:h.resolveCmid(Number(e.cmid)),messageAccessKey:e.messageAccessKey}}))),PhotoSourcePost:e=>o.seqObj(["photo",e.PhotoSourceLess],this.routeParamsDelimiterParser,o.string(s.IRouter.RouteSourceKind.Post.toString()),this.routeParamsDelimiterParser,["channelId",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["cmid",o.regexp(/(-)?\d*/)]).map((e=>(0,a.default)({},e.photo,{source:{kind:s.IRouter.RouteSourceKind.Post,channelId:u.resolveId(Number(e.channelId)),cmid:m.resolveCmid(Number(e.cmid))}}))),PhotoSourceComment:e=>o.seqObj(["photo",e.PhotoSourceLess],this.routeParamsDelimiterParser,o.string(s.IRouter.RouteSourceKind.Comment.toString()),this.routeParamsDelimiterParser,["channelId",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["postCmid",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["commentCmid",o.regexp(/(-)?\d*/)]).map((e=>(0,a.default)({},e.photo,{source:{kind:s.IRouter.RouteSourceKind.Comment,channelId:u.resolveId(Number(e.channelId)),postCmid:m.resolveCmid(Number(e.postCmid)),commentCmid:c.resolveCmid(Number(e.commentCmid))}}))),PhotoSourceComposer:e=>o.seqObj(["photo",e.PhotoSourceLess],this.routeParamsDelimiterParser,o.string(s.IRouter.RouteSourceKind.Composer.toString())).map((e=>(0,a.default)({},e.photo,{source:{kind:s.IRouter.RouteSourceKind.Composer}}))),PhotoSourceChannelComposer:e=>o.seqObj(["photo",e.PhotoSourceLess],this.routeParamsDelimiterParser,o.string(s.IRouter.RouteSourceKind.ChannelComposer.toString())).map((e=>(0,a.default)({},e.photo,{source:{kind:s.IRouter.RouteSourceKind.ChannelComposer}}))),Video:e=>o.seqObj(o.string("/video/"),["ownerId",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["id",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["accessKey",e.AccessKey]),VideoSourceLess:e=>o.seqObj(["video",e.Video]).map((e=>({kind:"VideoModalRoute",ownerId:d.resolveId(Number(e.video.ownerId)),id:Number(e.video.id),accessKey:e.video.accessKey}))),VideoSourceMessage:e=>o.seqObj(["video",e.VideoSourceLess],this.routeParamsDelimiterParser,o.string(s.IRouter.RouteSourceKind.Message.toString()),this.routeParamsDelimiterParser,["peerId",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["cmid",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["messageAccessKey",e.AccessKey]).map((e=>(0,a.default)({},e.video,{source:{kind:s.IRouter.RouteSourceKind.Message,peerId:d.resolveId(Number(e.peerId)),cmid:h.resolveCmid(Number(e.cmid)),messageAccessKey:e.messageAccessKey}}))),VideoSourcePost:e=>o.seqObj(["video",e.VideoSourceLess],this.routeParamsDelimiterParser,o.string(s.IRouter.RouteSourceKind.Post.toString()),this.routeParamsDelimiterParser,["channelId",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["cmid",o.regexp(/(-)?\d*/)]).map((e=>(0,a.default)({},e.video,{source:{kind:s.IRouter.RouteSourceKind.Post,channelId:u.resolveId(Number(e.channelId)),cmid:m.resolveCmid(Number(e.cmid))}}))),VideoSourceComment:e=>o.seqObj(["video",e.VideoSourceLess],this.routeParamsDelimiterParser,o.string(s.IRouter.RouteSourceKind.Comment.toString()),this.routeParamsDelimiterParser,["channelId",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["postCmid",o.regexp(/(-)?\d*/)],this.routeParamsDelimiterParser,["commentCmid",o.regexp(/(-)?\d*/)]).map((e=>(0,a.default)({},e.video,{source:{kind:s.IRouter.RouteSourceKind.Comment,channelId:u.resolveId(Number(e.channelId)),postCmid:m.resolveCmid(Number(e.postCmid)),commentCmid:c.resolveCmid(Number(e.commentCmid))}}))),VideoSourceComposer:e=>o.seqObj(["video",e.VideoSourceLess],this.routeParamsDelimiterParser,o.string(s.IRouter.RouteSourceKind.Composer.toString())).map((e=>(0,a.default)({},e.video,{source:{kind:s.IRouter.RouteSourceKind.Composer}}))),VideoSourceChannelComposer:e=>o.seqObj(["video",e.VideoSourceLess],this.routeParamsDelimiterParser,o.string(s.IRouter.RouteSourceKind.ChannelComposer.toString())).map((e=>(0,a.default)({},e.video,{source:{kind:s.IRouter.RouteSourceKind.ChannelComposer}}))),AccessKey:()=>o.regexp(/[-0-9a-zA-Z]*/)}),this.fromUrl=e=>{var t=(0,n.parsePath)(e),r=new URLSearchParams(t.search),o=this.parseParams(r);if(!t.pathname)return(0,a.default)({kind:"MainRoute"},o);try{var s=this.parser.ScreenRoutes.tryParse(t.pathname);switch(s.kind){case"MainRoute":var l=r.get("call"),p=r.get("chat");return(0,a.default)({kind:"MainRoute"},l&&{callJoinHash:l},{},p&&{chatJoinHash:p},{},this.parseConvoRouteExtraParams(r),{},o);case"CallJoinRoute":return(0,a.default)({kind:"CallJoinRoute",callJoinHash:s.callJoinHash},o);case"ChatJoinRoute":return(0,a.default)({kind:"ChatJoinRoute",chatJoinHash:s.chatJoinHash},o);case"ConvoRoute":var g=r.get("search"),f=r.get("chat_invite"),v=r.get("call_join"),_=r.get("cmid");return(0,a.default)({kind:"ConvoRoute",peerId:d.resolveId(Number(s.peerId)),entrypoint:s.entrypoint},f&&{chatJoinHash:f},{},v&&{callJoinHash:v},{},null!=g?{search:g}:{},{},_&&{cmid:h.resolveCmid(Number(_))},{},this.parseConvoRouteExtraParams(r),{},o);case"ChannelRoute":var R=r.get("cmid"),k=r.get("comment"),y=r.get("accessDenied");return(0,a.default)({kind:"ChannelRoute",channelId:u.resolveId(Number(s.channelId)),postCmid:null!==R?m.resolveCmid(Number(R)):void 0,commentCmid:null!==k?c.resolveCmid(Number(k)):void 0,accessDenied:y?Boolean(y):void 0},this.parseConvoRouteExtraParams(r),{},o);case"ChannelsListRoute":return(0,a.default)({kind:"ChannelsListRoute"},this.parseConvoRouteExtraParams(r),{},o);case"NotFoundRoute":return(0,a.default)({kind:"NotFoundRoute"},o);case"SettingsRoute":return this.featureFlags.vkm_settings?s:{kind:"NotFoundRoute"};default:(0,i.exhaustivenessCheck)(s)}}catch(e){}try{var P=this.parser.ModalRoutes.tryParse(t.pathname);return(0,a.default)({},P,{},o)}catch(e){}return(0,a.default)({kind:"NotFoundRoute"},o)},this.toUrl=e=>{var r=function(r){void 0===r&&(r=new URLSearchParams);var a=t.createGlobalQueryFromRoute(e,r);return""!==a.toString()?`?${(e=>{var t=[];return e.forEach(((e,r)=>{t.push(e?[r,encodeURIComponent(e)].join("="):r)})),t.join("&")})(a)}`:""};switch(e.kind){case"ConvoRoute":var a=this.createConvoExtraParamsQueryFromRoute(e);return void 0!==e.search&&a.append("search",String(e.search)),e.cmid&&a.append("cmid",String(e.cmid)),e.chatJoinHash&&a.append("chat_invite",e.chatJoinHash),e.callJoinHash&&a.append("call_join",e.callJoinHash),`/convo/${e.peerId}${r(a)}`;case"ChannelsListRoute":var o=this.createConvoExtraParamsQueryFromRoute(e);return`${u.CHANNELS_BASE_PATH}${r(o)}`;case"ChannelRoute":var n=new URLSearchParams;return void 0!==e.commentCmid&&n.append("comment",e.commentCmid.toString()),void 0!==e.postCmid&&n.append("cmid",e.postCmid.toString()),void 0!==e.accessDenied&&n.append("accessDenied",e.accessDenied.toString()),`${u.CHANNELS_BASE_PATH}/${e.channelId}${r(n)}`;case"MainRoute":var c=this.createConvoExtraParamsQueryFromRoute(e);return e.callJoinHash&&c.set("call",e.callJoinHash),e.chatJoinHash&&c.set("chat",e.chatJoinHash),`/${r(c)}`;case"CallJoinRoute":return`/call/join/${e.callJoinHash}${r()}`;case"ChatJoinRoute":return`/chat/join/${e.chatJoinHash}${r()}`;case"NotFoundRoute":return`/${r()}`;case"PeerModalRoute":return`/peer/${e.peerId}${r()}`;case"MiniAppModalRoute":return`/miniapp/${e.miniAppId}${e.groupPeerId?`_${e.groupPeerId}`:""}${r()}`;case"PollModalRoute":return`/poll/${e.ownerId}_${e.pollId}`;case"ImportantMessagesModalRoute":return"/important";case"SettingsRoute":return e.section?`/settings/${e.section}`:"/settings";case"PhotoModalRoute":case"VideoModalRoute":var l="PhotoModalRoute"===e.kind?"/photo/":"/video/",d=[e.ownerId.toString(),e.id.toString(),e.accessKey||""];if(e.source)switch(d.push(e.source.kind.toString()),e.source.kind){case s.IRouter.RouteSourceKind.Message:d.push(e.source.peerId.toString(),e.source.cmid.toString(),e.source.messageAccessKey||"");break;case s.IRouter.RouteSourceKind.Post:d.push(e.source.channelId.toString(),e.source.cmid.toString());break;case s.IRouter.RouteSourceKind.Comment:d.push(e.source.channelId.toString(),e.source.postCmid.toString(),e.source.commentCmid.toString());break;case s.IRouter.RouteSourceKind.Composer:case s.IRouter.RouteSourceKind.ChannelComposer:break;default:(0,i.exhaustivenessCheck)(e.source)}return`${l}${d.join(this.routeParamsDelimiter)}${r()}`;default:(0,i.exhaustivenessCheck)(e)}},this.parseParams=e=>{var t={};return s.IRouter.globalParamsKeys.reduce(((r,a)=>{switch(a){case"createPoll":t[a]=Boolean(e.get(a));break;case"folder":var o=e.get("folder");o&&(t.folder=l.resolveId(Number(o)));break;case"tab":t.tab=function(e){switch(e){case"archive":case"unread":case"businessNotify":case"messageRequest":return e;default:return}}(e.get("tab"));break;default:(0,i.exhaustivenessCheck)(a)}return r}),{}),t},this.parseConvoRouteExtraParams=e=>s.IRouter.convoRouteExtraParamsKeys.reduce(((t,r)=>(e.has(r)&&(t[r]=!0),t)),{}),this.createGlobalQueryFromRoute=function(e,t){return void 0===t&&(t=new URLSearchParams),s.IRouter.globalParamsKeys.forEach((r=>{if(r in e){var a=e[r];a?t.append(r,a.toString()):t.delete(r)}})),t},this.createConvoExtraParamsQueryFromRoute=function(e,t){return void 0===t&&(t=new URLSearchParams),s.IRouter.convoRouteExtraParamsKeys.forEach((r=>{r in e&&(e[r]?t.append(r,""):t.delete(r))})),t},this.getAttachLink=(e,t)=>{switch(e.kind){case"Audio":return`https://${t}/audio${e.ownerId}_${e.id}`;case"AudioPlaylist":var r=e.accessKey?`_${e.accessKey}`:"";return`https://${t}/music/${e.type}/${e.ownerId}_${e.id}${r}`;case"Podcast":return`https://${t}/im?z=podcast${e.ownerId}_${e.id}`;case"Doc":return`https://${t}/doc${e.ownerId}_${e.id}`;case"Sticker":return`https://${t}/stickers`;case"Link":case"Article":case"InviteLink":return e.url;case"Voice":case"MoneyTransfer":case"MoneyRequest":case"Graffiti":case"MarketAlbum":case"FinishedCall":case"Geo":case"ActiveCall":case"VideoMessage":case"Widget":return"";case"Market":return`https://${t}/market${e.ownerId}?w=product${e.ownerId}_${e.id}`;case"Gift":return`https://${t}/gifts`;case"Poll":return`https://${t}/im?w=poll${e.ownerId}_${e.id}`;case"Story":return`https://${t}/im?w=story${e.ownerId}_${e.id}/${e.ownerId}_${e.id}`;case"Wall":case"WallHistory":return`https://${t}/wall${e.ownerId}_${e.id}`;case"WallReply":return`https://${t}/wall${e.ownerId}_${e.postId}?reply=${e.id}`+(e.parentsStack&&e.parentsStack.length>0?`&thread=${e.parentsStack.join("_")}`:"");case"MiniApp":return`https://${t}/im?w=${e.appLink}`;case"DonutLink":return`https://${t}/donut/club${d.toRealId(e.ownerId)}`;default:return(0,i.exhaustivenessCheck)(e)}},this.featureFlags=e}}},816405:(e,t,r)=>{"use strict";r.d(t,{API_VERSION:()=>a});const a="5.204"},606972:(e,t,r)=>{"use strict";r.d(t,{Action:()=>a,createBrowserHistory:()=>u,createMemoryHistory:()=>c,parsePath:()=>g});var a,o=r(722122);!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(a||(a={}));var s=function(e){return e};var n="beforeunload",i="popstate";function u(e){void 0===e&&(e={});var t=e.window,r=void 0===t?document.defaultView:t,u=r.history;function c(){var e=r.location,t=e.pathname,a=e.search,o=e.hash,n=u.state||{};return[n.idx,s({pathname:t,search:a,hash:o,state:n.usr||null,key:n.key||"default"})]}var l=null;r.addEventListener(i,(function(){if(l)y.call(l),l=null;else{var e=a.Pop,t=c(),r=t[0],o=t[1];if(y.length){if(null!=r){var s=_-r;s&&(l={action:e,location:o,retry:function(){S(-1*s)}},S(s))}}else C(e)}}));var f=a.Pop,v=c(),_=v[0],R=v[1],k=h(),y=h();function P(e){return"string"==typeof e?e:p(e)}function I(e,t){return void 0===t&&(t=null),s((0,o.default)({pathname:R.pathname,hash:"",search:""},"string"==typeof e?g(e):e,{state:t,key:m()}))}function b(e,t){return[{usr:e.state,key:e.key,idx:t},P(e)]}function w(e,t,r){return!y.length||(y.call({action:e,location:t,retry:r}),!1)}function C(e){f=e;var t=c();_=t[0],R=t[1],k.call({action:f,location:R})}function S(e){u.go(e)}null==_&&(_=0,u.replaceState((0,o.default)({},u.state,{idx:_}),""));var $={get action(){return f},get location(){return R},createHref:P,push:function e(t,o){var s=a.Push,n=I(t,o);if(w(s,n,(function(){e(t,o)}))){var i=b(n,_+1),c=i[0],l=i[1];try{u.pushState(c,"",l)}catch(e){r.location.assign(l)}C(s)}},replace:function e(t,r){var o=a.Replace,s=I(t,r);if(w(o,s,(function(){e(t,r)}))){var n=b(s,_),i=n[0],c=n[1];u.replaceState(i,"",c),C(o)}},go:S,back:function(){S(-1)},forward:function(){S(1)},listen:function(e){return k.push(e)},block:function(e){var t=y.push(e);return 1===y.length&&r.addEventListener(n,d),function(){t(),y.length||r.removeEventListener(n,d)}}};return $}function c(e){void 0===e&&(e={});var t=e,r=t.initialEntries,n=void 0===r?["/"]:r,i=t.initialIndex,u=n.map((function(e){return s((0,o.default)({pathname:"/",search:"",hash:"",state:null,key:m()},"string"==typeof e?g(e):e))})),c=l(null==i?u.length-1:i,0,u.length-1),d=a.Pop,f=u[c],v=h(),_=h();function R(e,t){return void 0===t&&(t=null),s((0,o.default)({pathname:f.pathname,search:"",hash:""},"string"==typeof e?g(e):e,{state:t,key:m()}))}function k(e,t,r){return!_.length||(_.call({action:e,location:t,retry:r}),!1)}function y(e,t){d=e,f=t,v.call({action:d,location:f})}function P(e){var t=l(c+e,0,u.length-1),r=a.Pop,o=u[t];k(r,o,(function(){P(e)}))&&(c=t,y(r,o))}var I={get index(){return c},get action(){return d},get location(){return f},createHref:function(e){return"string"==typeof e?e:p(e)},push:function e(t,r){var o=a.Push,s=R(t,r);k(o,s,(function(){e(t,r)}))&&(c+=1,u.splice(c,u.length,s),y(o,s))},replace:function e(t,r){var o=a.Replace,s=R(t,r);k(o,s,(function(){e(t,r)}))&&(u[c]=s,y(o,s))},go:P,back:function(){P(-1)},forward:function(){P(1)},listen:function(e){return v.push(e)},block:function(e){return _.push(e)}};return I}function l(e,t,r){return Math.min(Math.max(e,t),r)}function d(e){e.preventDefault(),e.returnValue=""}function h(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter((function(e){return e!==t}))}},call:function(t){e.forEach((function(e){return e&&e(t)}))}}}function m(){return Math.random().toString(36).substr(2,8)}function p(e){var t=e.pathname,r=void 0===t?"/":t,a=e.search,o=void 0===a?"":a,s=e.hash,n=void 0===s?"":s;return o&&"?"!==o&&(r+="?"===o.charAt(0)?o:"?"+o),n&&"#"!==n&&(r+="#"===n.charAt(0)?n:"#"+n),r}function g(e){var t={};if(e){var r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));var a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}},471996:(e,t,r)=>{"use strict";r.d(t,{createFeatureFlags:()=>p,createLang:()=>g,vkcom_textInputStub:()=>f,vkcom_mediaSelectorStub:()=>v,VkComRouter:()=>_,isMasterTab:()=>R,sleep:()=>k,VKME_VKCALL_CONTAINER_ID:()=>P});var a=r(600729),o=r(760484),s=r(832557),n=r(506770),i=r(840060),u=r(343474),c=r(146143),l=r(274642),d=r(173471),h=r(70162),m=r(844142);function p(){const e={helloStickersPack:[21,12467,53098,50456,50459,18164,134,51117,16263,4275,6329,12296,21560,13312,20952,56896,20465,11607,53320,53647],helloKeywordPack:(null===(r=null===(t=window.stickersKeywords)||void 0===t?void 0:t["привет"])||void 0===r?void 0:r.filter((e=>e>0)))||[]};var t,r;return Object.assign(Object.assign({},a.DEFAULT_FEATURE_FLAGS),{me_fc_multiple_windows:!0,me_fc_tooltips:!0,me_sticker_packs:e,me_fc_pinned_message:(0,n.partConfigEnabled)("me_fc_pinned_message"),me_fc_blue_unread_counters:(0,n.partConfigEnabled)("fc_blue_unread_counters"),me_fc_simple_composer:(0,n.partConfigEnabled)("me_fc_simple_composer"),me_fc_message_actions:(0,n.partConfigEnabled)("me_fc_message_actions"),me_message_selecting:(0,n.partConfigEnabled)("me_message_selecting"),vkm_hide_forward_author:(0,n.partConfigEnabled)("vkm_hide_forward_author"),vkm_send_promoted_stickers:(0,n.partConfigEnabled)("stickers_can_send_unpurchased_stickers"),vkm_convo_profile:(0,n.partConfigEnabled)("vkm_convo_profile"),vkm_mediascope_collect:(0,n.partConfigEnabled)("vkm_fc_mediascope_collect"),vkm_widget_attaches:(0,n.partConfigEnabled)("vkm_widget_attaches"),vkm_who_read_message:(0,n.partConfigEnabled)("vkm_who_read_message"),vkm_calls_history:!1,vkm_settings:!1})}function g(e){const t=Object.values(h.getLang("months_of","raw")),r=Object.values(h.getLang("months_sm_of","raw")),a=[h.getLang("global_monday","raw"),h.getLang("global_tuesday","raw"),h.getLang("global_wednesday","raw"),h.getLang("global_thursday","raw"),h.getLang("global_friday","raw"),h.getLang("global_saturday","raw"),h.getLang("global_sunday","raw")],s=[h.getLang("global_monday_short","raw"),h.getLang("global_tuesday_short","raw"),h.getLang("global_wednesday_short","raw"),h.getLang("global_thursday_short","raw"),h.getLang("global_friday_short","raw"),h.getLang("global_saturday_short","raw"),h.getLang("global_sunday_short","raw")];return new o.Lang(e,{keys:Object.assign(Object.assign({},window.lang),{global_months_of:t,global_months_short_of:r,global_week_days:a,global_week_days_short:s}),config:window.langConfig})}function f(){return{init:()=>1,destroy:()=>{},show:()=>{},hide:()=>{},val:()=>"",focus:()=>{},swapCallbacks:()=>{}}}function v(){return{create:()=>()=>{},isUploading:()=>!1,removeMedia:()=>{}}}class _ extends s.Router{constructor(){super(...arguments),this.fromExternalUrl=e=>this.fromUrl(e),this.openLink=(e,t)=>{let r=null;if(!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey)){switch(t.kind){case"AttachMediaProxyRoute":{e.preventDefault();const r=t.attach;switch(r.kind){case"Photo":return void(0,l.showPhoto)(`${r.ownerId}_${r.id}`,r.messageAccessKey||r.accessKey||"",{queue:1},e.nativeEvent);case"Video":return void(0,u.showVideo)(`${r.ownerId}_${r.id}`,r.accessKey||"",{autoplay:1,minimized:0,module:"",queue:1},e.nativeEvent);default:y(r)}break}case"AttachProxyRoute":{const a=t.attach;switch(a.kind){case"Poll":return e.preventDefault(),void(0,l.showWiki)({w:`poll${a.ownerId}_${a.id}`},!1,e.nativeEvent,{queue:1});case"Story":return e.preventDefault(),void(0,d.showStory)(`story${a.ownerId}_${a.id}/${a.ownerId}_${a.id}`);case"Gift":return e.preventDefault(),a.isStickerStyle&&a.id?window.Emoji.clickSticker(Math.abs(a.id)):void(0,c.showBox)("al_gifts.php",{act:"box",tab:"sent",mid:window.vk.id},{cache:1,stat:["gifts.css",window.jsc("web/gifts.js")]});case"MoneyTransfer":return e.preventDefault(),void(0,c.showBox)("al_payments.php?act=money_transfer_history_box",{});case"Geo":return e.preventDefault(),void(0,c.showBox)("al_places.php",{act:"show_photo_place",lat:a.coordinates.latitude,long:a.coordinates.longitude,provider:4});default:r=this.toUrl(t)}break}case"MiniAppModalRoute":{const r=this.toUrl(t);return void(r&&(e.preventDefault(),(0,l.showWiki)({w:r.replace("/",""),app_ref:"snippet_im"},!1,e.nativeEvent)))}case"PollModalRoute":{e.preventDefault();const{pollId:r,ownerId:a}=t;return void(0,l.showWiki)({w:`poll${a}_${r}`},!1,e.nativeEvent,{queue:1})}default:r=this.toUrl(t)}r&&(e.preventDefault(),window.nav.go(r))}}}toUrl(e){switch(e.kind){case"HashtagProxyRoute":case"HashtagMentionProxyRoute":case"ScreenNameProxyRoute":case"AttachProxyRoute":return super.toUrl(e);case"AttachMediaProxyRoute":switch(e.attach.kind){case"Photo":{const t=e.attach.accessKey?`/${e.attach.accessKey}`:"";return`/im?z=photo${e.attach.ownerId}_${e.attach.id}${t}`}case"Video":{const t=e.attach.accessKey?`/${e.attach.accessKey}`:"";return`/im?z=video${e.attach.ownerId}_${e.attach.id}${t}`}default:return y(e.attach),null}case"PeerModalRoute":{const{peerId:t}=e;return m.Ranges.isUserIdTransitional(t)?`/id${t}`:m.Ranges.isGroupId(t)?`/club${Math.abs(t)}`:m.Ranges.isContactId(t)?"/im?sel=mr"+(t-1e9):`/im?sel=${t}`}case"PollModalRoute":{const{pollId:t,ownerId:r}=e;return`/im?w=poll${r}_${t}`}case"MiniAppModalRoute":return`/app${e.miniAppId}`;case"ConvoRoute":if(e.search)return`/im?sel=${e.peerId}&st=${encodeURIComponent(e.search)}`;default:return super.toUrl(e)}}}function R(){return!window.curNotifier||window.curNotifier.is_server||i.browser.safari}function k(e){return new Promise((t=>setTimeout(t,e)))}function y(e){throw new Error("Exhaustivness failure! This should never happen.")}const P="callsApp"}}]);try{stManager.done("dist/18d48385cf5047e1bdd5e25ec66e5a27.fc582ddb7d1215440d80.js")}catch(e){}