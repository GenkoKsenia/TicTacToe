(self.webpackChunkvk=self.webpackChunkvk||[]).push([[93424],{758347:(_,e,t)=>{"use strict";t.d(e,{default:()=>i});const i=(0,t(28178).makeIcon)("Icon20CheckCircleOn","check_circle_on_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="check_circle_on_20"><path fill-rule="evenodd" d="M10 20c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Zm5.35-12.72a.75.75 0 1 0-1.062-1.06l-5.955 5.968L5.81 9.66a.75.75 0 1 0-1.062 1.06l3.054 3.06a.75.75 0 0 0 1.062 0l6.486-6.5Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},224558:(_,e,t)=>{"use strict";function i(){return{icon:'<svg fill="none" height="8" viewBox="0 0 12 8" width="12" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M2.16 2.3a.75.75 0 0 1 1.05-.14L6 4.3l2.8-2.15a.75.75 0 1 1 .9 1.19l-3.24 2.5c-.27.2-.65.2-.92 0L2.3 3.35a.75.75 0 0 1-.13-1.05z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"dropdown_12"}}t.d(e,{getIcon12Dropdown:()=>i})},938032:(_,e,t)=>{"use strict";function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="playlist_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="playlist_24__playlist_24"><path id="playlist_24__Shape" d="M0 0h24v24H0z"/><path d="M13 6.88c0-.48-.4-.88-.88-.88H2.88C2.4 6 2 6.4 2 6.88v.24c0 .48.4.88.88.88h9.24c.49 0 .88-.4.88-.88v-.24Zm0 4c0-.48-.4-.88-.88-.88H2.88c-.49 0-.88.4-.88.88v.24c0 .48.4.88.88.88h9.24c.49 0 .88-.4.88-.88v-.24ZM2 15.12v-.24c0-.48.4-.88.88-.88h4.23c.5 0 .89.4.89.88v.24c0 .48-.4.88-.89.88H2.88c-.49 0-.88-.4-.88-.88Zm15 .7c0 3.74-.99 4.64-3.77 5.13-1.48.26-3.23-.48-3.23-2.8 0-1.15.72-2.23 2.2-2.51 1.12-.22-.43.05 2.12-.42.62-.12.69-.34.69-.81L15 12.56V5.98c0-1.1.83-1.5 2.6-1.85 0 0 2.34-.34 3.82-.61.33-.06.58.06.58.44V7.4c0 .37-.15.54-.53.6-1.5.27-3.99.65-3.99.65-.33.08-.48.32-.48.65v6.51Z" id="playlist_24__Mask" fill="currentColor"/></g></g></svg>',name:"playlist_24"}}t.d(e,{getIcon24Playlist:()=>i})},816906:(_,e,t)=>{"use strict";function i(){return{icon:'<svg width="56" height="56" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg"><g id="playlist_outline_56__Icons-56/playlist_outline_56" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="playlist_outline_56__playlist_outline_28"><path id="playlist_outline_56__playlist_outline_56" d="M0 0h56v56H0z"/><path d="M39 38.93c0 4.55-1.94 7.97-5.07 9.62-2.84 1.5-6.24 1.22-8.22-.76-2.04-2.04-2.3-5.5-.58-8.3C27 36.44 30.77 34.61 36 34.5V16.76a6.88 6.88 0 0 1 5.03-6.68c1.08-.36 3.24-.92 6.5-1.67l1.64-.37A1.5 1.5 0 0 1 51 9.5v4.2a6.7 6.7 0 0 1-4.97 6.48L39 22.05Zm-3-1.42h-.4c-4 .18-6.67 1.53-7.91 3.54-1.02 1.66-.88 3.6.14 4.62.98.98 2.96 1.14 4.7.22 2.12-1.11 3.47-3.5 3.47-6.96V37.5ZM27.5 22a1.5 1.5 0 0 1 0 3h-19a1.5 1.5 0 0 1 0-3h19ZM48 11.38a83.8 83.8 0 0 0-6.03 1.54l-.21.08c-1.93.71-2.8 2.05-2.76 4.33v1.62l6.25-1.67A3.7 3.7 0 0 0 48 13.71ZM30.5 10a1.5 1.5 0 0 1 0 3h-22a1.5 1.5 0 0 1 0-3h22Z" id="playlist_outline_56__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"playlist_outline_56"}}t.d(e,{getIcon56PlaylistOutline:()=>i})},412546:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{currentAudioPage:()=>currentAudioPage,AudioPage:()=>AudioPage});var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(887757),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(692137),_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(722122),_shared_evbus__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(182804),_lib_stats__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(315882),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(840060),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(506770),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(274642),_web_lib_fx__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(631351),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(798262),_shared_lib_date__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(683609),_shared_audio_formatters_formatAudioTime__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(708284),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(549357),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(501389),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(927766),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(152278),_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(937884),_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(53721),_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(837565),_web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(99320),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(43873),_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(733164),_web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(792440),_web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(866914),_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(583285),_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(873589),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(146143),_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(315720),_web_lib_utils__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(67328),_web_grid_sorted__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(622858),_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(897449),_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(608021),_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(975197),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(290846),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(819086),_shared_audio_enums__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(722904),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(342269),_web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(64500),_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(651207),_icons_desktop__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(816906),_icons_desktop__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(325900),_icons_desktop__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(233438),_icons_desktop__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(145519),_icons_desktop__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(938032),_icons_desktop__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(845828),_icons_desktop__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(224558),_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(660080),_shared_lib_storage__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(522683),_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(659397),_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(166773),_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(896438),_player_radiostation_unfollowRadiostation__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(333097),_player_radiostation_followRadiostation__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(719927),_shared_audioplayer_AudioPlayerAdapter_audioTuple_audioTupleToAudioObject__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(624715),_web_audio_components_AutoplayBlock__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(905067),_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(590393),_shared_ranges__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(844142),SLIDER_TIMEOUT=1e4,sectionsToUpdate=[];function currentAudioPage(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.gpeByClass)("_audio_page_layout",_);return!!e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)(e,"audioPage")}function AudioPage(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)(_,"audioPage",this),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.extend)(cur.lang||{},e.langs),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().langs=e.langs,this._data=e,this._ownerId=e.ownerId,e.playlists&&e.playlists.length&&(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().addWithReplacePlaylists(e.playlists.filter(Boolean)),this.isLayer()||(cur.audioPage=this),this.isLayer()&&uiSearch.init("audio_search_layer"),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.toggleAudioHQBodyClass(),this._els={pageContainer:_,sections:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_sections",_),playerWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_player_wrap",_),player:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_player",_),contentBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_content_block",_),scrollWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_content_block_wrap",_),searchSectionAudios:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_search__local_audios_list",_),searchSectionAudiosHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_section_search__local_audios_header",_),searchSectionPlaylists:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_search__local_playlists_list",_),searchSectionPlaylistsHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_search__local_playlists_header",_),searchNoLocalResults:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_local_no_results",_),searchGlobalBlocks:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_global_search__blocks",_),searchGlobalCommunitiesPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_global_search__communities_place",_),searchGlobalPlaylistsPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_global_search__playlists_place",_),searchGlobalArtistsPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_global_search__artists_place",_),searchGlobalAudiosBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_global_search__audios_block",_),searchGlobalAudiosBlockHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_global_search__audios_header",_),searchGlobalAudiosList:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_global_search__audios_list",_),searchInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ui_search_field",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_search",_)),footer:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page__footer",_),footerNowPlayingInfo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page__footer_now_playing",_),footerClearNowPlayingButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page__footer_clear_playlist",_)},this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_18__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),this._readyAudio=this._data.readyAudio;var t=this._data.readyPlaylist;t&&(this._pagePlaylist=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylist(t.type,t.ownerId,t.id),this._pagePlaylist.mergeWith(t)),!this._readyAudio&&this._pagePlaylist&&(this._readyAudio=this._pagePlaylist.getAudioAt(0)),this._data.playlistCoverUploadOptions&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[this._ownerId]=this._data.playlistCoverUploadOptions),this.isLayer()||(cur.module=e.module||"audio",cur.oid=this._ownerId,+this._ownerId==+vk.id?cur.submodule="my":_shared_ranges__WEBPACK_IMPORTED_MODULE_45__.Ranges.isGroupId(this._ownerId)?cur.submodule="group_list":cur.submodule="user_list"),vk.id&&this._initPlayer(),this.initNavigation(),_shared_lib_storage__WEBPACK_IMPORTED_MODULE_36__.vkLocalStorage.getItem(_shared_audio_enums__WEBPACK_IMPORTED_MODULE_31__.AUDIO_PLAYER_ENUMS.ONBOARDING_ARTISTS_LS_KEY)&&AudioPage.showRecomsOnboarding(!0),this.catalogController=new _web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_33__.CatalogController(_),this.showSection(e.initSection,null,this._data.onlySkeleton),e.initSection||this.catalogController.initBlocksManually();var i=new URLSearchParams(location.search);this.defaultSection=!i.get("section")&&e.initSection||"general",this._initSearchParams(),this.promoAlbumSlideInit(),this._els.searchInput&&this._els.searchInput.focus(),this.isLayer()||this.isPodcastPage()||!nav.objLoc.q||"search_playlists"===nav.objLoc.section||this._els.searchInput&&(this._els.searchInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.winToUtf)(nav.objLoc.q),this._showSearchSection(nav.objLoc)),this.updateCurrentPlayingInfo(),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().setStatusExportInfo(this._data.export),this.updateStatusExportControls(),this._initKeyEvents(),window.onAudioPageLoaded&&(window.onAudioPageLoaded.call(this),delete window.onAudioPageLoaded),this.updateShuffleButton(),this.loadMarketItemsCarousel()}AudioPage.address="audio",AudioPage.updateSearchHighlight=function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_playlist",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.gpeByClass)("_audio_layout",this));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(e,"audio_search_focused","focus"===_.type)},AudioPage.onSearchFocused=function(_){AudioPage.updateSearchHighlight(_)},AudioPage.prototype.updatePlaylistsCounter=function(_){var e;if(cur.audioPage&&_===cur.audioPage.getOwnerId()&&(e=cur.audioPage._els.pageContainer.querySelector(".CatalogBlock__own_only_playlists_header .CatalogBlock__title"))){var t=cur.audioPage._data.playlists.length;e.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.langNumeric)(t,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.curLang("audio_playlists_count_title")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.gpeByClass)("_audio_page_section_layout",e),"audio_section_empty",!t)}},AudioPage.getCoverImage=function(_,e){var t="";_?t=`<img alt="${(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_37__.escape)(e)}" width='143px' height='143px' src="${_}" loading='lazy' />`:t=`<div class="audio_pl_cover_placeholder">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_46__.getIcon56PlaylistOutline)().icon}</div>`;return t},AudioPage.setCoverImageElem=function(_,e,t){if(e){var i=_.querySelector(".audio_pl_cover_placeholder"),o=_.querySelector("img");o&&_.removeChild(o),i&&_.removeChild(i);var s=new Image;s.src=e,s.setAttribute("alt",(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_37__.escape)(t)),s.setAttribute("width","143px"),s.setAttribute("height","143px"),s.setAttribute("loading","lazy"),_.appendChild(s)}else{var a=_.querySelector("img");if(a){_.removeChild(a);var l=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_46__.getIcon56PlaylistOutline)().icon,n=document.createElement("div");n.classList.add("audio_pl_cover_placeholder"),n.innerHTML=l,_.appendChild(n)}}},AudioPage.deletePlaylist=function(_,e,t){var i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_PLAYLIST,_,e),o=AudioPlayer.getLang("audio_sure_delete_playlist_box_text");o='<div style="overflow: hidden; text-overflow: ellipsis;">'+(o=o.replace("{name}",i.getTitle()))+"</div>",(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showFastBox)({title:AudioPlayer.getLang("audio_sure_delete_playlist_box_title")},o,AudioPlayer.getLang("audio_sure_delete_playlist_box_yes"),function(){ajax.post("al_audio.php?act=delete_playlist",{hash:t,playlist_owner_id:_,playlist_id:e,page_owner_id:cur.audioPage?cur.audioPage.getOwnerId():0},{onDone:function(_){if(cur.audioPage){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section__all",cur.audioPage.getPageContainer()),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_block__playlists_items",e);if(e&&t){var i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(t,"max-items"));if(_&&t.children.length<i){var o=_.thumb,s=_.title;_.cover_image=AudioPage.getCoverImage(o,s),t.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.getTemplate)("audio_pl_item",_)))}t.children.length||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.gpeByClass)("_audio_page_section_layout",t),"no_playlists"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.gpeByClass)("_audio_page_titled_block",t)))}}},onFail:()=>!0});var i=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.getBoxQueue)();if(i&&i.hideAll(!0),layers&&layers.fullhide&&layers.fullhide(),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass)("_audio_pl_"+_+"_"+e),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.re)(this)})),window.location.pathname.includes(`/music/playlist/${window.vk.id}`))return window.history.length>2?void window.history.back():void document.location.replace(`https://${window.vk.apiConfigDomains.domain}/music?section=${cur.audioPage.defaultSection}`);if(cur.audioPage){if(cur.audioPage._data.playlists=cur.audioPage._data.playlists.filter((function(t){return!(t.id==e&&t.owner_id==_)})),!cur.audioPage._data.playlists.length)return void nav.reload();cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(_)}}.bind(this),_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_cancel"))},AudioPage.prototype.getCurrentSection=function(){return this._currentSection},AudioPage.prototype.getOwnerPlaylists=function(){return this._data.playlists},AudioPage.loadPlaylists=function(ownerId,totalCount,skipFirstChunk,forAttachBox,onDone){var chunkSize=50,chunks=[];(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isFunction)(totalCount)&&(onDone=totalCount,totalCount=void 0,skipFirstChunk=!1),cur.playlistsCache=cur.playlistsCache||{};var cacheKey=ownerId+"_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(skipFirstChunk);if(cur.playlistsCache[cacheKey])return onDone(cur.playlistsCache[cacheKey]);function onAllLoaded(){var _=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)(chunks,(function(e,t){t&&(_=_.concat(t))})),cur.playlistsCache=cur.playlistsCache||{},cur.playlistsCache[cacheKey]=_,onDone&&onDone(_)}function _loadChunk(chunkIndex,_cb){var groupId=cur.group_id||(_shared_ranges__WEBPACK_IMPORTED_MODULE_45__.Ranges.isGroupId(cur.oid)?-cur.oid:0);ajax.post("al_audio.php?act=owner_playlists",{owner_id:ownerId,group_id:groupId,offset:chunkIndex*chunkSize,is_attach:forAttachBox?1:0},{onDone:function onDone(playlists,totalCount,additionalData){additionalData.templates_script&&eval(additionalData.templates_script),additionalData.langs&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.extend)(cur.lang,additionalData.langs),additionalData.audio_playlist_cover_upload_options&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[ownerId]=additionalData.audio_playlist_cover_upload_options),chunks[chunkIndex]=playlists,_cb(totalCount)},onFail:function(_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(boxLoader),_)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_error")},_),!0}})}function _loadAllChunks(_,e,t){var i=Math.ceil(_/chunkSize);i&&i-e!=0?function(){for(var _=new callHub(t,i-e),o=e;o<i;o++)_loadChunk(o,(function(){_.done()}))}():t()}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.isUndefined)(totalCount)?_loadChunk(0,(function(_){_loadAllChunks(_,1,onAllLoaded)})):_loadAllChunks(totalCount,skipFirstChunk?1:0,onAllLoaded)},AudioPage.prototype.getOwnerId=function(){return+this._ownerId},AudioPage.prototype.getPageContainer=function(){return this._els.pageContainer},AudioPage.prototype.getCurrentSectionEl=function(){return this.catalogController.currentSection&&this.catalogController.currentSection.getSectionElement()},AudioPage.prototype.canAddToGroup=function(){return this._data.canAudioAddToGroup},AudioPage.prototype.canEditGroup=function(){return this._data.canEdit},AudioPage.prototype.updateCurrentPlayingInfo=function(){if(this.isLayer()){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),e=_.getCurrentPlaylist(),t=e?e.getTitle():"";if(e&&null!==e.getTitleLang()&&window.langConfig&&window.langConfig.id!==e.getTitleLang()&&ajax.post("al_audio.php?act=get_playlist_info",{owner_id:e.getOwnerId(),playlist_id:e.getAlbumId(),access_hash:e.getAccessHash()},{onDone:t=>{e.updatePlaylist(t)&&(_.saveStateCurrentPlaylist(),this.updateCurrentPlayingInfo())},onFail:()=>{}}),t){var i=e.getOriginalPlaylistRawId();if(e.getBlockId())t=`<a href="${`/audio?section=recoms_block&type=${e.getBlockId()}`}"\n                  class="audio_page__footer_now_playing_link">\n                  ${t}\n                </a>`;else if(i||e.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_PLAYLIST&&0!==e.getAlbumId()){var o,s,a;i?(o=(i=i.split("_"))[0],s=i[1],a=i[2]||""):(o=e.getOwnerId(),s=e.getAlbumId(),a=e.getAccessHash()||""),t=`<a href="${nav.toStr((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.extend)({},nav.objLoc,{z:"audio_playlist"+o+"_"+s+(a?"/"+a:"")}))}"\n                  class="audio_page__footer_now_playing_link"\n                  onclick="if (checkEvent(event)) { return true } else { AudioUtils.showAudioPlaylist(${o}, ${s}, '${a}'); return cancelEvent(event) }">\n                  ${t}\n                </a>`}this._els.footerNowPlayingInfo.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_current_playing_from").replace("{playlist}",t)}else{var l=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio();if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isPodcast(l)){var n=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_podcast_playing");this._els.footerNowPlayingInfo.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_current_playing_from").replace("{playlist}",n.replace("{name}",l[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]))}else this._els.footerNowPlayingInfo.innerHTML=""}this._els.footerClearNowPlayingButton.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_clear_current_playlist"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggle)(this._els.footer,!!e)}},AudioPage.prototype.onSearchFiltersChanged=function(_){var e=window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(this.isLayer())],t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(this._searchSortFilter.selectedItems()[0][0]),i={performer:e.val?1:null,lyrics:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer),"on")?1:null,sort:t?1:null};this.syncParametersUI(i);var o=_&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isObject)(_)?_:i;this.isLayer()&&(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.extend)({},this._prevLoc,o)),nav.change(o,!1,{fromSearch:!0,filtersChanged:!0})},AudioPage.prototype._initSearchParams=function(){window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(this.isLayer())]={els:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass)("_audio_search_type",this._els.pageContainer),keep:this.isLayer()};var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_fltr_sort",this._els.pageContainer);_&&(this._searchSortFilter=new Dropdown(_,this._data.sortFilters,{big:1,zeroPlaceholder:!0,onChange:this.onSearchFiltersChanged.bind(this)})),this.isLayer()||this.syncParametersUI(nav.objLoc)},AudioPage.prototype.syncParametersUI=function(_){var e="audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(this.isLayer()),t=window.radioBtns[e];t&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.radiobtn)(t.els[_.performer?1:0],!!_.performer,e);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(i,"on",!!_.lyrics);var o={performer:AudioPlayer.getLang("audio_performers_only"),lyrics:AudioPlayer.getLang("audio_search_with_text"),sort:AudioPlayer.getLang("audio_search_by_length")},s=this._els.searchInput;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)(["performer","lyrics","sort"],(function(e,t){uiSearch.toggleFilter(s,t,o[t],!!_[t])}))},AudioPage.onFilterRemoved=function(_,e,t){var i=currentAudioPage(e);(function(){switch(_){case"performer":var e="audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(this.isLayer()),i=window.radioBtns[e];(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.radiobtn)(i.els[0],0,e);break;case"sort":var o=this._searchSortFilter.options.defaultItems[0][0];this._searchSortFilter.selectItem(o,!1);break;case"lyrics":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer),"on")}t||this.onSearchFiltersChanged()}).apply(i)},AudioPage.prototype._showSearchSection=function(_){this._toggleSearchProgress(!0);var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.DEFAULT_PLAYLIST_ID);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player2")){var t=_.globalQuery||_.q;this._sectionData={q:t,performer:_.performer};var i=void 0!==_.fromSuggestsAcceptId;i||(this._cur_qid=(0,_lib_stats__WEBPACK_IMPORTED_MODULE_2__.generateQID)()),this.showSection("search",function(){if(t){var e=this._data.sectionData.search?this._data.sectionData.search.qid:0;(0,_lib_stats__WEBPACK_IMPORTED_MODULE_2__.saveSearchAttemptStats)(_lib_stats__WEBPACK_IMPORTED_MODULE_2__.serviceAudio,0,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.isVisible)(this._els.searchNoLocalResults),t,e,void 0,void 0,void 0,void 0,i&&_.fetchedQuery,void 0,void 0,_.fromSuggestsAcceptId)}this._toggleSearchProgress(!1)}.bind(this))}else e.loadAll(function(){this._toggleSearchProgress(!1),this._doShowSearchSection(_)}.bind(this))},AudioPage.prototype._toggleSearchProgress=function(_){this._els.searchInput&&!this._muteSearch&&(_?uiSearch.showProgress(this._els.searchInput):uiSearch.hideProgress(this._els.searchInput))},AudioPage.prototype._doShowSearchSection=function(_){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)();if(_&&(this._prevSearchParams=_),_=_||this._prevSearchParams){var t=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.replaceEntities)(_.q)+(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.replaceEntities)(_.globalQuery||"");(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)(["performer","lyrics","sort"],(function(e,i){t+=_[i]||0})),t+=this._ownerId,this._toggleSearchProgress(!0);var i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_PLAYLIST,this._ownerId,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.DEFAULT_PLAYLIST_ID);i.loadAll(function(){clearTimeout(this._onSilendLoadedTO),this._onSilendLoadedTO=setTimeout(function(){o.call(this)}.bind(this))}.bind(this))}function o(){i.search(_,function(i){var o="",s=this._data.playlistsIndex?this._data.playlistsIndex.search(_.q):[];if(this.showSection("search"),s.length){var a="";(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)(s,(function(_,e){e.cover_image=AudioPage.getCoverImage(e.thumb,e.title),a+=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.getTemplate)("audio_pl_item",e)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(this._els.searchSectionPlaylistsHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(this._els.searchSectionPlaylists),o=+this._ownerId===vk.id?e.langs.audio_found_your_local_playlists:_shared_ranges__WEBPACK_IMPORTED_MODULE_45__.Ranges.isUserId(this._ownerId)?e.langs.audio_found_user_local_playlists:e.langs.audio_found_group_local_playlists,this._els.searchSectionPlaylistsHeader.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.langNumeric)(s.length,o),this._els.searchSectionPlaylists.innerHTML=a}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchSectionPlaylistsHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchSectionPlaylists);var l=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_24__.hashCode)(t));l.mergeWith({list:i,searchParams:{globalQuery:_.globalQuery||_.q,performer:_.performer,lyrics:_.lyrics,sort:_.sort}}),l.setLocalFoundCount(i.length),i.length||s.length?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchNoLocalResults):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(this._els.searchNoLocalResults),o=vk.id===+this._ownerId?e.langs.audio_no_local_results:_shared_ranges__WEBPACK_IMPORTED_MODULE_45__.Ranges.isUserId(this._ownerId)?e.langs.audio_no_user_local_results:e.langs.audio_no_group_local_results,this._els.searchNoLocalResults.innerHTML=o.replace("{query}","<strong>"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.clean)(_.q)+"</strong>")),i.length||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchSectionAudiosHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchSectionAudios)),this._pagePlaylist=l,this._toggleSearchProgress(!1)}.bind(this))}},AudioPage.prototype.showFriendMusic=function(_,e){return(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_7__.statlogsValueEvent)("audio_friends_block","click_friend"),this.isLayer()?nav.go({0:"/audios"+e},!1,{friendId:e}):nav.go("/audios"+e,_),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(_)},AudioPage.prototype._deinitNavigation=function(){cur.nav.pop(),this._navigationInited=!1},AudioPage.PageSections=["recoms_audio","recoms_block","search_block","recoms_personal","my"],AudioPage.followedRadioClassName="audio_page_player_follow_radiostation--followed";var layerSectionsToMainFrame=["search_block","search_playlists","recoms_block"];function isAdPlayingWithChoices(){if(!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("audio_ad_choices"))return!1;var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)();return _.ads.isPlaying()&&!!_.ads.getCurrentAd()}function makeAudioAdMoreLink(){var _=document.createElement("a");return _.href="#",_.classList.add("audio_page_player_ad_more_link"),_.innerHTML=`${_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_ad_more")} ${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_56__.getIcon12Dropdown)().icon}`,_.addEventListener("click",(_=>{_.preventDefault();var e=_.currentTarget,t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),i=_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_44__.AudioAdActionsModalController.ensure();i.isOpen(e)?i.close(e):i.open(e,t.ads.getCurrentAd())})),_}AudioPage.prototype.initNavigation=function(){this._navigationInited||this.isPodcastPage()||(this._navigationInited=!0,this._prevLoc={},!this.isLayer()&&nav.objLoc.popup&&"recoms_onboarding"===nav.objLoc.popup&&AudioPage.showRecomsOnboarding(),cur.nav.push(function(_,e,t,i){var o=this._ignoreResetedSearch;if(delete this._ignoreResetedSearch,o&&i.fromSearch)return!1;if(i.isLayer&&!this.isLayer())return!1;if(t.popup&&"recoms_onboarding"===t.popup)return AudioPage.showRecomsOnboarding(),nav.setLoc(t),!1;if(this.isLayer()&&!1!==this._prevLoc)for(var s in e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.clone)(this._prevLoc),_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.clone)(t),e)e.hasOwnProperty(s)&&(e[s]&&void 0===t[s]?_[s]=!1:e[s]==t[s]&&delete _[s]);if(_&&Object.keys(_).length){var a;if(this._deleteDeletedAudios(),this.isLayer())a=!t.q&&!!e.q&&t.section===e.section?this.prevSection||this.defaultSection:t.section;else a=t.section||this.defaultSection;var l=!1;return 0===t[0].indexOf("podcasts")&&(a="podcast"),i.tab||i.fromSearch||!1===_.q&&1===Object.keys(_).length||i.searchPerformer?l=!1:i.friendId&&this.isLayer()?(a="friend",this.resetSection(a),this._sectionData={friend_id:i.friendId},l=!1):(2!==Object.keys(_).length||!1!==_.q||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.isUndefined)(_[0]))&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.isUndefined)(_[0])?"signal"===t.section||"signal"===e.section?l=!0:((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.inArray)(_.section,AudioPage.PageSections)||_.hasOwnProperty("block")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.inArray)(e.section,AudioPage.PageSections)&&!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.inArray)(_.section,AudioPage.PageSections))&&(!this.isLayer()||layerSectionsToMainFrame.includes(t.section)||_.hasOwnProperty("block")?l=!0:(l=!1,this._sectionData={audio_id:_.audio_id},a="recoms",delete this._currentSection)):l=!0,l?(this.catalogController&&this.catalogController.destroy(),!0):(t.q?(this._els.searchInput&&!i.fromSearch&&(this._els.searchInput.value=t.q,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.triggerEvent)(this._els.searchInput,"keyup",{},!0),this.lastQuery=t.q),this._showSearchSection((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.extend)({},t,i))):(this._ignoreResetedSearch=!1===_.q,this._els.searchInput&&uiSearch.reset(this._els.searchInput,!0),this.showSection(a),this._switchTab(a)),this.isLayer()?this._prevLoc=t:nav.setLoc(t),(i.back||i.hist||i.nav)&&this.syncParametersUI(t),!1)}}.bind(this)))},AudioPage.prototype._deleteDeletedAudios=function(){var _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.getAddRestoreInfo();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)(_,(function(_,e){"deleted"!==e.state&&"recom_hidden"!==e.state||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().deleteAudioFromAllPlaylists(_)}))},AudioPage.prototype._switchTab=function(_){if(!this.isPodcastPage()){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_tab__"+_,this._els.pageContainer);e?uiTabs.switchTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domFC)(e)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ui_tab_sel",this._els.pageContainer),"ui_tab_sel")}},AudioPage.prototype.onLayerHide=function(){this._deinitNavigation(),this._deinitKeyEvents(),this._onSectionOut(),delete this._currentSection,this._muteSearch=!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player2")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchNoLocalResults),setTimeout((()=>uiSearch.reset(this._els.searchInput)),1e3)},AudioPage.prototype.updateLayerHeight=function(){var _=700;_=Math.min(_,window.innerHeight-150),_=Math.max(_,400),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.isVisible)(this._els.footer)&&(_-=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getSize)(this._els.footer)[1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(this._els.scrollWrap,{height:_}),this._els&&this._els.scrollWrap&&"function"==typeof this._els.scrollWrap.updateScroll&&this._els.scrollWrap.updateScroll()},AudioPage.prototype.scrollToCurrentTrack=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio(),e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylistQueue();if(this._audioRowsAutoList&&_&&e.indexOfAudio(_)>=0)for(var t=10;t--;){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_CURRENT_CLS,this._audioRowsAutoList.getListEl());if(i){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getXY)(i)[1];this._scroll.scroller.scrollTop=o-(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_10__.scrollGetY)()-300,this._scroll.update(),this._layerStartInit=!1;break}this._audioRowsAutoList.drawMore(),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().updateCurrentPlaying()}},AudioPage.prototype.onLayerShow=function(_){this._layerStartInit=!0;var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentPlaylist(),t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isPodcast((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio());if(t)this.showSection("podcast");else if(e)this.showSection("current");else if(_){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylistQueue().isEmpty()&&"current"===_?this.showSection("all"):this.showSection(_)}else this.showSection("all");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_tab__current",this._els.pageContainer),"unshown",!e||t),this.initNavigation(),this.updateCurrentPlayingInfo(),this._initKeyEvents(),this.updateLayerHeight(),this.updateShuffleButton(),this.scrollToCurrentTrack(),delete this._muteSearch},AudioPage.prototype.resetSection=function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section__"+_,this._els.sections);this.catalogController.deleteSection(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.re)(e)},AudioPage.prototype.isUpdateRequested=function(_){return Array.isArray(sectionsToUpdate)&&sectionsToUpdate.includes(_+this.getOwnerId())},AudioPage.disableAdsClick=function(_){(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_7__.statlogsValueEvent)("audio_web_ad_link","click"),nav.go(_)},AudioPage.prototype.requestUpdate=function(_,e){void 0===e&&(e=""),sectionsToUpdate=_.map((_=>_+e))},AudioPage.prototype.showSection=function(_,e,t){this._currentSection&&this._currentSection!==this.prevSection&&(this.prevSection=this._currentSection),this.isPodcastPage()&&(_="podcast"),"search"!==this._currentSection||"all"!==_&&"current"!==_||uiSearch.reset(this._els.searchInput,!0),this._data.onlySkeleton||layers.fullhide&&layers.fullhide(),this._switchTab(_);var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player2")&&"search"===_||this.isUpdateRequested(_);if(this._currentSection!==_||"search"===this._currentSection){this._currentSection=_;var o=this.findSectionElement(_),s=this._data.sectionData&&this._data.sectionData[_]||{};if(s.name=_,t||(this._data.onlySkeleton=!1),o&&(!i||!1===t)&&!this._data.onlySkeleton){if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass)("_audio_section",this._els.pageContainer),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchGlobalBlocks),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchGlobalCommunitiesPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchGlobalPlaylistsPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchGlobalArtistsPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchGlobalAudiosBlock),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player2")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.searchNoLocalResults),"search"===_&&!o.innerHTML)){var a,l;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(this._els.searchNoLocalResults);var n=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),r=vk.id===+this._ownerId?n.langs.audio_no_local_results:_shared_ranges__WEBPACK_IMPORTED_MODULE_45__.Ranges.isUserId(this._ownerId)?n.langs.audio_no_user_local_results:n.langs.audio_no_group_local_results,d=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.winToUtf)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.clean)(null!=(a=null==(l=s.searchParams)?void 0:l.globalQuery)?a:""));this._els.searchNoLocalResults.innerHTML=r.replace("{query}","<strong>"+d+"</strong>")}if(this._onSectionOut(),delete cur._back,"podcast"!==_&&(this.catalogController.setSection(_,o,s||{}),this.isLayer()||_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_34__.FullscreenBanner.initiate(s.sectionId)),this._destroyAutoplayBlock(),this._onSectionOut((()=>{this.catalogController.disableSection(_)})),this.isLayer()||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentPlaylist()||!s.title||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setDocumentTitle)(s.title),!["podcast","current"].includes(_))return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isFunction)(e)&&e(),void(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().updateCurrentPlaying();switch(_){case"current":this._initSection_current(o,s,!0);break;case"podcast":this._initSection_podcast(o,s)}return(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().updateCurrentPlaying(),void((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isFunction)(e)&&e())}var u=this._ownerId,c=!1;if("podcast"===_&&!this.isPodcastPage()){var h=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;u=h[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID],(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_39__.getAudioExtra)(h).voiceAssistant&&(c=!0)}if(this.isUpdateRequested(_)&&(sectionsToUpdate=null),c)setTimeout((()=>{var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.se)(`<div class="audio_section _audio_section _audio_section__${_} audio_section__${_} clear_fix audio_w_covers">\n        <div class="page_block audio_block">\n          <div class="audio_page__audio_rows _audio_page__audio_rows">\n            <div class="audio_page__audio_rows_list _audio_page__audio_rows_list audio_w_covers"></div>\n          </div>\n        </div>\n      </div>`);this._els.sections.appendChild(t),delete this._currentSection,this.showSection(_,e,!1)}));else{var E="",p={};if(this._data.onlySkeleton&&s.sectionId)E="/audio?act=load_catalog_section",p.section_id=s.sectionId;else{E="al_audio.php";var P={act:"section",section:_,owner_id:u,is_layer:this.isLayer()?1:0,claim:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(nav.objLoc.claim)};"search"===_&&(P.query_id=this._cur_qid),p=(0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_47__.default)({},this._sectionData,{},P)}ajax.post(E,p,{onDone:(t,i)=>{this._data.sectionData=this._data.sectionData||{},this.findSectionElement(_)&&t&&this.resetSection(_),this._data.sectionData[_]=i;var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.se)('<div class="audio_section _audio_section _audio_section__'+_+" audio_section__"+_+' clear_fix audio_w_covers">'+t+"</div>");this._els.sections.appendChild(o),delete this._currentSection,this.showSection(_,e,!1)},onFail:()=>!0}),delete this._sectionData}}else(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isFunction)(e)&&e()},AudioPage.prototype._onSectionOut=function(_){_?(this._onSectionOutCbs=this._onSectionOutCbs?this._onSectionOutCbs:[],this._onSectionOutCbs.push(_)):((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)(this._onSectionOutCbs||[],(function(_,e){e()})),this._onSectionOutCbs=[])},AudioPage.prototype.findSectionElement=function(_){return this._els.sections.getElementsByClassName("_audio_section__"+_)[0]},AudioPage.prototype.onPlaylistsReorder=function(_,e,t){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(_,"raw-id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(t,"raw-id");ajax.post("al_audio.php",{act:"reorder_playlist",owner_id:this.getOwnerId(),playlist_id:i.split("_")[1],prev_playlist_id:o?o.split("_")[1]:0,hash:this._data.reorderHash},{onFail:()=>!0})},AudioPage.prototype._initSection_current=function(_,e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.extend)(this._els,{audioRows:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page__audio_rows_list",_),audioRowsMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_more_rows",_),friendsBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_friends_list_wrap",_),friendsBlockContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_friends_list_content",_)});var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentPlaylist();if(!t&&!this.retriedCurrent)return this.retriedCurrent=!0,setTimeout((()=>this._initSection_current(_,e)));this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_18__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),t&&(this._pagePlaylist=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(this._els.audioRows,"playlist-id",t.getId()));var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_friends_search",_);i&&uiSearch.init(i),this._initAudioRowsAutoList(!0),setTimeout((()=>this._initFixedFriendsBlock(_)))},AudioPage.prototype.drawMore=function(){this._audioRowsAutoList&&this._audioRowsAutoList.drawMore()},AudioPage.prototype.scrollIntoView=function(_,e){this._scroll.scrollIntoView(_,e)},AudioPage.prototype._initSection_podcast=function(_,e){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.extend)(this._els,{audioRows:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page__audio_rows_list",_),audioRowsMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("podcast_episodes_more",_)});var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentPlaylist();if(!t){var i=e.playlistData;i&&((t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylist(i.type,i.ownerId,i.id)).getAudiosCount()||(t.mergeWith(i),t.load()))}t&&(this._pagePlaylist=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(this._els.audioRows,"playlist-id",t.getId())),this._initAudioRowsAutoList(),this._data.reverse||this._enableAudioRowsSorter()},AudioPage.prototype.setPagePlaylist=function(_){this._pagePlaylist=_},AudioPage.prototype._initFixedFriendsBlock=function(){if(this._els.friendsBlock){this._isFixed=!1,this._isDraggable=!1,this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getXY)(this._els.friendsBlock);var _=this.isLayer(),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getSize)("page_header")[1],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getSize)(this._els.playerWrap)[1],i=_?13:15;this._fixedThreshold=_?e+t+i:this._initialPos[1]-e-t-i;var o=_?this._scroll.scroller:window;if(!(this._fixedThreshold<0)){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(window,"resize",this._resizeHandler=()=>{this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getXY)(this._els.friendsBlock)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(o,"scroll",this._scrollHandler=()=>{this._moveFriendsBlock()});var s=this;AudioPage.onUpdateDraggablePosition=()=>{s._isDraggable=!0,s._moveFriendsBlock(),requestAnimationFrame((()=>s._isDraggable=!1))},AudioPage.forceFix=()=>{var _=s._els.friendsBlockContent.getBoundingClientRect();if(_.width>0&&_.height>0){var e=s.isLayer()?s._scroll.scroller.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_10__.scrollGetY)();s._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,e-s._fixedThreshold-9)}px)`,s._unfixedFriendsBlock()}},this._onSectionOut((()=>{this._scrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(o,"scroll",this._scrollHandler),this._resizeHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window,"resize",this._resizeHandler),this._fixedBlockScrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(this._els.friendsBlockContent,"audio_friends_fixed")}))}}},AudioPage.prototype._moveFriendsBlock=function(){var _=this.isLayer()?this._scroll.scroller.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_10__.scrollGetY)(),e=this._els.friendsBlockContent.getBoundingClientRect(),t=e.width>0&&e.height>0;this._isDraggable&&t?(this._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,_-this._fixedThreshold-9)}px)`,this._unfixedFriendsBlock()):(this._els.friendsBlockContent.style.transform="",_>this._fixedThreshold?this._fixedFriendsBlock():this._unfixedFriendsBlock())},AudioPage.prototype._fixedFriendsBlock=function(){this._isFixed||(this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getXY)(this._els.friendsBlock),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!0,this.isLayer()&&(this._fixedBlockScrollHandler=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(this._els.friendsBlockContent,"mousewheel",(_=>(this._scroll.scroller.scrollTop=this._scroll.scroller.scrollTop+_.deltaY,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(_))))))},AudioPage.prototype._unfixedFriendsBlock=function(){this._isFixed&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!1,this._fixedBlockScrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler))},AudioPage.prototype.playPlaylist=function(_,e,t,i){var o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),s=o.getCurrentPlaylist(),a=o.getPlaylist(_,e,t);s&&s.equals(a)&&o.isPlaying()?o.pause():a.load(0,(function(){o.play(a.getAudiosList()[0],a,i)}))},AudioPage.prototype.playShuffledBlockPlaylist=function(_){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),t=e.getPlaylistByBlockId(_)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist({hasMore:!0,blockId:_});t.clean(),t.loadByBlockId("",(function(_){e.play(_.getAudiosList()[0],_,_.getContext())}))},AudioPage.prototype.playBlockPlaylist=function(_,e){void 0===e&&(e=null);var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),i=t.getCurrentPlaylist(),o=t.getPlaylistByBlockId(_)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist({hasMore:!0,blockId:_});if(i&&i.equals(o)&&t.isPlaying())t.pause();else{var s=o.getContext()||e&&e.dataset.context||"";o.loadByBlockId("",(_=>t.play(_.getAudiosList()[0],_,s)))}},AudioPage.prototype.onAudioRowsReorder=function(_,e,t,i){var o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(e,"full-id"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(i,"full-id"),l=o.getPlaylistQueue(),n=this.getPageCurrentPlaylist(),r=(_?l:n).indexOfAudio(s),d=(_?l:n).indexOfAudio(a);a?d++:d=0,l.moveAudio(r,d),_&&o.saveStateCurrentPlaylist(),this.isPodcastPage()?ajax.post("al_podcasts.php",{act:"a_reorder_episodes",hash:this._data.audiosReorderHash,oid:this.getOwnerId(),episode_id:s?s.split("_")[1]:0,next_episode_id:a?a.split("_")[1]:0},{onFail:()=>!0}):_||ajax.post("al_audio.php",{act:"reorder_audios",hash:this._data.audiosReorderHash,owner_id:this.getOwnerId(),audio_id:s?s.split("_")[1]:0,next_audio_id:a?a.split("_")[1]:0},{onFail:()=>!0})},AudioPage.prototype._enableAudioRowsSorter=function(_){(this._data.audiosReorderHash||_)&&(this._audioRowsSorter&&this._audioRowsSorter.destroy(),this._audioRowsSorter=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_25__.default(this._els.audioRows,"",{wrapNode:this.isLayer()?this._scroll.scroller:void 0,onReorder:(e,t,i)=>this.onAudioRowsReorder(_,e,t,i)}),this._onSectionOut(function(){this._audioRowsSorter&&this._audioRowsSorter.destroy()}.bind(this)))},AudioPage.prototype._disableAudioRowsSorter=function(){this._audioRowsSorter&&this._audioRowsSorter.disable()},AudioPage.prototype._initAutoplayBlock=function(_,e){(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("autoplay_web")&&(this._els.autoplayBlock||(this._els.autoplayBlock=new _web_audio_components_AutoplayBlock__WEBPACK_IMPORTED_MODULE_43__.AutoplayBlock),this._els.autoplayBlock.init(_,e))},AudioPage.prototype._destroyAutoplayBlock=function(){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("autoplay_web")){if(!this._els.autoplayBlock)return;this._els.autoplayBlock.destroy()}},AudioPage.prototype._onCurrentSectionNeedRows=function(){var _=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_48__.default)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__.mark((function _(e,t){var i,o;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__.wrap((function(_){for(;;)switch(_.prev=_.next){case 0:return i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylistQueue(),_.next=3,i.getAudios(t,t+_shared_audio_enums__WEBPACK_IMPORTED_MODULE_31__.AUDIO_PLAYER_ENUMS.AUDIO_QUEUE_MAX_AUDIOS_COUNT);case 3:o=_.sent,e(o);case 5:case"end":return _.stop()}}),_)})));return function(e,t){return _.apply(this,arguments)}}(),AudioPage.prototype._initAudioRowsAutoList=function(_){if(void 0===_&&(_=!1),this._els.audioRows){var e=this.isPodcastPage()||"podcast"===this._currentSection,t=this._pagePlaylist;this._els.audioRows.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(this._els.audioRows,"audio_owner_list_canedit",!e&&!!this._data.canEdit),this._audioRowsAutoList&&this._audioRowsAutoList.destroy(),this._audioRowsAutoList=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_15__.default(this._els.audioRows,{scrollNode:!!this._scroll&&this._scroll.scroller,onRendered:function(){(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().updateCurrentPlaying()},onNoMore:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(this._els.audioRowsMore),_&&this._initAutoplayBlock(this.getCurrentSectionEl(),this._scroll)}.bind(this),offset:0,onNeedRows:function(i,o,s,a,l){var n=this,r=[],d=function(_){void 0===_&&(_=[]),_.forEach((_=>{r.push(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.drawAudio(_))})),i(r),0===o&&n._audioRowsSorter&&n._audioRowsSorter.update(),0===o&&1===r.length&&l.drawMore()};e?((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.lockButton)(this._els.audioRowsMore),this._loadPodcastEpisodes(o,function(_){d((_||[]).slice(o)),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.unlockButton)(this._els.audioRowsMore)}.bind(this))):_?this._onCurrentSectionNeedRows(d,o):t&&t.load(o,(()=>{var _=t.getAudiosList();d(_)}))}.bind(this)}),this._onSectionOut(function(){this._destroyAutoplayBlock(),this._audioRowsAutoList.destroy(),this._els.audioRows.innerHTML=""}.bind(this))}},AudioPage.prototype._loadPodcastEpisodes=function(_,e){var t,i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio()||this._readyAudio,o={};try{o=JSON.parse(i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_EXTRA])}catch(_){}if(o&&o.externalAudio){var s=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentPlaylist();e(s._ref._list)}else{t=this.isPodcastPage()?this._ownerId:i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID],cur._podcastsEpisodes=cur._podcastsEpisodes||{},cur._podcastsEpisodes[t]=cur._podcastsEpisodes[t]||[];var a=cur._podcastsEpisodes[t];a.length&&_<a.length?e(a):ajax.post("al_podcasts.php",{act:"a_episodes",oid:t,episode_full_id:i?i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_ID]:"",offset:_,rev:this._data.reverse,claim:window.nav.objLoc.claim},{onDone:function(_){cur._podcastsEpisodes[t]=a.concat(_||[]),e(cur._podcastsEpisodes[t])},onFail:function(){return e(cur._podcastsEpisodes[t]),!0}})}},AudioPage.showAttachBox=function(_,e){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)().bodyNode),"offset")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)().bodyNode),"offset",0),1===vk.widget?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showBox)("al_audio.php",{act:"choose_box",owner_id:_,options:JSON.stringify(e)}):AudioPage.editPlaylist(_,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",e)},AudioPage.editPlaylist=function(_,e,t,i){if(vk.widget)for(var o in i)i.hasOwnProperty(o)&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isString)(i[o])?i[o]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.clean)(i[o]):(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isFunction)(i[o])?delete i[o]:i[o]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(i[o]));var s,a;if("edit"===t&&i&&(i.audioAttachSwitchOwnerId=!1),i&&i.audioAttachSwitchOwnerId&&(cur.audioAttachSwitchOwnerId=i.audioAttachSwitchOwnerId),t=t||"edit",e)s=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_PLAYLIST,_,e);else if(cur.audioPage){var l=cur.audioPage._data.maxPlaylistsCount;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isArray)(cur.audioPage._data.playlists)&&cur.audioPage._data.playlists.length>=l){var n=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.langNumeric)(l,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.curLang("audio_playlists_limit_error")).replace("{limit}",l);return void new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.MessageBox({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_error")}).content(n).setButtons("Ok",(function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)().hide()})).show()}}var r=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.showBoxLoader)();(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_24__.parallel)((_=>{window.stManager.add(["audio.css",window.jsc("web/indexer.js"),window.jsc("web/auto_list.js"),window.jsc("web/grid_sorter.js"),"edit"===t&&window.jsc("web/upload.js")],_)}),(_=>{s?(s.setForceReload(!0),s.loadAll(_,t)):_()}),(e=>{if(cur.audioPage&&cur.audioPage.getOwnerId()===+_&&!(null==i?void 0:i.promotedAudios)&&(a=cur.audioPage.getOwnerPlaylists()),null==i?void 0:i.promotedAudios){var o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)();a=[],i.addAudio=[],i.promotedAudios.forEach(((_,t,s)=>{var a=o.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_PLAYLIST,_[0],_[1]);0===a.getAudiosCount()&&void 0===a.getTotalCount()?a.load((()=>{i.addAudio.push(...a.getAudiosList()),t===s.length-1&&e()})):(i.addAudio.push(...a.getAudiosList()),t===s.length-1&&e())}))}else a?e():AudioPage.loadPlaylists(_,void 0,!1,"attach"===t,(_=>{a=_,e()}))}),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.isBoxLoadingCancelled)(r)||AudioPage._openEditPlaylist(t,_,e,a,i)}))},AudioPage.initBoxEls=function(_){return{boxContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_pl_edit_box",_.bodyNode),playlistNameInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ape_pl_input",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ape_pl_title",_.bodyNode)),playlistDescriptionInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ape_pl_input",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ape_pl_description",_.bodyNode)),playlistDiscoverToggle:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ape_discover_checkbox",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ape_pl_discover",_.bodyNode)),playlistUpdateIdInput:_.bodyNode.querySelector("#ape_pl_to_update_id"),playlistUpdateTimeInput:_.bodyNode.querySelector("#ape_pl_to_update_time"),playlistUpdateCutInput:_.bodyNode.querySelector("#ape_pl_to_update_cut"),playlistUpdateFilterInput:_.bodyNode.querySelector("#ape_pl_to_update_filter"),stat:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_pl_stat",_.bodyNode),uploadCoverButtonWrapper:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_cover",_.bodyNode),uploadCoverInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_cover_upload",_.bodyNode),errorMsg:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_error_msg",_.bodyNode),header:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_header",_.bodyNode),search:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_search",_.bodyNode),searchInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_field",_.bodyNode),addAudiosButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ape_add_audios_btn",_.bodyNode),addAudiosFromPlaylistsButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ape_add_pl_audios_btn",_.bodyNode),listWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_list_wrap",_.bodyNode),list:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_item_list",_.bodyNode),globalResults:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_item_global_results",_.bodyNode),globalResultsList:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_item_global_list",_.bodyNode),emptyPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_audios_empty_list",_.bodyNode),emptyPlaylistsPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_audios_empty_playlists_list",_.bodyNode),emptyGlobalPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_audios_empty_global_list",_.bodyNode)}},AudioPage.showRecomsOnboarding=function(_){void 0===_&&(_=!1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(boxLoader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(boxLayerWrap),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.boxRefreshCoords)(boxLoader),ajax.post("al_audio.php?act=get_recoms_onboarding",{load_script:+_},{onDone:_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(boxLoader);var e=!1;if(window.AudioRecomsOnboarding)if(window.AudioRecomsOnboarding.checkFinalScreen())window.AudioRecomsOnboarding.showFinalScreenFromLS(),e=!0;else if(_){new window.AudioRecomsOnboarding(_).show(),e=!0}e||(window.nav.change({popup:!1}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(boxLayerWrap))}})},AudioPage._openEditPlaylist=function(_,e,t,i,o){var s,a,l,n,r,d,u,c,h=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),E=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_TEMP,e,(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.irand)(0,999999));if((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)()){d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)().bodyNode),"offset"),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.val)("ape_edit_playlist_search");var p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)().bodyNode);p&&(c=p.scrollTop)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(boxLoader),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)()||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(boxLayerWrap),cur.apLayer&&(r=cur.apLayerPlaylistId,layers.fullhide()),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.extend)({audioPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_add_media"),playlistPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_attach_playlist_button"),canPlaylistAttach:!1,onAudioChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.onAudioChoose,onPlaylistChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.onPlaylistChoose},o),cur.onChooseAudio=o.onAudioChoose,cur.onChoosePlaylist=o.onPlaylistChoose;var P,b=!t||t===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.DEFAULT_PLAYLIST_ID,g="attach"===_,O=!!(null==(s=o)?void 0:s.promotedAudios),D=!1,M=!1,m=!1,C=!1,A=0,w=null,y=!0,v=!1,T=0,I=0;i=i.filter((_=>_.id!==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.DEFAULT_PLAYLIST_ID&&_.size>0));var B=new _web_indexer_indexer__WEBPACK_IMPORTED_MODULE_23__.vkIndexer(i,(_=>_.title)),f=i.length>0,L=!1;b&&!g||O?o.addAudio&&E.pushAudio(o.addAudio):(L=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_PLAYLIST,e,t),E.pushAudio(L.getAudiosList()),E.mergeWith({title:L.getTitle(),description:L.getDescription(),rawDescription:L.getRawDescription(),coverUrl:L.getCoverUrl(),editHash:L.getEditHash(),noDiscover:L.getNoDiscover()}));var R=g?_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_choose_audio_title"):t?_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_edit_playlist_title"):_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_new_playlist_title");function U(_){if(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.trim)(_)){var e=" "+(_+"|")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.parseLatin)(_)||"")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.parseCyr)(_)||"");e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.trim)(e.replace(/\)/g,"").replace(/&/,"&amp;")),C=new RegExp("(\\s|^)("+e.replace(_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_23__.vkIndexer.delimiter,"|").replace(/(^\||\|$|\?)/g,"")+")","gi")}else C=!1;q(M,"playlists"!==D,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.emptyGlobalPlaceholder)}function W(){o.onClose&&o.onClose(),y||(E.clean(),h.deletePlaylist(E),r&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.showAudioPlaylist(r[0],r[1]))}function K(e){return!(v&&!e&&"attach"!==_)||(t?(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_edit_playlist_cancel_confirm_text"),o=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_edit_playlist_cancel_confirm_yes")):(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_new_playlist_remove_confirm_text"),o=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_new_playlist_remove_confirm_continue")),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_warning"),i,o,(()=>{y=!1,(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)().hide(),a.hide(!0)}),_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_cancel")),!1);var i,o}function S(){return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.trim)(l.searchInput.value)}function k(e){var t=E.indexOfAudio(e)>=0?"ape_selected":"",i=e;C&&((e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.clone)(i))[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_TITLE].replace(C,"$1<em>$2</em>"),e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER].replace(C,"$1<em>$2</em>"));var s="";if("edit"===_){s=`<div class="ape_check">\n        <div class="ape_check--unchecked">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_49__.getIcon24CheckCircleOff)().icon}</div>\n        <div class="ape_check--checked">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_50__.getIcon24CheckCircleOn)().icon}</div>\n      </div>`}else{var a=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(i);if(o&&o.wiki)s='<div role="button" class="ape_attach" onclick="'+`editorChooseAudio(\n        '${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.clean)(a.performer)}',\n        '${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.clean)(a.title)}',\n        ${a.duration},\n        '${a.fullId}',\n        '${a.url}',\n        ${a.duration},\n        this)`+'">'+o.audioPickerButtonText+"</div>";else s=`<div role="button" class="ape_attach" onclick="cur.onChooseAudio(event, this, ${a=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.clean)(JSON.stringify(a))}, ${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.clean)(JSON.stringify(i))})">${o.audioPickerButtonText}</div>`}return'<div class="ape_audio_item_wrap _ape_audio_item '+t+'">'+s+_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.drawAudio(e)+"</div>"}function x(){clearTimeout(T);var _=S();_&&(T=setTimeout((function(){T=!1,(m=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_24__.hashCode)(_+"no conflict"))).mergeWith({searchParams:{globalQuery:_},hasMore:!0});var e=0;n&&(e=n.getOffset(),n.destroy()),(n=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_15__.default(l.list,{scrollNode:l.list,onNeedRows:function(_,t){t-=e,m.load(t,(function(){var e=[],i=m.getAudiosList();if(0==+t&&i.length&&e.push('<div class="ape_list_header">'+_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_edit_playlist_global_results")+"<div>"),i.length)for(var o=Math.min(i.length,t+20),s=t;s<o;s++)i[s]&&e.push(k(i[s]));m.getAudiosCount()||n&&n._offset?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.list)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.list)),_(e)}))}})).drawMore()}),300),w=null)}function H(){a.setOptions({title:'<div class="back _back"><span class="back__icon">'+(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_51__.getIcon24ChevronLeft)().icon+"</span>"+_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_back")+"</div>",bodyStyle:"padding: 0"})}function F(){var _="";cur.audioAttachSwitchOwnerId&&cur.audioAttachOriginalOwnerId&&(_='<span class="dvd"></span><a class="tab_link" onclick="cur.audioAttachSwitch()">',_+=_shared_ranges__WEBPACK_IMPORTED_MODULE_45__.Ranges.isGroupId(E.getOwnerId())?_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_choose_wall_to_my_audios"):_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_choose_wall_to_group_audios"),E.getOwnerId()===cur.audioAttachOriginalOwnerId?cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachSwitchOwnerId,o)}:cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachOriginalOwnerId,o)},_+="</a>"),a.setOptions({title:R+_,bodyStyle:"padding: 0"})}function N(){var _=l.boxContent.getBoundingClientRect();if(_.height&&_.width){var e=l.list.getBoundingClientRect();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(l.list,{height:_.height-(e.y-_.y)})}}function q(_,e,t){M=_,e&&M?t?M.search({q:t},(function(_){z(!0,_)})):z(!0,M.getAudiosList(),_):z(!1,t?B.search(t):i),Y("initial"===D&&!t)}function z(_,e,t){l.list.innerHTML="",n&&n.destroy(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.emptyPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.emptyPlaylistsPlaceholder),N();var i=0;n=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_15__.default(l.list,{scrollNode:l.list,onNoMore:function(){0===i&&(S()?_||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.emptyPlaylistsPlaceholder)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.emptyPlaceholder))),O?function(){clearTimeout(I);var _=S();_&&(I=setTimeout((function(){I=!1;var e=0;n&&(e=n.getOffset(),n.destroy()),n=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_15__.default(l.list,{scrollNode:l.list,onNeedRows:function(t,i){i>e?t([]):(i-=e,ajax.post("/audio?act=load_catalog_section",{section_id:o.audioSectionId,search_query:_},{onDone:function(){var _,e,o=(null==(_=arguments[1])||null==(e=_.playlist)?void 0:e.list)||[],s=[];0==+i&&o.length&&s.push('<div class="ape_list_header">'+_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_edit_playlist_global_results")+"<div>"),o.length&&o.forEach((_=>{s.push(k(_))})),o&&o.length?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.list)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.emptyGlobalPlaceholder)),t(s)},onFail:function(_){return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_error"),width:350},_),!0}}))}}),n.drawMore()}),100),w=null)}():_&&x()},onNeedRows:function(o,s){var a=d||20,l=t&&t.hasMore()?s+a:Math.min(e.length,s+a);if(l>e.length&&t&&t.hasMore())t.load(s+a,(a=>{var n=G((e=t.getAudiosList()).slice(s,l),_);i+=n.length,o(n)}));else{var n=G(e.slice(s,l),_);i+=n.length,o(n)}},onRendered:_=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)(l.list,"offset",_),c&&d&&(l.list.scrollTop=c,d=0,c=0)}})}function G(_,e){var t=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_52__.getIcon24Playlist)().icon,i=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_53__.getIcon24ChevronRight)().icon;return _.map((_=>{if(e)return k(_);var o='<div class="ape_pl_item_inner"><span class="ape_pl_title">'+(C?_.title.replace(C,"$1<em>$2</em>"):_.title)+'</span> <span class="ape_pl_size">'+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.langNumeric)(_.size,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.curLang("audio_playlist_audios_count"),!0).replace("{count}",_.size)+"</span></div>";return`<div class="ape_pl_item"\n                        data-playlist-access-hash="${_.access_hash}"\n                        data-playlist-owner-id="${_.owner_id}"\n                        data-playlist-id="${_.id}">\n                          <div class="ape_pl_item__icon_playlist">${t}</div>\n                          ${o}\n                          <div class="ape_pl_item__icon_chevron">${i}</div>\n                        </div>`}))}function Y(_){P||(P=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_25__.default(l.list,"ape_audio_item_wrap",{wrapNode:l.list,onReorder:function(_,e){var t,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_row",_),"full-id"),o=E.indexOfAudio(i);e?(i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_row",e),"full-id"),t=E.indexOfAudio(i)):t=E.getAudiosCount(),E.moveAudio(o,t)}})),_?P.enable():P.disable()}function $(t,s){if("default"===t&&cur.audioPage&&cur.audioPage._data.addBanned)(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_error")},cur.audioPage._data.addBannedText);else{switch(D=t,a.removeButtons(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(l.list,"view",t),t){case"initial":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.globalResults),q(E,!0),j(),F();break;case"default":var n=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_PLAYLIST,e,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.DEFAULT_PLAYLIST_ID);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.disableEl)(l.addAudiosButton),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.showProgress)(l.addAudiosButton),n.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.enableEl)(l.addAudiosButton),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.hideProgress)(l.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggle)(l.addAudiosFromPlaylistsButton,f),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.addAudiosButton),"edit"===_?H():F(),q(n,!0,u),N(),"edit"===_&&j()}));break;case"playlists":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.globalResults),H(),q(i);break;case"playlist":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.addAudiosButton),H(),q(s,!0),g&&function(_){if(!o.canPlaylistAttach)return;function e(e){cur.onChoosePlaylist(e,_)}a.addButton(o.playlistPickerButtonText,e,"ok",!0)}(s),"edit"===_&&j()}N(),l.searchInput.value="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.elfocus)(l.searchInput),C=!1,w=null,clearTimeout(T),h&&h.updateCurrentPlaying&&h.updateCurrentPlaying()}}function j(){a.addButton(_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_save_playlist_button"),X,"ok",!0)}function V(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domClosest)("ape_pl_item",_.target);if(e){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(e,"playlist-id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(e,"playlist-owner-id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(e,"playlist-access-hash"),s=h.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_PLAYLIST,i,t,o);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.showProgress)(e),s.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.hideProgress)(e),$("playlist",s)}))}if(_.target.closest(".ape_check")){function b(_,e){if(cur.audioPage&&cur.audioPage._data.addBanned)(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_error")},cur.audioPage._data.addBannedText);else{var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(_,"ape_selected",e),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_row",_),o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.getAudioFromEl(i);t?E.pushAudio(o,0):E.removeAudio(o)}}var a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domClosest)("_ape_audio_item",_.target);if(_.shiftKey&&w){var n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domChildIndex)(w),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domChildIndex)(a),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domPN)(a);if(n>r){var u=r;r=n,n=u}for(var c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hasClass)(w,"ape_selected"),p=n;p<=r;p++)b(d.children[p],c)}else b(a),w=a;Q(),__()}if(g&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hasClass)(_.target,"artist_link")){if(_.metaKey&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_3__.browser.mac||_.ctrlKey)return;var P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(_.target,"performer")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.trim)(_.target.innerText);P&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.val)(l.searchInput,P),uiSearch.onChanged(l.searchInput),U(P))}return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(_)}function Q(){var _,e=E.getAudiosCount(),t=E.getTotalDuration();if(e){var i;_=(_=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.langNumeric)(e,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.curLang("audio_edit_playlist_audios_info"))).replace("{count}",e);var o=t%60,s=Math.floor(t/60)%60,a=Math.floor(t/3600);t<60?i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.langNumeric)(t,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.curLang("audio_total_dur_seconds")):t<3600?(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.langNumeric)(s,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.curLang("audio_total_dur_minutes")),o&&(i+=" "+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.langNumeric)(o,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.curLang("audio_total_dur_seconds")))):(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.langNumeric)(a,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.curLang("audio_total_dur_hours")),s&&(i+=" "+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.langNumeric)(s,_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.curLang("audio_total_dur_minutes")))),_+='<span class="dvd">'+i+"</span>"}else _=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_edit_playlist_no_audios");l.stat.innerHTML=_}function X(_){var t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.val)(l.playlistNameInput));t=t.replace(/[\u200B-\u200D\uFEFF]/g,"");var i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.val)(l.playlistDescriptionInput)),s=+(l.playlistDiscoverToggle&&l.playlistDiscoverToggle.classList.contains("on"));if(l.playlistUpdateIdInput&&(t=`${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.trim)(l.playlistUpdateIdInput.value)}_${l.playlistUpdateTimeInput.valueAsNumber}_${l.playlistUpdateCutInput.valueAsNumber}`),!t)return $("initial"),void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.notaBene)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.ge)("ape_pl_name"));var n=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)(E.getAudiosList(),(function(_,e){n.push(e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_ID]+"_"+e[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_31__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY])}));var r=o.newPlaylistHash||cur.audioPage&&cur.audioPage._data.newPlaylistHash||"",d={hash:b?r:L.getEditHash(),owner_id:e,playlist_id:b?0:L.getPlaylistId(),title:t,description:i,Audios:n.join(","),cover:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isObject)(A)?JSON.stringify(A):A};l.playlistUpdateIdInput&&(d.update_id=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.trim)(l.playlistUpdateIdInput.value),d.update_time=(l.playlistUpdateTimeInput.valueAsNumber+6e4*(new Date).getTimezoneOffset())/1e3,d.update_cut=l.playlistUpdateCutInput.valueAsNumber,d.update_filter=l.playlistUpdateFilterInput.classList.contains("on")?1:0),null!==s&&(d.no_discover=s),ajax.post("al_audio.php?act=save_playlist",d,{showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.lockButton)(_),onDone:(_,t)=>{b&&!document.querySelector(".CatalogSection ._audio_page__playlists")?nav.reload():((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass)("_audio_pl_"+_.ownerId+"_"+_.id),(function(){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_pl__cover",this);if(e){AudioPage.setCoverImageElem(e,_.coverUrl,_.title);var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_pl_grid_covers_wrap",this);t&&(t.innerHTML=_.coverUrl?"":_.gridCovers)}var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_pl__title",this);if(i){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_item__title",i);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.val)(o||i,_.title)}var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_pl__stats_count",this);s&&(s.innerHTML=_.totalCount)})),b&&cur.audioPage&&e==cur.audioPage.getOwnerId()&&["all","my_playlists"].includes(cur.audioPage._currentSection)&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)(cur.audioPage._els.pageContainer.querySelectorAll(".CatalogBlock__my_playlists ._audio_page_block__playlists_items"),(function(){var _=t.thumb,e=t.title,i=(0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_47__.default)({},t,{cover_image:AudioPage.getCoverImage(_,e)}),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.getTemplate)("audio_pl_item",i)),s=this;if(s.classList.contains(_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_35__.UI_GALLERY_CLASSNAME)){var a=(0,_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_35__.uiGetGallery)(s),l=document.createElement("div");l.classList.add("ui_gallery_item"),l.appendChild(o),a.addItems([l],0)}else{s.insertBefore(o,s.firstChild);var n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(s,"max-items"));n&&s.children.length>n&&s.removeChild(s.lastChild)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.gpeByClass)("_audio_page__playlists",s))})),cur.audioPage._data.playlists=cur.audioPage._data.playlists||[],cur.audioPage._data.playlists.unshift(t)),b&&cur.audioPage&&cur.audioPage.catalogController.updateSectionReorder(),cur.audioPage&&cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(e),L&&(L.clean(),L.mergeWith(_)),a.hide(!0),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isFunction)(o.onPlaylistSave)&&o.onPlaylistSave(L))},onFail:()=>(a.hide(!0),!0)})}function J(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.coverThumb),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(l.coverThumb,"background-image","url("+_+")"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)(l.uploadCoverButtonWrapper,"ape_thumb_set"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.uploadCoverButton)}function Z(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(l.uploadCoverButtonWrapper,"ape_thumb_set"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_cover_thumb")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.uploadCoverButton),A=-1,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(_)}function __(){v=!0}(2===vk.widget||3===vk.widget)&&window.box&&(!boxQueue.count()&&!(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)()||cur.audioChooseBox===(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)())?(a=window.box).setOptions({title:R,bodyStyle:"padding: 0",width:560,onBeforeHide:W,onHideAttempt:K,hideButtons:!0}):(cur.audioChooseBox&&cur.audioChooseBox===(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)().hide(),a=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.MessageBox({title:R,bodyStyle:"padding: 0",width:560,onBeforeHide:W,onHideAttempt:K})),cur.audioChooseBox=a,a.content((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.getTemplate)("audio_edit_playlist")),a.show(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)(a,"ownerId",e),l=AudioPage.initBoxEls(a),function(){var t=window.innerHeight;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(l.boxContent,"height",Math.min(800,Math.max(t-200,500))),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(l.addAudiosFromPlaylistsButton,"click",$.bind(this,"playlists")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(l.addAudiosButton,"click",$.bind(this,"default")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(l.list,"click",V),g&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(l.list,"audio-context","attach");(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(a.titleWrap,"click",(function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hasClass)(_.target,"_back")&&function(){switch(D){case"initial":break;case"default":$("initial");break;case"playlists":$("default");break;case"playlist":$("playlists")}}()})),uiSearch.init("ape_edit_playlist_search",{onChange:U}),"edit"===_&&($("initial"),Q(),function(){if(!cur.audioCoverUploadOptions||!cur.audioCoverUploadOptions[e])return;var _=cur.audioCoverUploadOptions[e],t={file_name:"photo",file_size_limit:5242880,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",onUploadStart:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_cover_progress"))},onUploadComplete:function(_,e){(e=JSON.parse(e)).error?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.show)(l.errorMsg),N()):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)(l.errorMsg),J((A=e).url),__(),N()),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_cover_progress"))},onUploadProgress:function(_,e,t){},onUploadError:function(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_cover_progress"))},clear:1,type:"photo",max_attempts:3,server:_.server,noCheck:!0,chooseBox:!0,uploadButton:!0,accept:".jpg,.jpeg,.png",filesize_hide_last:!0,label:_.button};function i(){(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.isObject)(A)&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_cover_progress"))||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByTag1)("input",l.uploadCoverButtonWrapper).click()}Upload.init(l.uploadCoverButtonWrapper,_.url,_.vars,t),l.uploadCoverButton=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ape_cover_accessibility_upload_btn",a.bodyNode),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_cover_delete"),"click",Z),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(l.uploadCoverButton,"click",(()=>i())),l.coverThumb=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_ape_cover_thumb")}(),E.getCoverUrl()&&J(E.getCoverUrl()),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_8__.autosizeSetup)(l.playlistDescriptionInput,{minHeight:30,maxHeight:150,onResize:N}),l.playlistNameInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.replaceEntities)(E.getTitle()),l.playlistDescriptionInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.replaceEntities)(E.getRawDescription().replace(/<br>/g,"\n")),l.playlistDiscoverToggle&&l.playlistDiscoverToggle.classList.toggle("on",E.getNoDiscover()),l.playlistNameInput.addEventListener("input",__),l.playlistDescriptionInput.addEventListener("input",__),l.playlistDiscoverToggle&&l.playlistDiscoverToggle.addEventListener("click",__),l.playlistUpdateIdInput&&cur.editorialPlaylistsParams&&(l.playlistUpdateIdInput.value=cur.editorialPlaylistsParams.target_playlist,l.playlistUpdateTimeInput.valueAsNumber=1e3*cur.editorialPlaylistsParams.update_time-6e4*(new Date).getTimezoneOffset(),l.playlistUpdateCutInput.valueAsNumber=cur.editorialPlaylistsParams.update_cut,l.playlistUpdateFilterInput.classList.toggle("on",1===cur.editorialPlaylistsParams.update_filter),l.playlistUpdateFilterInput.setAttribute("aria-checked",1===cur.editorialPlaylistsParams.update_filter),l.playlistUpdateIdInput.addEventListener("input",__),l.playlistUpdateTimeInput.addEventListener("input",__),l.playlistUpdateCutInput.addEventListener("input",__),l.playlistUpdateFilterInput.addEventListener("click",__)));O?$("playlist",E):g&&$("default");F(),L&&"attach"!==_&&a.setControlsText(`<a onclick="AudioPage.deletePlaylist(${L.getOwnerId()}, ${L.getPlaylistId()}, '${L.getEditHash()}')">\n                              ${_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_delete_playlist")}\n                            </a>`)}(a.bodyNode),u&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.val)(l.searchInput,u),x()},AudioPage.prototype._deinitKeyEvents=function(){this._audioHQKeyEventHandler1&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window.document,"keydown",this._audioHQKeyEventHandler1),this._audioHQKeyEventHandler2&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window.document,"keyup",this._audioHQKeyEventHandler2),this._audioHQKeyEventHandler3&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window.document,"visibilitychange",this._audioHQKeyEventHandler3),this._audioHQKeyEventHandler4&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window.document,"mousedown",this._audioHQKeyEventHandler4),this._audioSeekKeyEventHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window.document,"keydown",this._audioSeekKeyEventHandler)},AudioPage.prototype._initKeyEvents=function(){this._deinitKeyEvents();var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),e=()=>!this.isLayer()&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.getLayer().isShown();(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(window.document,"mousedown",this._audioHQKeyEventHandler4=function(_){_.ctrlKey&&(cur.ctrlMouseDown=!0,cur.ctrlPressed=!1)},!0),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(window.document,"keydown",this._audioHQKeyEventHandler1=function(_){e()||(cur.ctrlPressed=_.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.KEY.CTRL)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(window.document,"keyup",this._audioHQKeyEventHandler2=function(_){e()||(_.keyCode!==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.KEY.CTRL||cur.ctrlMouseDown)&&(delete cur.ctrlMouseDown,delete cur.ctrlPressed)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(window.document,"keydown",this._audioSeekKeyEventHandler=function(t){var i=t.target,o=i&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.inArray)(i.tagName.toLowerCase(),["input","textarea"])&&""!==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.val)(i),s=i&&i.isContentEditable,a=cur&&cur.pvShown;o||s||a||e()||!_.isPlaying()||!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.inArray)(t.keyCode,[_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.KEY.RIGHT,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.KEY.LEFT])||cur.wallLayer||t.ctrlKey||_.seekCurrentAudio(t.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.KEY.RIGHT)}),cur.destroy.push((()=>this._deinitKeyEvents()))},AudioPage.prototype.editFeed=function(){var _=this;(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showTabbedBox)("al_settings.php",{act:"a_edit_owners_list",list:"audio",height:lastWindowHeight},{stat:[window.jsc("web/privacy.js"),"privacy.css","ui_controls.js","ui_controls.css",window.jsc("web/indexer.js")]}),cur.onOListSave=function(e,t,i,o){var s=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_9__.curBox)(),a={act:"a_ignore_olist",hash:o.hash};return e.length<t.length?a.White=e.join(","):a.Black=t.join(","),ajax.post("al_audio.php",a,{onDone:function(){s.hide(),_.getCurrentPlaylist().clean(),_.refreshCurrentPage()},onFail:()=>!0,showProgress:s.showProgress,hiderogress:s.hideProgress}),!1}},AudioPage.prototype.updateStatusExportControls=function(_){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),t=e.getStatusExportInfo();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass)("_audio_export_status",this._els.pageContainer),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(this,"on",t&&!!t[(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(this,"oid")])}));var i=e.hasStatusExport(),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_player_status",this._els.pageContainer);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(o,"audio_page_player_btn_enabled",i),!_)if(this.isLayer())cur.audioPage&&cur.audioPage.updateStatusExportControls(!0);else{var s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.getLayer().getPageInstance();s&&s.updateStatusExportControls(!0)}return!1},AudioPage.prototype.updateStatusExport=function(_,e){_&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.checkbox)(_),e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(e);var t,i,o=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),s=o.getStatusExportInfo()||{};if(e)s[e]?(delete s[e],t=!1):(s[e]=1,t=!0);else if(o.hasStatusExport()){for(var a in s)s.hasOwnProperty(a)&&delete s[a];t=!1}else s[e=vk.id]=1,t=!0;o.setStatusExportInfo(s),e!=vk.id&&e||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.checkbox)("currinfo_audio",o.hasStatusExport()),this.updateStatusExportControls();var l=o.getCurrentAudio();l&&(i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(l).fullId);var n=null;o.stats.sendCurrentAudioEvent({type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_13__.TYPE_BROADCASTING,subtype:t?_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_13__.SUBTYPE_ON:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_13__.SUBTYPE_OFF,targetOwnerId:e}),ajax.post("al_audio.php?act=toggle_status",{exp:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(t),oid:e,hash:vk.statusExportHash,id:i,top:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(n)},{onFail:()=>!0})},AudioPage.prototype.playStatusAudio=function(_,e,t){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.gpeByClass)("_audio_friend",t);(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().playLive(_,{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.showProgress.pbind(i),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_26__.hideProgress.pbind(i)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(e)},AudioPage.showActionTooltip=function(_,e){var t=[3,-8,0],i=currentAudioPage(_),o=i&&i.isLayer();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hasClass)(_,"_audio_page_player_add")?(0,_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_28__.audioShowActionTooltip)(_,t,o):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hasClass)(_,"_audio_page_player_play_rate")&&(t[0]=-17),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_29__.showTooltip)(_,{text:e,black:1,shift:t,appendParentCls:"_audio_page_player",forcetodown:o,needLeft:o}))},AudioPage.prototype.onHide=function(){var _=this;cur.nav=cur.nav.filter((function(e){return _._nav_func!=e})),this._deinitKeyEvents()},AudioPage.prototype.showRecoms=function(_,e){if(!e){var t=this._readyAudio?this._readyAudio:(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio();if(!t)return;e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(t).fullId}(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_7__.statlogsValueEvent)("audio_recoms_by_track_button_click",!0),nav.go({0:"audio",section:"recoms_audio",audio_id:e},null,{nocur:!0})},AudioPage.prototype.onAudioUploaded=function(_,e){if(e){var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),i=t.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.DEFAULT_PLAYLIST_ID);i.pushAudio(e);var o=t.getCurrentPlaylist();o&&o.getSelf()==i&&o.pushAudio(e),"all"!==this._currentSection&&this.resetSection("all");var s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(e);(0,_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_14__.onAdditionalEvent)(null,s,{type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_13__.TYPE_ADDED,subtype:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_13__.SUBTYPE_UPLOAD,context:"on_audio_uploaded",playlistId:i.getOwnerId()+"_"+i.getPlaylistId()});var a=5,l=this;!function _(t){--a<0||setTimeout((function(){ajax.post("al_audio.php?act=check_audio_data",{audio_owner_id:s.ownerId,audio_id:s.id},{onDone:function(i){if(i){var o=i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_TITLE];(o=(o=o||i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER])||i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS]!=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS])&&((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().updateAudio(s.fullId,i),"all"===l._currentSection&&"audio"===cur.module&&l._initAudioRowsAutoList(),s=i),_(1.5*t)}},onFail:()=>!0})}),t)}(1e3)}},AudioPage.prototype.onAudioAllUploaded=function(){"all"===this._currentSection&&nav.reload()},AudioPage.prototype.uploadAudio=function(_){this._data.uploadBanned?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_error")},this._data.uploadBannedText):(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showBox)("al_audio.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.extend)(_||{},{act:"new_audio",gid:_shared_ranges__WEBPACK_IMPORTED_MODULE_45__.Ranges.isGroupId(this.getOwnerId())?-this.getOwnerId():0}),{params:{width:"450px",bodyStyle:"padding: 0px; position: relative;"}})},AudioPage.prototype.editAudio=function(_,e,t){return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_22__.showBox)("al_audio.php",{act:"edit_audio_box",aid:e},{params:{width:"456px",bodyStyle:"padding: 20px; background-color: #F7F7F7;",hideButtons:1}}),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.cancelEvent)(t),!1},AudioPage.prototype.restoreRecommendation=function(_){var e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.getAudioFromEl(_,!0),t={act:"restore_recommendation",hash:(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_39__.getAudioExtra)(e).recom.hash,audio_id:e.fullId};nav.objLoc.audio_id&&(t.recommendation_type="query"),nav.objLoc.album_id&&(t.recommendation_type="album"),ajax.post("al_audio.php",t,{onFail:()=>!0}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(_,"audio_row__deleted");var i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.getAddRestoreInfo(),o=i[e.fullId].removedCurrentPos,s=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentPlaylist(),a=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylistQueue();o>=0&&s&&s.getType()==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_RECOM&&a.addAudio(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.getAudioFromEl(_),o),delete i[e.fullId],_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.onRowOver(_,!1,!0)},AudioPage.isInRecentPlayed=function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.gpeByClass)("_audio_playlist",_);return!(!e||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hasClass)(e,"audio_recent_rows"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)(e,"playlist")},AudioPage.prototype.chooseFromMyAudios=function(_){var e=!1;AudioPage.editPlaylist(vk.id,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",{audioPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_add"),playlistPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_add"),onClose:()=>{e&&nav.reload()},onAudioChoose:(t,i,o)=>{var s=t.ctrlKey||t.metaKey;if(ajax.post("al_audio.php?act=add",{group_id:_,audio_owner_id:o.ownerId,audio_id:o.id,hash:o.addHash},{onDone:_=>{_&&(e=!0)},onFail:()=>!0}),s)i.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_choose_added"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)(i,"ape_added");else{e=!0;var a=window.__bq;if(a)for(;a.count();)a.hideLast()}}})},AudioPage.prototype.updateShuffleButton=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylistQueue().shuffled;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_player_shuffle",this._els.pageContainer),"audio_page_player_btn_enabled",_),this.isLayer()&&cur.audioPage&&cur.audioPage.updateShuffleButton()},AudioPage.prototype.loadMarketItemsCarousel=function(){try{Boolean(document.querySelector(".EcommAudioMarketItemsCarousel__root"))&&(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_37__.asyncImportLoader)((()=>Promise.all([__webpack_require__.e(24509),__webpack_require__.e(34932)]).then(__webpack_require__.bind(__webpack_require__,671241))),3)}catch(_){}},AudioPage.prototype.updatePlayerClass=function(_){var e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isPodcast(_),t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isRadio(_),i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isArticleTts(_),o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isMarusiaTale(_);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(this._els.player,"audio_player_podcast",e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(this._els.player,"audio_player_radio_station",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(this._els.player,"audio_player_article_tts",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(this._els.player,"audio_player_external_stream_audio",t||i||o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(this._els.player,"audio_player_marusia_tale",o),this._updatePlaybackRate(),!this.isPodcastPage()){this.isLayer()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_tab__current",this._els.pageContainer),"unshown",e||!(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentPlaylist());var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_tab__podcast",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggle)(s,e),s&&e&&(_=_||(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.attr)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("ui_tab",s),"href","podcasts"+_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]))}},AudioPage.prototype.updateRadioFollowBtn=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio(),e=this._els.player.querySelector(".audio_page_player_follow_radiostation");e&&(e.classList.toggle(AudioPage.followedRadioClassName,(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_39__.getAudioExtra)(_).fave),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggle)(e,(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_38__.isRadio)(_)))},AudioPage.prototype.updateFaveButton=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentFaveStatus(),e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_fave",this._els.player);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(e,"activated",_)},AudioPage.prototype.toggleRepeat=function(){if(!this.isPodcastPage()){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)();_.isRepeatAll()||_.isRepeatCurrentAudio()?_.toggleRepeatCurrentAudio():_.toggleRepeatAll(),this.updateRepeatButton()}},AudioPage.prototype.updateRepeatButton=function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass)("_audio_page_player_repeat");if(_&&_.length){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),t=e.isRepeatAll(),i=e.isRepeatCurrentAudio();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.each)(_,((_,e)=>{e.ariaLabel=e.ariaLabel&&AudioPage.getRepeatButtonText(),e.onmouseover=e.onmouseover&&AudioPage.showActionTooltip.bind(void 0,e,AudioPage.getRepeatButtonText),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(e,"audio_page_player_btn_enabled",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(e,"audio_page_player_btn_repeat_one",i)}))}},AudioPage.getRepeatButtonText=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),e=_.isRepeatAll(),t=_.isRepeatCurrentAudio(),i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_repeat_tooltip");return e?i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_repeat_track_tooltip"):t&&(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("audio_dont_repeat_tooltip")),i},AudioPage.prototype.toggleShuffle=function(_){if(!this.isPodcastPage()){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(_,"audio_page_player_btn_enabled")&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_7__.statlogsValueEvent)("audio_sort_stat","audio_sort","shuffle_player",this.isLayer()?"layer":"page");var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylistQueue();if(!e.isEmpty()){var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio(),i=()=>{e.shuffled?e.resetShuffle():e.shuffle(!0),"current"===this._currentSection&&this._initAudioRowsAutoList(!0),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().play(t),this.updateShuffleButton()};t?i():e.getAudioAt(0).then((_=>{t=_,i()}))}}},AudioPage.prototype.toggleFave=function(_){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isPodcast(e)&&AudioPlayer.podcastToggleFave(_,e)},AudioPage.prototype.changePlaybackRate=function(_,e){var t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isPodcast(t)||_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isArticleTts(t))&&((0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().podcastChangePlaybackRate(!!e.shiftKey),this._updatePlaybackRate())},AudioPage.prototype._updatePlaybackRate=function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_play_rate",this._els.player);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_icon",_),AudioPlayer.podcastGetPlaybackRate()+"x")},AudioPage.prototype._getCurrentSearchParams=function(){var _=window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(this.isLayer())],e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(this._searchSortFilter.selectedItems()[0][0]);return{performer:_&&_.val?1:null,lyrics:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_fltr_with_lyrics",this._container),"on")?1:null,sort:e?1:null}},AudioPage.searchAudios=function(_,e,t,i,o){currentAudioPage(this).searchAudios(_,e,t,i,o)},AudioPage.prototype.searchAudios=function(_,e,t,i,o){this.lastQuery!==_&&(this.lastQuery=_,this._muteSearch?delete this._muteSearch:(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.trim)(_),nav.change((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.extend)(this._getCurrentSearchParams(),{q:_||null}),!1,{fromSearch:!0,globalQuery:_,fromHistory:t,isLayer:this.isLayer(),fetchedQuery:i,fromSuggestsAcceptId:o})))},AudioPage.prototype.onUserAction=function(_,e){var t=e.indexOfAudio(_);if(-1!=+t&&e.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_SEARCH&&(!(e.getOwnerId()===vk.id&&t>=0&&t<e.getLocalFoundCount())&&e.getSearchParams())){var i=e.getSearchParams();i.globalQuery&&uiSearch.saveHistorySearch(this.searchInputEl,i.globalQuery,_.ownerId,_.id,e.getTotalCount(),e.getTotalCountHash())}},AudioPage.prototype._updateFriendsList=function(_,e,t){if(_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.trim)(_),this._friendSearchInProgress=!1,_){var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_friends_list",this._els.pageContainer),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.se)('<div class="audio_friends_list _audio_friends_list" style="">'+_+"</div>");t&&(this._shownFriends=[]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domPN)(i).appendChild(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.re)(i)}},AudioPage.prototype.shareAudio=function(){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;_&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.shareAudio(!1,_)},AudioPage.prototype.showStatusTooltip=function(_){this.statusTT||(this.statusTT=!0,ajax.post("al_audio.php?act=status_tt",{},{onDone:(e,t)=>{this.statusTT=new ElementTooltip(_,{content:t,width:250,offset:[1,14],elClassWhenShown:"audio_status_tt_shown",id:"audio_status_tt",onFirstTimeShow:function(_){this.sb=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_18__.default((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_status_wrap",_),{global:!0})},onShow:function(){setTimeout(function(){this.statusTT.sb.update()}.bind(this),0)}.bind(this)}),cur._onStatusExportBtn&&(this.statusTT.show(),this.statusTT.sb.update())},onFail:()=>!0}))},AudioPage.prototype.isLayer=function(){return this._data.isLayer},AudioPage.prototype.isPodcastPage=function(){return!this.isLayer()&&!!this._data.podcastPage},AudioPage.prototype.destroy=function(){this._trackSlider&&this._trackSlider.destroy(),this._volumeSlider&&this._volumeSlider.destroy(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window,"scroll",this._ev_onScroll)},AudioPage.prototype.getPageCurrentPlaylist=function(){return this._pagePlaylist},AudioPage.prototype.clearCurrentPlaylist=function(){if(this.isLayer()){var _=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)();_.deleteCurrentPlaylist(),this.updateCurrentPlayingInfo();var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)().getPlaylistQueue();if(e.clean(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("autoplay_web")){var t=e.autoplayQueue;t&&(t.clean(),this._destroyAutoplayBlock())}var i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_tab__current",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)(i,"unshown"),"current"===this.getCurrentSection()&&(uiTabs.goTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_section_tab__all",this._els.pageContainer)),null,!0),this.updateShuffleButton(),this.updateCurrentPlayingInfo(),this.updatePlayerClass(null)),this._initPlayer(!0);var o=_.getPlaylistsByType(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_MY).find((_=>_.getAudiosList().length)),s=o&&o.getAudiosList()[0];if(s&&(this._readyAudio=s,this._initPlayer(!0)),cur.audioPage){cur.audioPage._readyAudio=s,cur.audioPage._initPlayer(!0);try{var a=cur.audioPage._data.sectionData[cur.audioPage._currentSection].title;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setDocumentTitle)(a)}catch(_){}}this.updateStatusExport(),this.updateLayerHeight(),this._scroll.scrollTop()}},AudioPage.prototype.setTooltipTitle=function(_){if(!_.titleSet){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_title_performer",_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_title_song",_);(e.scrollWidth>e.clientWidth||t.scrollWidth>t.clientWidth)&&_.setAttribute("title",_.innerText),_.titleSet=!0}},AudioPage.prototype._initPlayer=function(_){var e=this,t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),i=this._els.pageContainer,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_player",i),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_title",o),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_title_performer",o),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_title_song",o),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_title_song_title",o),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_title_song_subtitle",o),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_duration",o),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_player__cover",o),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_player_play",o),h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_play_blind_label",c),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_btn_lyrics",o),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("_audio_page_player_add",o),P=o.querySelector(".audio_page_player_follow_radiostation"),b=void 0;function g(_){if(a)if(t.ads.isPlaying())(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("audio_ad_choices")?(n.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_audio_ad"),a.innerHTML="",a.appendChild(makeAudioAdMoreLink())):(a.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_audio_ad"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(l,"display","none")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(o,"audio_song_is_explicit",!1);else{_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_44__.AudioAdActionsModalController.ensure().close();var i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.getAudioPerformers(_);_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(l,"display","block"),a.innerHTML=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player2")?i:_.performer,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isPodcast(_)?n.innerHTML=`<a href="/podcast${_.fullId}" onclick="return showPodcast(this, '${_.fullId}', event, 'player');" class="audio_player_podcast_title">${_.title}</a>`:n.innerHTML=_.hasTrackPage?`<a class="audio_page_player_title_link" href="/audio${_.trackPageId}">${_.title}</a>`:_.title,r.innerHTML=_.subTitle?_.subTitle:"";var s=null;_.coverUrl_p?s=_.coverUrl_p:(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_38__.isRadio)(_)&&(s=_.coverUrl_s),s?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(u,"background-image","url("+s+")"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(u,"background-size","cover")):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(u,"background-image",null),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(u,"background-size","")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(o,"audio_title_long_performer",_.isLongPerformer),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(o,"audio_song_is_explicit",_.isExplicit);var d=(0,_shared_audioplayer_AudioPlayerAdapter_audioTuple_audioTupleToAudioObject__WEBPACK_IMPORTED_MODULE_42__.audioTupleToAudioObject)(t.getCurrentAudio());if(!e.isLayer()&&t.getCurrentAudio()&&d.fullId===_.fullId){var c=[_.performer,_.title].filter((_=>!!_)).join(" — ");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setDocumentTitle)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.replaceEntities)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_17__.stripHTML)(c))),clearTimeout(window.pageSetTitleTimer)}l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(l,"display","none"),a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(a,"display","none"),requestAnimationFrame((()=>{var _=t.ads.isPlaying()?"none":"block";l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(l,"display",_),a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(a,"display","block")}))}}function O(_,e){return(0,_shared_audio_formatters_formatAudioTime__WEBPACK_IMPORTED_MODULE_54__.formatAudioTime)({duration:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.intval)(e),progress:_,negative:AudioPlayer.getDurationType()})}function D(){if(e._trackSlider){var _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(t.getCurrentAudio()||e._readyAudio);if(_){var i;E&&(E.disabled=!_.hasLyrics),i=_shared_ranges__WEBPACK_IMPORTED_MODULE_45__.Ranges.isGroupId(e.getOwnerId())&&e.canAddToGroup()?_.ownerId!=e.getOwnerId():_.ownerId!=vk.id,b!==i&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggle)(p,i),b=i);var o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.getAddRestoreInfo();_&&o[_.fullId]&&"added"===o[_.fullId].state||_.ownerId===vk.id?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)(p,"audio_player_btn_added"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(p,"audio_player_btn_added"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)(p,"no_transition"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClassDelayed)(p,"no_transition"),e.updateRepeatButton()}}}if(!this._trackSlider){var M,m,C=(null==(M=t.ads)?void 0:M.isPlaying())?t.ads.getCurrentProgress():t.getCurrentProgress(),A=(null==(m=t.ads)?void 0:m.isPlaying())?0:t.getCurrentBuffered(),w=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_track_slider",o),y=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_page_player_volume_slider",o);w&&(this._trackSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_19__.default(w,{value:C,backValue:A,size:1,hintClass:"audio_player_hint",withBackLine:!0,formatHint:_=>{var e=t.getCurrentAudio()||this._readyAudio;return e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(e),(0,_shared_lib_date__WEBPACK_IMPORTED_MODULE_55__.formatTime)(Math.round(_*(e?e.duration:0)))},onEndDragging:_=>{var e=t.getCurrentAudio()||this._readyAudio;(e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(e))&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isPodcast(e)&&t.podcastSetActionRef(e,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.PodcastsLogs.ACTION_SEEK,"",o),t.seek(_)}}),t.ads.isPlaying()&&(this._trackSlider.toggleAdState(!0),this.playerToggleAdsPlaying(!0))),y&&(this._volumeSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_19__.default(y,{value:t.getVolume(),size:1,hintClass:"audio_player_hint",log:!0,formatHint:_=>Math.round(100*_)+"%",onChange:_=>{t.setVolume(_)}})),[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.MUSIC_AUDIOS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.MUSIC_PLAYLISTS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.MUSIC_OWNERS_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.MUSIC_OWNERS_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.CURATOR_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.CURATOR_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.PLACEHOLDER_REMOVE].forEach((_=>t.on(this,_,((e,t)=>{this.catalogController&&this.catalogController.emitEvent(_,t)})))),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.MUSIC_PLAYLISTS_ADD,((_,e)=>{var t=this._data,i=t.playlists,o=t.playlistsIndex;Array.isArray(i)&&i.find((_=>_.id===e.id&&_.owner_id===e.owner_id))||(i&&(i.unshift(e),o&&o.add(e)),this.updatePlaylistsCounter(vk.id))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.AD_STARTED,((_,e)=>{this.playerToggleAdsPlaying(!0),this._trackSlider&&(this._trackSlider.toggleAdState(!0),this._trackSlider.setBackValue(0))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.AD_COMPLETED,(()=>{this.playerToggleAdsPlaying(!1),this._trackSlider&&this._trackSlider.toggleAdState(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.START_LOADING,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!0)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.CAN_PLAY,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.RADIOSTATION_FOLLOW,((_,e)=>{var t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(_);(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_38__.isRadio)(t)&&t.id===e&&P.classList.add(AudioPage.followedRadioClassName);var i=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${e}']`);Array.from(i).forEach((_=>{_.classList.add("AudioRadiostationItem--followed")}))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.RADIOSTATION_UNFOLLOW,((_,e)=>{var t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(_);(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_38__.isRadio)(t)&&t.id===e&&P.classList.remove(AudioPage.followedRadioClassName);var i=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${e}']`);Array.from(i).forEach((_=>{_.classList.remove("AudioRadiostationItem--followed")}))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.ADDED,((_,e)=>{(_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(_))&&_.fullId==e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)(p,"audio_player_btn_added")})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.REMOVED,((_,e)=>{(_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(_))&&_.fullId==e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(p,"audio_player_btn_added")})),t.on(this,[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.PLAY,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.PLAY_REQUESTED],((_,e,i)=>{delete this._readyAudio,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)(o,"audio",_),D(),_&&g(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)(c,"audio_playing"),e&&!cur.audioStartReadyAudio&&(this._trackSlider&&this._trackSlider.setBackValue(0),!t.ads.isPlaying()&&d&&(d.innerHTML=O(0,_?_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(_).duration:0)),s&&(s.setAttribute("title",""),s.titleSet=!1)),h&&(h.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_audio_play")),this.updateCurrentPlayingInfo(),this.updateShuffleButton(),this.updateFaveButton(),this.updateRadioFollowBtn()})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.PAUSE,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(c,"audio_playing"),h&&(h.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_audio_play"))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.STOP,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(c,"audio_playing"),h&&(h.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_27__.getLang("global_audio_play"))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.BUFFERED,((_,e)=>{this._trackSlider&&this._trackSlider.setBackValue(e)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.VOLUME,((_,e)=>{this._volumeSlider&&this._volumeSlider.setValue(e,!0)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.ENDED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.UPDATE,((_,e)=>{_&&(_&&g(_),this.updatePlayerClass(_),this.updateRadioFollowBtn()),t.ads.isPlaying()||_&&e&&d&&(d.innerHTML=O(e,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(_).duration))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.PROGRESS,((_,e,t)=>{this._trackSlider&&(this._trackSlider.toggleLoading(!1),this._trackSlider.setValue(e)),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_32__.isUndefined)(t)||isNaN(t)||!d||(d.innerHTML=O(e,t))})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.FAILED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),t.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_12__.events.CURRENT_CHANGED,(()=>{var _=t.getCurrentAudio()||this._readyAudio;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(this._els.player,"audio",JSON.stringify(_)),g(_),this.updatePlayerClass(_),this._trackSlider&&this._trackSlider.setValue(0)}))}var v=t.getCurrentAudio()||this._readyAudio;v&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.domData)(o,"audio",JSON.stringify(v)),g(v),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.toggleClass)(c,"audio_playing",t.isPlaying()),d&&(d.innerHTML=O(1,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(v).duration)),_&&this._trackSlider&&(this._trackSlider.setValue(0),this._trackSlider.setBackValue(0),this._trackSlider.toggleLoading(!1))),D();var T=t.getCurrentAudio()||this._readyAudio;this.updatePlayerClass(T),this.isLayer()||this._initFixedPlayer()},AudioPage.prototype.followRadioFromPlayer=function(_){var e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.getAudioFromEl(_,!0);if((0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_38__.isRadio)(e)){var t=e.id,i=(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_39__.getAudioExtra)(e).faveHash;_.classList.contains(AudioPage.followedRadioClassName)?(0,_player_radiostation_unfollowRadiostation__WEBPACK_IMPORTED_MODULE_40__.unfollowRadiostation)(t,i):(0,_player_radiostation_followRadiostation__WEBPACK_IMPORTED_MODULE_41__.followRadiostation)(t,i)}},AudioPage.prototype._initFixedPlayer=function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getSize)(this._els.playerWrap);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(this._els.playerWrap,{width:_[0],height:_[1]});var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getSize)(this._els.player);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.setStyle)(this._els.player,{width:e[0],height:e[1]});var t,i,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getSize)("page_header_wrap")[1],s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getXY)(this._els.contentBlock)[1],a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getXY)(this._els.playerWrap)[1]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.getSize)(this._els.playerWrap)[1]-o,l=!1,n=()=>{var _=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_10__.scrollGetY)(),e=_>s;if(_<a&&(t||l))return clearTimeout(t),clearTimeout(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(this._els.player,"audio_page_player_fixed_shown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(this._els.player,"audio_page_player_fixed"),void(l=t=!1);e&&!l&&(clearTimeout(t),t=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)(this._els.player,"audio_page_player_fixed"),i=setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.addClass)(this._els.player,"audio_page_player_fixed_shown"))),l=!0),!e&&l&&(clearTimeout(t),t=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(this._els.player,"audio_page_player_fixed_shown"),t=setTimeout((()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.removeClass)(this._els.player,"audio_page_player_fixed"),t=!1}),250),l=!1)};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(window,"scroll",n),cur.destroy.push((()=>{n&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(window,"scroll",n)}))},AudioPage.prototype.togglePlayerPlay=function(_){var e=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)();if(e.isPlaying()){var t=e.getCurrentAudio();t&&e.podcastSetActionRef(t,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.PodcastsLogs.ACTION_PAUSE,"",_),e.pause()}else{var i=this.getPageCurrentPlaylist(),o=e.getCurrentPlaylist(),s=e.getCurrentAudio(),a=e.getPlaylistQueue(),l=s||this._readyAudio,n=()=>{if(l)if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.isClaimedAudio(l)){l=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.audioTupleToAudioObject(l);var t=(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_39__.getAudioExtra)(l).claim;(0,_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_20__.showAudioClaimWarning)(l,t)}else{var s;s=o&&-1!==a.indexOfAudio(l)?o:i&&-1!==i.indexOfAudio(l)?i:new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_16__.AudioPlaylist.TYPE_TEMP,vk.id),delete this._readyAudio,cur.audioStartReadyAudio=!0,e.podcastSetActionRef(l,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_30__.AudioUtils.PodcastsLogs.ACTION_PLAY,"",_),e.play(l,s)}};!l&&i?a.getAudioAt(0).then((_=>{l=_,n()})):n()}},AudioPage.prototype.promoAlbumSlideInit=function(){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_promo");if(!this.isLayer()&&_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_promo__items",_);if(e&&!(e.children.length<=1)){this.promoAlbumSlideAutoStart(e);var t=()=>this.promoAlbumSlideAutoStop(),i=()=>this.promoAlbumSlideAutoStart(e);(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(_,"mouseenter",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.addEvent)(_,"mouseleave",i),window.cur&&cur.destroy.push((()=>{this.promoAlbumSlideAutoStop(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(_,"mouseenter",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_11__.removeEvent)(_,"mouseleave",i)}))}}},AudioPage.prototype.promoAlbumSlideAutoStart=function(_){window.cur&&(cur._promoAlbumSlideTO=setTimeout((()=>this.promoAlbumSlide(_,1)),SLIDER_TIMEOUT))},AudioPage.prototype.promoAlbumSlideAutoStop=function(){window.cur&&clearTimeout(cur._promoAlbumSlideTO)},AudioPage.prototype.promoAlbumSlide=function(_,e){var t=vk.rtl?e>0?-1:1:e<0?-1:1,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.gpeByClass)("audio_promo",_);if(i){var o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.geByClass1)("audio_promo__items",i);if(o&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)(o,"sliding")){this.promoAlbumSlideAutoStop();var s=o.scrollLeft,a=o.offsetWidth,l=o.children,n=l.length,r=_=>vk.rtl?o.scrollWidth-_*a-a:_*a;if(l.length>1){this.promoAlbumSlideAutoStart(_);var d=!1,u=null,c=!1,h=Math.round(s/a);(h+=t)>=n||h<0?(d=l[0].cloneNode(!0),o.appendChild(d),h>=n?(c=!0,u=r(h)):h<0&&(o.scrollLeft=r(n),u=r(h=n-1))):u=r(h),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)(o,"sliding",!0),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_6__.animate)(o,{scrollLeft:u},{duration:500,transition:_web_lib_fx__WEBPACK_IMPORTED_MODULE_6__.Fx.Transitions.swiftOut,onComplete:()=>{c&&(o.scrollLeft=r(0)),d&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.re)(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_21__.data)(o,"sliding",!1)}})}}}},AudioPage.prototype.handleAudioAdMoreClick=function(_){console.log(_,_.currentTarget)},AudioPage.prototype.playerToggleAdsPlaying=function(_){var e=this._els.player.classList;isAdPlayingWithChoices()&&e.toggle("audio_page_player_with_ad_choices",_),e.toggle("audio_page_player_ads_playing",_)};try{(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_1__.tq)().setInteractiveHandler("Audio/Player/LyricsButton/Click",(_=>{if(!_.payload.target.disabled){var e=currentAudioPage(_.payload.target),t=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayer)(),i=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_5__.getAudioPlayerUI)(),o=t.getCurrentAudio()||e._readyAudio;o&&i.lyrics.open({audio:o,playlist:null,context:o.context})}}))}catch(_){console.error(_)}},622858:(_,e,t)=>{"use strict";t.d(e,{default:()=>r});var i=t(927766),o=t(67328),s=t(873589),a=t(342269),l=t(152278);function n(_,e,t){if((0,a.isObject)(e)?t=e:this._dragElClass=e,this.options=(0,a.extend)({dragThreshold:n.DRAG_THRESHOLD_DIST},t),this._contEl=(0,s.ge)(_),this._contEl){this._excludedCount=0;for(var i=0;i<this._contEl.children.length;i++)this._contEl.children[i].getAttribute("nodrag")&&this._excludedCount++;(0,l.addEvent)(this._contEl,"mousedown",this._ev_mousedown_handler=this._onMouseDown.bind(this)),(0,s.setStyle)(this._contEl,"position","relative"),this._inited=!0,this._updateScrollbar=this._initUpdaterScrollbar()}}n.AUTO_SCROLL_DY=10,n.DRAG_THRESHOLD_DIST=0,n.AUTO_SCROLL_DISTANCE_THRESHOLD=300,n.AUTO_SCROLL_GAP=300,n.prototype.destroy=function(){this._inited&&(this._inited=!1,this._deinitEvents(!0))},n.prototype._getParentDragItemEl=function(_){for(var e,t=_;t&&(e=(0,s.domPN)(t))!==this._contEl;)t=e;return t===this._curPlaceholderEl&&(t=null),t},n.prototype._onKey=function(_){_.keyCode===l.KEY.ESC&&this.isCurrentlyDragging()&&this._onMouseUp()},n.prototype._onMouseDown=function(_){if(!(this._disabled||0!=_.button||this._curDragEl||(0,s.attr)(_.target,"nodrag")||this._dragElClass&&!(0,s.domClosest)(this._dragElClass,_.target))){for(var e=_.target;e&&e!==window.document;){if((0,a.intval)((0,s.domData)(e,"nodrag")))return;e=(0,s.domPN)(e)}var t=this._getParentDragItemEl(_.target);if(t&&!(0,s.attr)(t,"nodrag")&&((0,s.re)((0,s.geByClass1)("ui_gridsorter_placeholder"),this._contEl),this._contInfo=this._contInfo||{prevSize:(0,s.getSize)(this._contEl)},this._ensureGridIsActual(),!(this._grid.length<=1))){var i=window.getComputedStyle(t),o=(0,s.getXY)(t);this._initial={candidateEl:t,x:_.clientX,y:_.clientY,itemMargin:{x:parseInt(i.marginLeft),y:parseInt(i.marginTop)},shift:{x:_.pageX-o[0],y:_.pageY-o[1]}},(0,l.addEvent)(document,"mousemove",this._ev_mousemove_handler=this._onMouseMove.bind(this)),(0,l.addEvent)(document,"mouseup",this._ev_mouseup_handler=this._onMouseUp.bind(this)),(0,l.addEvent)(document,"keydown",this._ev_keydown_handler=this._onKey.bind(this)),cur.cancelClick=!1,(0,l.cancelEvent)(_)}}},n.prototype._dist=function(_){return Math.abs(_.clientX-this._initial.x)+Math.abs(_.clientY-this._initial.y)},n.prototype._onMouseUp=function(_){var e=this._curDragEl,t=!_;if(this._curDragEl){this._curDragEl=null,(0,s.removeClass)(e,"ui_gridsorter_moveable_notrans"),this._curOverCell||(this._curOverCell={el:this._curPlaceholderEl,pos:(0,s.getXY)(this._curPlaceholderEl),size:(0,s.getSize)(this._curPlaceholderEl)});var i=this._curOverCell.pos,o=this._curOverCell.el,a=this._grid[this._curDragCellIndex],n=a&&a.size;(0,s.gpeByClass)("_ape_item_list",e)&&(i[0]+=20,i[1]+=20),n&&this._isShiftToLeft&&(i[1]-=n[1]-this._curOverCell.size[1]),setTimeout((()=>{if(t){for(var _=0,o=this._grid.length;_<o;_++){var s=this._grid[_];s.dirty&&this._setPos(s.el,{left:0,top:0})}this._setPos(e,this._initialCurDragPos)}else this._setPos(e,{left:i[0],top:i[1]})})),setTimeout((()=>{if((0,s.re)(this._curPlaceholderEl),(0,s.removeClass)(this._contEl,"ui_gridsorter_cont"),this.options.dragCls&&(0,s.removeClass)(e,this.options.dragCls),this._inited){var _;if(t){for(var i=this._grid.length,a=0;a<i;a++){var l=this._grid[a];l.dirty&&this._setPos(l.el,{left:null,top:null})}this._setPos(e,{left:null,top:null,width:null,height:null})}else{var n;_=this._isShiftToLeft?(0,s.domNS)(o):o,this._contEl.insertBefore(e,_);var r=-1,d=this._initial.hasInlineSize;this._setPos(e,{left:null,top:null}),d||(0,s.setStyle)(e,{width:null,height:null});for(var u=this._grid.length,c=0;c<u;c++){var h=this._grid[c];(h.dirty||h.el===e)&&(this._setPos(h.el,{left:null,top:null}),d||(0,s.setStyle)(h.el,{width:null,height:null}),h.pos=this._calcElementPos(h.el),h.dirty=!1),h.el===e?n=c:h.el===o&&(r=c)}if(r>=0){var E=this._grid.splice(n,1);this._grid.splice(r,0,E[0])}}(0,s.removeClass)(e,"ui_gridsorter_moveable"),this._curOverCell=this._curPlaceholderEl=null,t&&this.update(),this.options.onDragFinish&&this.options.onDragFinish(e),o!==e&&!t&&this.options.onReorder&&this.options.onReorder(e,_,(0,s.domPS)(e))}}),210),_&&this._dist(_)>5&&((0,l.cancelEvent)(_),cur.cancelClick=!0)}this._updateScrollbar(),this._deinitEvents(),e&&this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,e),t||e&&this._overEl&&this.options.onDragDrop&&(t=this.options.onDragDrop(this._overEl,e)),this._overEl=null},n.prototype._deinitEvents=function(_){_&&(this._onMouseUp(),(0,l.removeEvent)(this._contEl,"mousedown",this._ev_mousedown_handler)),clearTimeout(this._autoScrollTO),this._autoScrollTO=!1,this._ev_mousemove_handler&&(0,l.removeEvent)(document,"mousemove",this._ev_mousemove_handler),this._ev_mouseup_handler&&(0,l.removeEvent)(document,"mouseup",this._ev_mouseup_handler),this._ev_keydown_handler&&(0,l.removeEvent)(document,"keydown",this._ev_keydown_handler)},n.prototype._setPos=function(_,e){this.options.noPosTransform||!this._hasTranslateFeauture&&!(this._hasTranslateFeauture=window.getComputedStyle(_).getPropertyValue("transform"))?(0,s.setStyle)(_,(0,a.extend)({transform:null},e)):null===e.left||null===e.top?(0,s.setStyle)(_,{transform:null,top:null,left:null}):(0,s.setStyle)(_,{transform:"translate("+e.left+"px, "+e.top+"px)",top:null,pos:null})},n.prototype._recalc=function(){var _=this._curDragEl,e=this._curOverCell.el;if(this._initGrid(),e!==_){for(var t=0,i=!1,o=!1,s=this._grid.length,a=0;a<s;a++){var l=this._grid[a];if(l.el===_){i=!0;break}if(l.el===e){i=!1;break}}this._isShiftToLeft=i;for(var n=i?0:this._grid.length-1,r=i?this._grid.length:-1,d=i?1:-1,u=[0,0];n!==r;n+=d){var c=this._grid[n];if(2!==t)if(c.el!==_){if(c.el===e&&t++,1===t||2===t){var h=0,E=0;i?(h=o.pos[0]+u[0],E=o.pos[1]+u[1],u[0]+=c.size[0]-o.size[0],u[1]+=c.size[1]-o.size[1]):(u[0]+=o.size[0]-c.size[0],u[1]+=o.size[1]-c.size[1],h=o.pos[0]+u[0],E=o.pos[1]+u[1]),this._setPos(c.el,{left:h-c.pos[0],top:E-c.pos[1]}),c.dirty=!0}else c.dirty&&(this._setPos(c.el,{left:null,top:null}),c.dirty=!1);o=c}else t++,o=c;else c.dirty&&(this._setPos(c.el,{left:null,top:null}),c.dirty=!1),o=c}}else for(var p=this._grid.length,P=0;P<p;P++){var b=this._grid[P];b.el!==_&&b.dirty&&(b.dirty=!1,this._setPos(b.el,{left:null,top:null}))}},n.prototype.disable=function(){this._disabled=!0},n.prototype.enable=function(){this._disabled=!1,this._initGrid(!0)},n.prototype.update=function(){this._disabled||this._initGrid(!0)},n.prototype._ensureGridIsActual=function(){this._initGrid()},n.prototype._needGridUpdate=function(){if(!this._grid)return 1;this._contInfo.prevSize=this._contInfo.prevSize||(0,s.getSize)(this._contEl);var _=0,e=this._contEl.children.length-this._excludedCount-(0,a.intval)(!!this._curPlaceholderEl);if(e!==this._grid.length)_=e>this._grid.length?2:1,this._contInfo.prevSize=(0,s.getSize)(this._contEl);else{var t=(0,s.getSize)(this._contEl),i=this._contInfo.prevSize;(Math.abs(i[0]-t[0])>5||Math.abs(i[1]-t[1])>5)&&(_=1),this._contInfo.prevSize=t}return _},n.prototype._initGrid=function(_){var e=_?1:this._needGridUpdate();if(e){1===e&&(this._grid=[],this._contInfo&&(delete this._contInfo.pos,delete this._contInfo.size));var t=this._grid?this._grid[this._grid.length-1]:null;this._grid=this._grid||[];var i,o=!!t,a=this._contEl.children;if(a.length)for(var l=this._getItemMargins(),n=this._curDragEl?this._grid.length:0,r=a.length;n<r;n++){var d=a[n];t&&d===t.el?o=!1:o||d===this._curPlaceholderEl||d.getAttribute("nodrag")||((i=(0,s.getSize)(d))[0]+=l[0],i[1]+=l[1],this._grid.push({el:d,size:i,pos:this._calcElementPos(d)}))}}},n.prototype._getRelativeMousePos=function(_){var e=this._getContPos(),t=this._getContShift();return{left:_.clientX-e[0]-t[0],top:_.clientY-e[1]-t[1]}},n.prototype._updateDraggablePosition=function(_){if(this._curDragEl){var e=this._getRelativeMousePos(_),t=this._getItemShift(),i=this._getContShift(),o=this._getContSize(),a=e.top-this._initial.shift.y-t[1]+i[1];this.options.limitBottomMove&&(a=Math.min(a,o[1]+30)),(0,s.hasClass)(this._contEl,"_ape_item_list")&&(a+=this._contEl.scrollTop),this._setPos(this._curDragEl,{left:e.left-this._initial.shift.x-t[0]+i[0],top:a}),window.AudioPage&&window.AudioPage.onUpdateDraggablePosition&&window.AudioPage.onUpdateDraggablePosition()}},n.prototype._getContShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.shift){var _=window.getComputedStyle(this._contEl);this._contInfo.shift=[parseFloat(_.paddingLeft),parseFloat(_.paddingTop)]}return this._contInfo.shift},n.prototype._getContSize=function(){return this._contInfo=this._contInfo||{},this._contInfo.size=(0,s.getSize)(this._contEl),this._contInfo.size},n.prototype._getContPos=function(){return this._contInfo=this._contInfo||{},this._contInfo.pos=(0,s.getXY)(this._contEl),this._contInfo.pos[1]-=(0,i.scrollGetY)(),this._contInfo.pos},n.prototype._getItemShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemShift){var _=window.getComputedStyle((0,s.domFC)(this._contEl));this._contInfo.itemShift=[parseFloat(_.marginLeft),parseFloat(_.marginTop)]}return this._contInfo.itemShift},n.prototype._getItemMargins=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemMargins){var _=window.getComputedStyle((0,s.domFC)(this._contEl));this._contInfo.itemMargins=[parseFloat(_.marginLeft)+parseFloat(_.marginRight),parseFloat(_.marginTop)+parseFloat(_.marginBottom)]}return this._contInfo.itemMargins},n.prototype._calcElementPos=function(_){var e=this._getContShift(),t=this._getItemShift();return[_.offsetLeft-e[0]-t[0],_.offsetTop-e[1]-t[1]]},n.prototype.isCurrentlyDragging=function(){return!!this._curDragEl},n.prototype._initUpdaterScrollbar=function(){return(0,o.throttle)((_=>{var e=this.options.wrapNode||_,t=(0,s.data)(e,"sb");t&&t.update(!1,!0)}),500)},n.prototype._onMouseMove=function(_){var e=()=>this.options.wrapNode?this.options.wrapNode.scrollTop:(0,i.scrollGetY)(),t=_=>{this.options.wrapNode?this.options.wrapNode.scrollTop=_:(0,i.scrollToY)(_,0,!1,!0)};if(this._curDragEl){this._ensureGridIsActual(),!_&&(_={clientX:this._lastMousePos.x,clientY:this._lastMousePos.y}),this._lastMousePos={x:_.clientX,y:_.clientY},this._updateDraggablePosition(_);var o=this._getContSize(),a=this._getRelativeMousePos(_),n=!1;if((0,s.hasClass)(this._contEl,"_ape_item_list")&&(a.top+=this._contEl.scrollTop),a.left>0&&a.left<o[0]&&a.top>0&&a.top<o[1])for(var r=0,d=this._grid.length-1,u=50;u;){var c=r+Math.floor((d-r)/2),h=this._grid[c];if(a.left>h.pos[0]&&a.top>h.pos[1]&&a.left<h.pos[0]+h.size[0]&&a.top<h.pos[1]+h.size[1]){n=h;break}if(r===d)break;a.top<h.pos[1]||a.left<h.pos[0]&&a.top<h.pos[1]+h.size[1]?d=d===c?d-1:c:r=r===c?r+1:c,u--}else{for(var E,p,P,b=this._grid.length,g=999999,O=0;O<b;O++){var D=this._grid[O],M=(p=a.left-(D.pos[0]+D.size[0]/2))*p+(P=a.top-(D.pos[1]+D.size[1]/2))*P;g>M&&(g=M,E=D)}n=E}!n||this._curOverCell&&this._curOverCell.el===n.el||(this._curOverCell=n,this._recalc());var m,C,A,w,y=0;if(this.options.wrapNode)m=w=this.options.wrapNode,C=(0,s.getSize)(m),(A=(0,s.getXY)(m))[1]-=(0,i.scrollGetY)(),y=_.clientY;else{var v=window,T=document.documentElement,I=document.body,B=v.innerWidth||T.clientWidth||I.clientWidth,f=v.innerHeight||T.clientHeight||I.clientHeight;w=v.bodyNode,C=[B,f],A=[0,0],y=_.clientY}var L=Math.max(20,C[1]/10),R=A[1]+L-y,U=L-(A[1]+C[1]-y);if(U>0||R>0){var W=Math.min(1,R/L),K=Math.min(1,U/L);this._autoScrollTO||(this._autoScrollTO=setTimeout((()=>{this._autoScrollTO=!1;var _=e();t(_+16*(W>0?-W:K)),_!==w.scrollTop&&(this._updateScrollbar(w),this._onMouseMove())}),20))}if(this.options.onDragOverElClass){var S=_.target;(0,s.hasClass)(S,this.options.onDragOverElClass)||(S=(0,s.gpeByClass)(this.options.onDragOverElClass,S))?this._overEl!==S&&(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this.options.onDragEnter&&this.options.onDragEnter(S,this._curDragEl),this._overEl=S):(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this._overEl=null)}}else if(this._dist(_)>this.options.dragThreshold){this._curDragEl=this._initial.candidateEl;for(var k=this._grid.length,x=0;x<k;x++)if(this._grid[x].el===this._curDragEl){this._curDragCellIndex=x;break}this.options.dragCls&&(0,s.addClass)(this._curDragEl,this.options.dragCls);var H=(0,s.getSize)(this._curDragEl),F=(0,s.getXY)(this._curDragEl),N=window.getComputedStyle(this._curDragEl),q=this._getContPos();this._initial.hasInlineSize=!(!this._curDragEl.style.width&&!this._curDragEl.style.height),(0,s.setStyle)(this._curDragEl,{width:H[0],height:H[1]}),this._initialCurDragPos={left:F[0]-q[0],top:F[1]-q[1]-document.body.scrollTop},this._curPlaceholderEl=(0,s.ce)("div",{className:"ui_gridsorter_placeholder"}),(0,s.setStyle)(this._curPlaceholderEl,{width:H[0]+parseFloat(N.marginLeft)+parseFloat(N.marginRight),height:H[1]+parseFloat(N.marginTop)+parseFloat(N.marginBottom)}),this._contEl.insertBefore(this._curPlaceholderEl,this._curDragEl),(0,s.addClass)(this._curDragEl,"ui_gridsorter_moveable"),(0,s.addClass)(this._curDragEl,"ui_gridsorter_moveable_notrans"),(0,s.addClass)(this._contEl,"ui_gridsorter_cont"),this._onMouseMove(_),this._updateDraggablePosition(_),this.options.onDragStart&&this.options.onDragStart(this._curDragEl)}(0,l.cancelEvent)(_)};const r=n},743469:(_,e,t)=>{"use strict";t.d(e,{ON_BOARDING_BG_RECT_ID:()=>n,default:()=>u});var i=t(873589),o=t(152278),s=t(927766),a=t(499206),l=t(517920),n="onboarding_bg_rect",r="page_header_cont",d="onboarding";class u{constructor(_,e,t){var i;void 0===t&&(t={}),this.el=_,this.text=e,this.hideDarkness=!0,this.oldColor=!1;var o,s,a={autoShow:!1,noAutoHideOnWindowClick:null==(i=t.noAutoHideOnWindowClick)||i,content:e instanceof HTMLElement?e:`${e}`,cls:`feature_intro_tt tutorial_tip_tt ${s=null!=(o=t.class)?o:"",t.tooltipWhite?s:s+" feature_intro_blue_tt"}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:t.scrollOffset||0,align:t.align||l.ElementTooltip.ALIGN_CENTER};t.side&&(a.forceSide=t.side),t.offset&&(a.offset=t.offset),t.width&&(a.width=t.width),t.shift&&(a.centerShift=t.shift),t.border?this.border=t.border:this.border=[10,10,10,10],t.ttOnHide&&(a.onHide=t.ttOnHide),t.withCloseButton&&(a.withCloseButton=t.withCloseButton,a.onCloseButtonClick=t.onCloseButtonClick),t.align&&(a.align=t.align),this.ttParams=a,this.opts=t,this.initOnboardingBG()}initOnboardingBG(){if(!window.onboardingBG){var _=(0,i.se)('\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ');(0,i.domInsertBefore)(_,window.layerBG),window.onboardingBGHeader=(0,i.ge)("onboarding_bg_header"),window.onboardingBG=(0,i.ge)("onboarding_bg"),window.onboardingBGRect=(0,i.ge)(n),window.onboardingBGClip=(0,i.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,i.hide)(window.onboardingBG),(0,i.hide)(window.onboardingBGHeader),(0,i.removeClass)((0,i.ge)(r),d),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,o.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){var _=(0,i.getXY)(this.el)[1];this.tt=new l.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();var e=this.tt.getContent();(0,a.isElementInViewport)(this.el)&&(0,a.isElementInViewport)(e)||(0,s.scrollToY)(_-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,o.removeEvent)(window,"scroll"),(0,o.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,o.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,o.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){var _=this.el.offsetWidth,e=this.el.offsetHeight,t=(0,i.getXY)(this.el);(0,i.attr)(window.onboardingBGClip,"width",_+this.border[1]+this.border[3]),(0,i.attr)(window.onboardingBGClip,"height",e+this.border[0]+this.border[2]),(0,i.attr)(window.onboardingBGClip,"x",t[0]-this.border[1]),(0,i.attr)(window.onboardingBGClip,"y",t[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){var _=this.getPageHeight();window.onboardingBG.height!=_&&this.setDartToFullHeight()}setDartToFullHeight(){(0,i.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,i.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,i.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,i.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,i.show)(window.onboardingBG),(0,i.isVisible)(window.onboardingBGHeader)||((0,i.show)(window.onboardingBGHeader),(0,i.addClass)((0,i.ge)(r),d)))}removeDarkens(){this.hideDarkness&&((0,i.hide)(window.onboardingBG),(0,i.hide)(window.onboardingBGHeader),(0,i.removeClass)((0,i.ge)(r),d))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){var _=document.documentElement,e=document.body;return Math.max(e.scrollWidth,_.scrollWidth,e.offsetWidth,_.offsetWidth,e.clientWidth,_.clientWidth)}getPageHeight(){var _=document.documentElement,e=document.body;return Math.max(e.scrollHeight,_.scrollHeight,e.offsetHeight,_.offsetHeight,e.clientHeight,_.clientHeight)}}},499206:(_,e,t)=>{"use strict";function i(_){var e=_.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}t.d(e,{isElementInViewport:()=>i})},866914:(_,e,t)=>{"use strict";t.d(e,{default:()=>r});var i=t(873589),o=t(70162),s=t(342269),a=t(152278),l=t(368752);function n(_,e){if(this.constructor!=n)throw new Error("Slider was called without 'new' operator");if(!_)throw new Error("No element was provided for Slider");_=(0,i.ge)(_),this.options=e||{size:1},this.options.backValue=this.options.backValue||0;var t=100*this.options.backValue,o=`<div class="slider_slide"><div class="slider_loading_bar" style="opacity: 0; display: none;"></div> ${this.options.withBackLine?'<div class="slider_back" style="width:'+t+'%"></div>':""} <div class="slider_amount"></div> <div class="slider_handler"></div> </div>`;this._el=(0,i.ce)("div",{innerHTML:o,className:"slider",id:_.getAttribute("id")||""});for(var r=_.classList||[],d=this,u=0,c=r.length;u<c;u++)(0,i.addClass)(this._el,r[u]);(0,s.each)(this._el.attributes,(function(_,e){"id"==e.name&&"class"==e.name||d._el.setAttribute(e.name,e.value)})),_.parentNode.replaceChild(this._el,_),(0,i.data)(this._el,"slider",this),this._amountEl=(0,i.geByClass1)("slider_amount",this._el),this._handlerEl=(0,i.geByClass1)("slider_handler",this._el),this._slideEl=(0,i.geByClass1)("slider_slide",this._el),this._backEl=(0,i.geByClass1)("slider_back",this._el),this._progressEl=(0,i.geByClass1)("slider_loading_bar",this._el),this.options.color&&((0,i.setStyle)(this._amountEl,{backgroundColor:this.options.color}),(0,i.setStyle)(this._handlerEl,{backgroundColor:this.options.color})),this.options.handlerColor&&(0,i.setStyle)(this._handlerEl,{backgroundColor:this.options.handlerColor}),this.options.backColor&&(0,i.setStyle)(this._slideEl,{backgroundColor:this.options.backColor}),(0,i.addClass)(this._el,"slider_size_"+this.options.size),this.options.debounce&&(this._onValueChangeDebounced=(0,l.debounce)(this._onValueChange,this.options.debounce)),e.formatHint&&((0,a.addEvent)(this._el,"mousemove",this._ev_onMouseOver=this._onMouseOver.bind(this)),(0,a.addEvent)(this._el,"mouseleave",this._ev_onMouseLeave=this._onMouseLeave.bind(this))),(0,a.addEvent)(this._el,"mousedown",this._ev_onMouseDown=this._onMouseDown.bind(this)),this.setValue(this.options.value||0,!this.options.fireChangeEventOnInit,!1),this.setBackValue(this.options.backValue)}n.prototype.toggleAdState=function(_){this._adState=!!_,(0,i.toggleClass)(this._el,"slider_ad_mode",!!_)},n.prototype.toggleAdMarker=function(_){_=!!_;var e=(0,i.geByClass1)("slider_ad_marker",this._el);if(_){if(!e){var t="onmouseover=\"showTooltip(this, {text: '"+o.getLang("global_audio_ad")+"', black: 1, shift: [16, 9, 10]})\"";e=(0,i.se)('<div class="slider_ad_marker_wrap" '+t+'><div class="slider_ad_marker"></div></div>'),(0,i.domPN)(this._slideEl).insertBefore(e,this._slideEl),delete this._width,(0,i.addClass)(this._el,"slider_ad_marker_shown")}}else(0,i.re)(e),delete this._width,(0,i.removeClass)(this._el,"slider_ad_marker_shown")},n.prototype.showAdMarker=function(_){var e=(0,i.se)('<div class="slider_ad_marker"></div>');(0,i.domPN)(this._slideEl).insertBefore(e,this._slideEl),delete this._width,(0,i.addClass)(this._el,"slider_ad_marker_shown")},n.prototype.isAdMode=function(){return(0,i.hasClass)(this._el,"slider_ad_mode")},n.prototype.setBlocked=function(_){this.blocked=_,(0,i.toggleClass)(this._el,"slider_blocked",_)},n.prototype.getBlocked=function(){return this.blocked},n.prototype.isBlocked=function(){return this.isAdMode()||this.getBlocked()},n.prototype.toggleLoading=function(_){_=!!_,(0,i.toggle)(this._progressEl,_),(0,i.setStyle)(this._progressEl,"opacity",_?1:0)},n.prototype.destroy=function(_){this.options.formatHint&&((0,a.removeEvent)(this._el,"mousemove",this._ev_onMouseOver),(0,a.removeEvent)(this._el,"mouseleave",this._ev_onMouseLeave),(0,a.removeEvent)(this._el,"mousedown",this._ev_onMouseDown)),(0,i.re)(this._el),(0,i.re)(this._currHintEl)},n.prototype._updateHint=function(_,e){this._currHintEl||(this._currHintEl=(0,i.se)('<div class="slider_hint" id="slider_hint"></div>'),this.options.hintClass&&(0,i.addClass)(this._currHintEl,this.options.hintClass),this._el.appendChild(this._currHintEl)),this._width=this._width||(0,i.getSize)(this._slideEl)[0];var t=this._getPos(),o=Math.round(_.pageX-t[0]),s=this._width;if((o=e?Math.min(Math.max(0,o),s):o)>=0&&o<=s){var a=o/s;this._currHintEl.innerHTML=this.options.formatHint?this.options.formatHint.call(this,a):a;var l=(0,i.getSize)(this._currHintEl);(0,i.setStyle)(this._currHintEl,{left:this._slideEl.offsetLeft+o-l[0]/2,top:this._slideEl.offsetTop-l[1]-10}),!e&&this._toggleHint(!0)}else!e&&this._toggleHint(!1);this.options.formatHint||this._toggleHint(!1)},n.prototype._toggleHint=function(_){this.isAdMode()&&(_=!1),(0,i.toggleClass)(this._currHintEl,"visible",_)},n.prototype._onMouseOver=function(_){n._currenSliderDrag||(0,i.hasClass)(this._el,"active")||this._updateHint(_)},n.prototype._onMouseLeave=function(_){(0,i.hasClass)(this._el,"active")||this._toggleHint(!1)},n.prototype._onMouseDown=function(_){0==_.button&&(delete cur._sliderMouseUpNowEl,this._adState||this.getBlocked()||((0,a.addEvent)(window,"mousemove",this._ev_onMouseMove=this._onMouseMove.bind(this)),(0,a.addEvent)(window,"mouseup",this._ev_onMouseUp=this._onMouseUp.bind(this)),this._width=(0,i.getSize)(this._slideEl)[0],this._onMouseMove(_),n._currenSliderDrag=this,(0,i.addClass)(this._el,"active"),(0,a.cancelEvent)(_)))},n.prototype._onMouseUp=function(_){cur._sliderMouseUpNowEl=this._el,(0,a.removeEvent)(window,"mousemove",this._ev_onMouseMove),(0,a.removeEvent)(window,"mouseup",this._ev_onMouseUp),clearTimeout(this._debounceto),this._onValueChange(),(0,i.removeClass)(this._el,"active"),n._currenSliderDrag=!1,this._toggleHint(!1),this.options.onEndDragging&&this.options.onEndDragging(this._currValue)},n.prototype._onMouseMove=function(_){var e=this._getPos(),t=Math.max(_.pageX,e[0]);t=Math.min(t,e[0]+this._width),t-=e[0],this.setValue(t/this._width,!0,!0),this._onValueChangeDebounced?this._onValueChangeDebounced():this._onValueChange(),this._toggleHint(!0),this._updateHint(_,!0),(0,a.cancelEvent)(_)},n.prototype._getPos=function(){return this._slidePos=(0,i.getXY)(this._slideEl)},n.LOGFBASE=35,n.prototype._logf=function(_){if(!this.options.log)return _;var e=n.LOGFBASE;return(Math.pow(e,_)-1)/(e-1)},n.prototype._unlogf=function(_){if(!this.options.log)return _;var e,t,i=n.LOGFBASE;return e=i,t=1+_*(i-1),Math.log(t)/Math.log(e)},n.prototype.setValue=function(_,e,t){if(!(0,i.hasClass)(this._el,"active")||t){var o=t?this._logf(_):_;if(this._currValue!=o){this._currValue=o;var s=t?_:this._unlogf(_);s=100*s+"%",(0,i.setStyle)(this._amountEl,{width:s}),(0,i.setStyle)(this._handlerEl,{left:s}),!e&&this._onValueChange()}}},n.prototype.setBackValue=function(_){(0,i.toggleClass)(this._backEl,"slider_back_transition",_>this._backValue),this._backValue=_;var e=100*_+"%";(0,i.setStyle)(this._backEl,{width:e})},n.prototype._onValueChange=function(){this._lastValue=this._lastValue||0,this._lastValue!=this._currValue&&(this._lastValue=this._currValue,this.options.onChange&&this.options.onChange(this._currValue))};const r=n},792440:(_,e,t)=>{"use strict";t.r(e),t.d(e,{UiScroll:()=>d,default:()=>u});var i=t(840060),o=t(733164),s=t(342269),a=t(873589),l=t(152278),n=t(631351),r=t(643864);class d{constructor(_,e){if(!(_=(0,r.getScrollElement)(_)))throw new Error("uiScroll container is undefined");_.__uiScroll__&&_.__uiScroll__.destroy(),this.options=(0,s.extend)({global:!1,native:!1,theme:"default",reversed:!1,autoresize:!0,preserveEdgeBelow:!1,barMinHeight:30,preserveEdgeBelowThreshold:20,stopScrollPropagation:!0,stopScrollPropagationAlways:!1,minContentHeight:0,onmoreThreshold:null,hidden:!1,shadows:!1,scrollElements:[],onresize:null,onscroll:null,onscrollstart:null,onscrollstop:null,ondrag:null,ondragstart:null,ondragstop:null,onupdate:null,onmore:null,noForceReFlow:!1},e),this.options.native&&(this.options.shadows=!1),i.browser.mobile&&(this.options.stopScrollPropagation=!1),(0,o.isArray)(this.options.scrollElements)||(this.options.scrollElements=[]),this.removeEvents=[],this.removeElements=[],this.dragging=!1,this.dragged=!1,this.released=!0,this.noMore=!1,this.dragY=null,this.dragScroll=null,this.shadowTop=!1,this.shadowBottom=!1,this.unnecessary=!1,this.disabled=!1,this.stopped=!0,this.stoppedTimeout=null,this.fixSizeDefault=null,this.animation=null,this.barOuterHeight=null,this.barInnerHeight=null,this.currentFrame=null,this.blockerScrollTop=500,this.emitter=new EventEmitter,(0,s.isFunction)(this.options.onresize)&&this.emitter.addListener("resize",this.options.onresize),(0,s.isFunction)(this.options.onscroll)&&this.emitter.addListener("scroll",this.options.onscroll),(0,s.isFunction)(this.options.onscrollstart)&&this.emitter.addListener("scrollstart",this.options.onscrollstart),(0,s.isFunction)(this.options.onscrollstop)&&this.emitter.addListener("scrollstop",this.options.onscrollstop),(0,s.isFunction)(this.options.ondrag)&&this.emitter.addListener("drag",this.options.ondrag),(0,s.isFunction)(this.options.ondragstart)&&this.emitter.addListener("dragstart",this.options.ondragstart),(0,s.isFunction)(this.options.ondragstop)&&this.emitter.addListener("dragstop",this.options.ondragstop),(0,s.isFunction)(this.options.onupdate)&&this.emitter.addListener("update",this.options.onupdate),(0,s.isFunction)(this.options.onmore)&&this.emitter.addListener("more",this.options.onmore),this.el={container:_,overflow:(0,a.ce)("div",{className:"ui_scroll_overflow"}),outer:(0,a.ce)("div",{className:"ui_scroll_outer"},{margin:this.options.stopScrollPropagation?this.blockerScrollTop+"px 0":void 0}),inner:(0,a.ce)("div",{className:"ui_scroll_inner tt_noappend"}),shadowTop:(0,a.ce)("div",{className:"ui_scroll_shadow_top"}),shadowBottom:(0,a.ce)("div",{className:"ui_scroll_shadow_bottom"}),content:(0,a.ce)("div",{className:"ui_scroll_content clear_fix"}),barContainer:(0,a.ce)("div",{className:"ui_scroll_bar_container"}),barOuter:(0,a.ce)("div",{className:"ui_scroll_bar_outer"}),barInner:(0,a.ce)("div",{className:"ui_scroll_bar_inner"})},(0,a.data)(this.el.container,"ui-scroll",this);var t=(0,a.cf)(),n=["ui_scroll_container"];for((0,s.each)((0,o.isArray)(this.options.theme)?this.options.theme:(0,s.trim)(this.options.theme+"").split(/\s+/),(function(_,e){e&&n.push("ui_scroll_"+e+"_theme")})),(0,a.addClass)(this.el.container,n.join(" ")),this.options.hidden&&(0,a.addClass)(this.el.container,"ui_scroll_hidden");this.el.container.firstChild;)this.el.content.appendChild(this.el.container.firstChild);if(this.el.outer.appendChild(this.el.inner),this.el.inner.appendChild(this.el.content),this.options.stopScrollPropagation?(this.el.blocker=(0,a.ce)("div",{className:"ui_scroll_blocker"}),this.addEvent(this.el.blocker,"scroll",this.fixBlocker.bind(this),!0),this.el.blocker.appendChild(this.el.outer),this.el.overflow.appendChild(this.el.blocker)):this.el.overflow.appendChild(this.el.outer),t.appendChild(this.el.overflow),this.options.native?(0,a.addClass)(this.el.container,"ui_scroll_native"):(this.el.barOuter.appendChild(this.el.barInner),this.el.barContainer.appendChild(this.el.barOuter),t.appendChild(this.el.barContainer),this.options.shadows&&(this.el.overflow.appendChild(this.el.shadowTop),this.el.overflow.appendChild(this.el.shadowBottom)),i.browser.mobile||this.options.scrollElements.push(this.el.barContainer)),this.options.autoresize){var u=(0,r.addResizeSensor)(this.el.inner,this.resize.bind(this,!0)),c=(0,r.addResizeSensor)(this.el.overflow,this.resize.bind(this,!1));this.removeElements.push(u[0]),this.removeElements.push(c[0]),this.startResizeListening=function(){u[1](),c[1]()}}this.removeElements.push(this.el.overflow,this.el.barContainer),this.el.container.appendChild(t),this.options.reversed&&(this.el.outer.scrollTop=this.el.outer.scrollHeight),this.el.container.__uiScroll__=this.api={container:this.el.container,scroller:this.el.outer,content:this.el.content,emitter:this.emitter,ondragstart:this.dragstart.bind(this),ondragstop:this.dragstop.bind(this),ondrag:this.drag.bind(this),destroy:this.destroy.bind(this),disable:this.disable.bind(this,!0),enable:this.disable.bind(this,!1),scrollTop:this.scrollTop.bind(this,!0),scrollBottom:this.scrollBottom.bind(this,!0),scrollBy:this.scrollBy.bind(this),scrollIntoView:this.scrollIntoView.bind(this,!0),update:this.init.bind(this),updateAbove:this.updateAbove.bind(this),updateBelow:this.updateBelow.bind(this),data:{scrollTop:null,scrollBottom:null,scrollHeight:null,viewportHeight:null}},this.init();var h="onwheel"in this.el.outer?"wheel":void 0!==document.onmousewheel?"mousewheel":i.browser.mozilla?"MozMousePixelScroll":"DOMMouseScroll";return this.addEvent(this.el.container,h,function(_){this.animation&&this.animation.stop(),!this.disabled&&this.options.stopScrollPropagation&&(this.unnecessary?this.options.stopScrollPropagationAlways&&(0,l.cancelEvent)(_):this.isScrollEventUnused(_)?(0,l.cancelEvent)(_):(0,l.stopEvent)(_))}.bind(this),!this.options.stopScrollPropagation),this.options.native||this.addEvent(this.el.barContainer,"mousedown",this.dragstart.bind(this)),(0,s.each)(this.options.scrollElements,function(_,e){this.addEvent(e,h,function(_){this.disabled||this.unnecessary||(this.scrollBy(d.scrollEventDelta(_)),!this.options.stopScrollPropagation&&this.isScrollEventUnused(_)||(0,l.cancelEvent)(_))}.bind(this))}.bind(this)),this.options.reversed&&this.addEvent(this.el.container,"mousedown touchstart pointerdown",function(_){this.released=!1,this.noMore=!0;var e=this.addEvent(document,"mouseup contextmenu touchend pointerup",function(_){(0,l.removeEvent)(document,"mouseup contextmenu touchend pointerup",e),this.released=!0,this.noMore&&this.stopped&&!this.dragging&&(this.noMore=!1,this.more())}.bind(this))}.bind(this)),this.addEvent(this.el.outer,"scroll",function(){this.update()&&(this.stopped?(this.stopped=!1,this.emitEvent("scrollstart")):this.options.native||!1!==this.stopped||(this.stopped=0,(0,a.addClass)(this.el.container,"ui_scroll_scrolled")),this.emitEvent("scroll"),this.stoppedTimeout&&clearTimeout(this.stoppedTimeout),this.stoppedTimeout=setTimeout(function(){this.stopped||(this.stopped=!0,this.options.native||(0,a.removeClass)(this.el.container,"ui_scroll_scrolled"),this.emitEvent("scrollstop"),this.noMore&&this.released&&!this.dragging&&(this.noMore=!1,this.more()))}.bind(this),200))}.bind(this)),this.api}init(){if(this.options.stopScrollPropagation&&this.fixBlocker(),!this.inited){if(!this.el.container.scrollWidth||this.disabled)return;this.fixSize(!0),this.options.autoresize&&this.startResizeListening(),this.options.global||cur.destroy.push(this.destroy.bind(this)),this.inited=!0}return this.update(!0),this.api}addEvent(_,e,t,i){return this.removeEvents.push([_,e,t]),(0,l.addEvent)(_,e,t,void 0,void 0,i?{passive:!0}:void 0),t}destroy(){if(this.disabled=!0,this.fixSize(),this.animation&&this.animation.stop(),this.moreTimeout&&clearTimeout(this.moreTimeout),this.dragstopHandler&&(0,l.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,l.removeEvent)(document,"mousemove",this.dragHandler),(0,s.each)(this.removeEvents,(function(_,e){l.removeEvent.apply(null,e)})),this.el.overflow.parentNode==this.el.container){for(var _=(0,a.cf)();this.el.content.firstChild;)_.appendChild(this.el.content.firstChild);this.el.container.appendChild(_)}return(0,a.removeData)(this.el.container,"ui-scroll"),this.el.container.className=this.el.container.className.replace(/\bui_scroll_.+?\b/g," "),(0,s.each)(this.removeElements,(function(_,e){(0,a.re)(e)})),this.el.container.scrollTop=this.api.data.scrollTop,delete this.el.container.__uiScroll__,this.api}updateAbove(_){if((0,s.isFunction)(_)){this.animation&&this.animation.stop();var e=this.el.outer.scrollHeight-this.el.outer.scrollTop-this.el.overflow.offsetHeight;_(),this.el.outer.scrollTop=this.el.outer.scrollHeight-this.el.overflow.offsetHeight-e}return this.api}updateBelow(_){if((0,s.isFunction)(_)){this.animation&&this.animation.stop();var e=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;_(),e&&this.scrollBottom(!1)}return this.api}fixBlocker(){i.browser.chrome&&!this.options.noForceReFlow&&this.forceReFlow(),this.el.blocker.scrollTop=this.blockerScrollTop}forceReFlow(){this.el.blocker.style.display="inline-block",this.el.blocker.offsetHeight,this.el.blocker.style.display=""}fixSize(_){this.options.native||(_&&null==this.fixSizeDefault&&(this.fixSizeDefault=this.el.container.style.width),(0,a.setStyle)(this.el.container,"width",_?(0,a.getSize)(this.el.container,!0)[0]||this.fixSizeDefault||"":this.fixSizeDefault||""))}emitEvent(_){this.disabled||this.inited&&this.emitter.emitEvent(_,[this.api])}static scrollEventDelta(_){var e=0,t=void 0!==_.deltaMode?_.deltaMode:"MozMousePixelScroll"==_.type?0:1;return"wheel"==_.type?e=_.deltaY:void 0!==_.wheelDeltaX&&void 0!==_.wheelDeltaY?(e=1/40*-_.wheelDeltaY,i.browser.mac&&i.browser.opera&&(e*=.1)):void 0!==_.wheelDelta?e=1/40*-_.wheelDelta:_.detail&&2===_.axis&&(e=_.detail),e*(1==t?15:2==t?450:1)}isScrollEventUnused(_){return d.scrollEventDelta(_)>0?!this.api.data.scrollBottom:!this.api.data.scrollTop}resize(_){if(!_&&this.options.preserveEdgeBelow){var e=this.options.preserveEdgeBelow&&this.api.data.scrollBottom<=this.options.preserveEdgeBelowThreshold;this.update(!0)&&(this.emitEvent("resize"),e&&this.scrollBottom(),this.options.stopScrollPropagation&&!_&&this.fixBlocker())}else this.update(!0)&&(this.options.stopScrollPropagation&&!_&&this.fixBlocker(),this.emitEvent("resize"))}disable(_){return this.disabled=!!_,_?(this.animation&&this.animation.stop(),this.fixSize()):(this.fixSize(!0),this.options.stopScrollPropagation&&this.fixBlocker(),this.update(!0)),(0,a.toggleClass)(this.el.container,"ui_scroll_disabled",this.disabled),this.api}dragstart(_){if(!(this.disabled||this.dragging||this.options.native))return _||(_=window.event),this.dragging=!0,this.animation&&this.animation.stop(),this.options.reversed&&(this.noMore=!0),(0,l.addEvent)(document,"mouseup contextmenu",this.dragstartHandler=this.dragstop.bind(this)),(0,l.addEvent)(document,"mousemove",this.dragHandler=this.drag.bind(this)),this.dragScroll=this.options.reversed?this.api.data.scrollBottom:this.api.data.scrollTop,this.dragY=_.screenY,(0,l.cancelEvent)(_),this.emitEvent("dragstart"),this.api}dragstop(_){if(!this.disabled&&this.dragging&&!this.options.native){if(_||(_=window.event),this.dragging=!1,this.dragstopHandler&&(0,l.removeEvent)(document,"mouseup contextmenu",this.dragstopHandler),this.dragHandler&&(0,l.removeEvent)(document,"mousemove",this.dragHandler),(0,a.setStyle)(document.body,"cursor",""),(0,a.removeClass)(this.el.container,"ui_scroll_dragging"),this.dragged)this.noMore&&(this.noMore=!1,this.more());else{this.options.reversed&&(this.noMore=!0);var e=(_.pageY-(0,a.getXY)(this.el.barOuter)[1]-this.barInnerHeight/2)*(Math.max(this.options.minContentHeight,this.api.data.scrollHeight)-this.api.data.viewportHeight)/(this.barOuterHeight-this.barInnerHeight);this.scrollTop(!1,e,0,function(){this.noMore&&(this.noMore=!1,this.more())}.bind(this))}return this.dragged=!1,_&&"contextmenu"!==_.type&&(0,l.cancelEvent)(_),this.emitEvent("dragstop"),this.api}}drag(_){if(!this.disabled&&this.dragging&&!this.options.native){_||(_=window.event);var e=(_.screenY-this.dragY)*(this.api.data.scrollHeight/this.el.barOuter.scrollHeight);return this.el.outer.scrollTop=this.options.reversed?this.el.outer.scrollHeight-this.el.overflow.offsetHeight-this.dragScroll+e:this.dragScroll+e,this.dragged||(this.dragged=!0,(0,a.setStyle)(document.body,"cursor","pointer"),(0,a.addClass)(this.el.container,"ui_scroll_dragging")),(0,l.cancelEvent)(_),this.emitEvent("drag"),this.api}}scroll(_,e,t){return this.animation&&this.animation.stop(),this.el.outer.scrollTop==_&&this.update(!0),e?(e="number"!=typeof e||!isFinite(e)||e%1?300:Math.abs(e),this.animation=new n.Fx.Base({scrollTop:this.el.outer.scrollTop},{transition:n.Fx.Transitions.easeOutCubic,onStep:function(_){this.el.outer.scrollTop=_.scrollTop}.bind(this),duration:e,onComplete:(0,s.isFunction)(t)?t.pbind(this.api):void 0}).start({scrollTop:this.el.outer.scrollTop},{scrollTop:_})):(this.el.outer.scrollTop=_,(0,s.isFunction)(t)&&t(this.api)),this.api}scrollTop(_,e,t,i){if(_&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll((0,s.intval)(e),t,i)}scrollBottom(_,e,t,i){if(_&&this.options.stopScrollPropagation&&this.fixBlocker(),!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollHeight-this.el.overflow.offsetHeight-(0,s.intval)(e),t,i)}scrollBy(_,e,t){if(!this.disabled&&!this.dragging)return this.scroll(this.el.outer.scrollTop+(0,s.intval)(_),e,t)}scrollIntoView(_,e,t,i){if(_&&this.options.stopScrollPropagation&&this.fixBlocker(),(e=(0,r.getScrollElement)(e))&&e.compareDocumentPosition&&e.compareDocumentPosition(this.el.content)&Node.DOCUMENT_POSITION_CONTAINS){var o=(0,a.getXY)(e)[1],l=(0,a.getXY)(this.el.overflow)[1],n=(0,a.getSize)(e)[1];if(o<=l&&o+n>=l+this.api.data.viewportHeight||o>=l&&o+n<=l+this.api.data.viewportHeight)(0,s.isFunction)(i)&&(t?setTimeout(i.bind(this.api),0):i(this.api));else if(n>this.api.data.viewportHeight||o<l)this.scrollTop(!1,o-l+this.api.data.scrollTop-(this.options.shadows?(0,a.getSize)(this.el.shadowTop)[1]:0),t,i);else{var d=this.options.shadows?(0,a.getSize)(this.el.shadowBottom)[1]:0;this.scrollTop(!1,o-l+this.api.data.scrollTop+n-this.api.data.viewportHeight+d,t,i)}}return this.api}update(_){var e,t;this.el.container&&!this.el.container.updateScroll&&(this.el.container.updateScroll=this.update.bind(this,!1));var i=this.el.outer.scrollTop;if(this.inited&&!this.disabled&&(_&&(e=this.el.inner.offsetHeight,this.api.data.viewportHeight!==(this.api.data.viewportHeight=this.el.overflow.offsetHeight)||this.api.data.scrollHeight!==e)||this.api.data.scrollTop!==i)){if(_&&(this.api.data.scrollHeight=e),this.api.data.scrollTop=Math.max(0,Math.min(this.api.data.scrollHeight-this.api.data.viewportHeight,Math.max(0,i))),this.api.data.scrollBottom=Math.max(0,this.api.data.scrollHeight-this.api.data.scrollTop-this.api.data.viewportHeight),!this.options.native){if(!(t=(e=Math.max(this.options.minContentHeight,this.api.data.scrollHeight))<=this.api.data.viewportHeight)){var o=this.el.barOuter.offsetHeight;(_||this.barOuterHeight!==o)&&(this.barOuterHeight=o,this.barInnerHeight=Math.max(this.options.barMinHeight,this.barOuterHeight*this.api.data.viewportHeight/e),this.el.barInner.style.height=this.barInnerHeight+"px"),(0,r.nextFrame)((()=>{var _=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(e-this.api.data.viewportHeight);this.el.barInner.style.transform=`translateY(${_}px)`}))}this.options.shadows&&(this.shadowTop!=(this.api.data.scrollTop&&!t)&&(0,a.toggleClass)(this.el.container,"ui_scroll_shadow_top_visible",this.shadowTop=this.api.data.scrollTop&&!t),this.shadowBottom!=(this.api.data.scrollBottom&&!t)&&(0,a.toggleClass)(this.el.container,"ui_scroll_shadow_bottom_visible",this.shadowBottom=this.api.data.scrollBottom&&!t)),this.unnecessary!==t&&((0,a.toggleClass)(this.el.container,"ui_scroll_unnecessary",t),this.unnecessary=t,this.options.stopScrollPropagation&&this.fixBlocker(),t&&this.barInnerHeight&&this.barOuterHeight&&(0,r.nextFrame)(function(_){this.el.barInner.style.height=100*this.barInnerHeight/this.barOuterHeight+"%";var t=(this.barOuterHeight-this.barInnerHeight)*this.api.data.scrollTop/(e-this.api.data.viewportHeight)*100/this.barInnerHeight;this.el.barInner.style.transform=`translateY(${t}%)`}.bind(this)))}return this.emitEvent("update"),(!this.options.reversed||i>=0)&&this.more(),!0}return!1}more(){var _=this.options.reversed?this.api.data.scrollTop:this.api.data.scrollBottom,e=null!==this.options.onmoreThreshold?this.options.onmoreThreshold:2*this.api.data.viewportHeight;!this.noMore&&_<=e&&this.emitEvent("more")}}d.addResizeSensor=r.addResizeSensor;const u=d},643864:(_,e,t)=>{"use strict";t.d(e,{nextFrame:()=>r,getScrollElement:()=>d,addResizeSensor:()=>u});var i,o=t(342269),s=t(873589),a=t(840060),l=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||(_=>setTimeout(_,1)),n=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;function r(_){i&&n(i),i=l(_)}function d(_){return(0,o.isString)(_)&&"_"===_[0]?(0,s.geByClass1)(_):(0,s.ge)(_)}function u(_,e){if((_=d(_))&&(0,o.isFunction)(e)){if(a.browser.msie9||a.browser.opera&&a.browser.version<13){var t=!1,i=!1,l=(0,s.ce)("object",{type:"text/html",className:"ui_scroll_resize_object",data:"about:blank",onload:function(){i=!0,t&&p()}});function p(){if(!l.contentDocument)return setTimeout(p,100);l.contentDocument.defaultView.removeEventListener("resize",e),l.contentDocument.defaultView.addEventListener("resize",e),e()}return _.appendChild(l),_.__resizeSensor__=[l,function(){t=!0,i&&p()}]}var n=(0,s.ce)("div",{className:"ui_scroll_resize_sensor"}),r=(0,s.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_expand"}),u=(0,s.ce)("div",{className:"ui_scroll_resize_sensor ui_scroll_resize_shrink"}),c=(0,s.ce)("div"),h=(0,s.ce)("div"),E=null;return r.appendChild(c),u.appendChild(h),n.appendChild(r),n.appendChild(u),_.appendChild(n),_.__resizeSensor__=[n,r.onscroll=u.onscroll=function(){var t=(_.offsetWidth||1e4)+10,i=(_.offsetHeight||1e4)+10;c.style.width=t+"px",c.style.height=i+"px",r.scrollLeft=t,r.scrollTop=i,u.scrollLeft=t,u.scrollTop=i,E!==(E=t+" "+i)&&e()}]}}},456495:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(722122),_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(873589),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(822560),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(342269),_web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(517920),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(152278),_web_legacy_ui_ui_tabs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(636870),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(840060),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(769488),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(927766),SEARCH_FOCUSED_CLASS="search_focused",uiSearch={destroy:function(_){var e=uiSearch.getFieldEl(_);uiSearch.stopEvents(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeData)(e)},getWrapEl:function(_){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domClosest)("_wrap",_)},getFieldEl:function(_){return _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)("_field",_)?_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(uiSearch.getWrapEl(_),"_field")},stopEvents:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(_,"eventHandlers")||[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.each)(e,(function(_,e){e.stop()}))},startEvents:function(_){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(_,"eventHandlers")||[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.each)(e,(function(_,e){e.stop(),e.start()}))},init:function init(el,options){if(el&&(el=uiSearch.getFieldEl(el),el)){var wrapEl=uiSearch.getWrapEl(el),delayedInitOptions=!options&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)(wrapEl,"init-options");if(delayedInitOptions){var evalScript="(function() { return "+delayedInitOptions+" })()";try{var _initOptions$suggeste,initOptions=eval(evalScript);(null==initOptions||null==(_initOptions$suggeste=initOptions.suggester)?void 0:_initOptions$suggeste.useCatalogSuggest)?setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)(wrapEl,"init-options",null)),0):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)(wrapEl,"init-options",null),uiSearch.init(el,initOptions)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_7__.logEvalError)(_,evalScript)}}else if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(el,"inited")){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(el,"inited",1);var onKeyDown=uiSearch.onKeyDown.pbind(el),onBuffer=function(_){if("input"===_.type&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_6__.browser.msie){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(el);if(e===((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)(el,"prev-value")||""))return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)(el,"prev-value",e)}setTimeout(uiSearch.onChanged.pbind(el,!1,_),0)};(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_1__.placeholderInit)(el),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(el,"opts",options);var onFocus=_=>{if(options.focusedModifierTargetSelector){var e=document.querySelector(options.focusedModifierTargetSelector);null==e||e.classList.add(SEARCH_FOCUSED_CLASS)}null==options.onFocus||options.onFocus(_)},onBlur=_=>{if(options.focusedModifierTargetSelector){var e=document.querySelector(options.focusedModifierTargetSelector);null==e||e.classList.remove(SEARCH_FOCUSED_CLASS)}null==options.onBlur||options.onBlur(_)},mainHandler;if(options.suggester){var _options$suggester;options.suggester.useCatalogSuggest=!!(null==options||null==(_options$suggester=options.suggester)?void 0:_options$suggester.useCatalogSuggest),options.suggester.useCatalogSuggest||(options.suggester.instance=new Suggester(el,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.extend)(options.suggester,{type:options.suggester.type,historyItems:!!options.suggester.history&&options.suggester.historyItems,onSearch:function(_,e,t,i,o){_||(options.allowFiltersForEmpty||uiSearch.removeAllFilters(el),uiSearch.hideProgress(el)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(wrapEl,"ui_search_field_empty",!_),options.onChange&&options.onChange.call(el,_,e,t,i,o)}}))),mainHandler={start:function(){onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(el,"focus",onFocus)},stop:function(){onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.removeEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.removeEvent)(el,"focus",onFocus)}}}else{var searchBtn=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("_ui_search_button_search",wrapEl),onBtnClick=function(_){uiSearch.onEnter(el,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.elfocus)(el)};mainHandler={start:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(el,"keydown",onKeyDown),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(el,"paste cut input",onBuffer),onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(el,"focus",onFocus),searchBtn&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(searchBtn,"click",onBtnClick)},stop:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.removeEvent)(el,"keydown",onKeyDown),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.removeEvent)(el,"paste cut input",onBuffer),onBlur&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.removeEvent)(el,"blur",onBlur),onFocus&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.removeEvent)(el,"focus",onFocus),searchBtn&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.removeEvent)(searchBtn,"click",onBtnClick)}}}if(mainHandler.start(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(el,"eventHandlers",[mainHandler]),options.params){var _options$suggester2,_options$suggester3,content=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.trim)(options.params.html)),newOptions=(null==options||null==(_options$suggester2=options.suggester)?void 0:_options$suggester2.useCatalogSuggest)?{forceSide:"bottom",setPos:()=>({left:"auto",top:"52px"})}:{};options.paramsTooltip=new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_3__.ElementTooltip((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("_ui_search_params_button",wrapEl),(0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_9__.default)({appendTo:wrapEl,content,autoShow:!1,customShow:!0,shift:options.params.shift?options.params.shift:0,offset:[0,-2]},newOptions)),options.paramsTooltip.build(),(null==options||null==(_options$suggester3=options.suggester)?void 0:_options$suggester3.useCatalogSuggest)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(options.paramsTooltip._ttel,{right:0}),setTimeout((function(){(function initScript(){try{eval(options.params.script)}catch(_){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_7__.logEvalError)(_,options.params.script)}}).call(el)}))}options.fixed&&uiSearch.setFixed(el),options.noAutoDestroy||cur.destroy.push(uiSearch.stopEvents.pbind(el)),uiSearch.initFilters(el,options),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.isFunction)(options.onInit)&&options.onInit(el,options)}}},getOptions:function(_){var e;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(_,"_field"))e=_;else{var t=uiSearch.getWrapEl(_);e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("_field",t)}return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(e,"opts")||{}},toggleParameters:function(_){var e=uiSearch.getOptions(_);e.paramsTooltip&&e.paramsTooltip.toggle()},hideParameters:function(_){var e=uiSearch.getOptions(_);e&&e.paramsTooltip&&e.paramsTooltip.hide()},saveHistorySearch:function(_,e,t,i,o,s){e||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(_));var a=uiSearch.getOptions(_);a.suggester&&a.suggester.instance&&a.suggester.instance.saveHistoryItem(e,t,i,o,s)},onEnter:function(_,e){_=uiSearch.getFieldEl(_);var t=uiSearch.getOptions(_),i=_.getValue?_.getValue():_.value;return t.onEnter&&t.onEnter(_,i,e),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.cancelEvent)(e)},onKeyDown:function(_,e){if(cur.preventInputActions&&-1!=[_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.KEY.RETURN,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.KEY.ESC,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.KEY.DOWN,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.KEY.UP].indexOf(e.keyCode))return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.cancelEvent)(e);if(e.keyCode==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.KEY.RETURN)return uiSearch.onEnter(_,e);if(e.keyCode==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.KEY.ESC){var t=!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(_);return uiSearch.reset(_,!1,e),!t||(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.cancelEvent)(e)}setTimeout.pbind(uiSearch.onChanged.pbind(_,!1,e),0)},onChanged:function(_,e,t){_=uiSearch.getFieldEl(_);var i=uiSearch.getOptions(_),o=uiSearch.getWrapEl(_),s=_.getValue?_.getValue():_.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(o,"ui_search_field_empty",!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.trim)(s)),s||i.allowFiltersForEmpty||uiSearch.removeAllFilters(_),e||i.onChange&&i.onChange.call(_,s,t)},focus:function(_){_=uiSearch.getFieldEl(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.elfocus)(_)},reset:function(_,e,t){_=uiSearch.getFieldEl(_);var i=uiSearch.getOptions(_),o=uiSearch.getWrapEl(_);(_.getValue?_.getValue():_.value)?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(_,""),uiSearch.onChanged(_,e,t),e||i.onEnter&&i.onEnter(_,""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.elfocus)(_)):i.in_tabs&&_web_legacy_ui_ui_tabs__WEBPACK_IMPORTED_MODULE_5__.default.hideSearch(o),window.tooltips&&tooltips.destroyAll()},showProgress:function(_){_=uiSearch.getFieldEl(_);var e=uiSearch.getWrapEl(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(e,"ui_search_loading");var t=_.getValue?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.trim)(_.getValue()):_.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(e,"ui_search_field_empty",!t)},hideProgress:function(_){_=uiSearch.getFieldEl(_);var e=uiSearch.getWrapEl(_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(e,"ui_search_loading");var t=_.getValue?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.trim)(_.getValue()):_.value;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(e,"ui_search_field_empty",!t)},scrollResize:function(_){if(!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_6__.browser.mobile){_=uiSearch.getFieldEl(_);var e,t=uiSearch.getWrapEl(_),i=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domPN)(t),o=t&&t.classList.contains("ui_search_fixed"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)(cur.uiSearchPageBlock)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.gpeByClass)("page_block",_),a=vk.staticheader?Math.max(0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("page_header"))[1]-scrollNode.scrollTop):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("page_header"))[1],l=t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isAncestor)(t,boxLayerWrap);if(t&&i&&(l||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.gpeByClass)("scroll_fix",t))&&(!_.ignoreFixed||o)&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isVisible)(i))if(l?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(i,!0)[1]<0:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(i,!0)[1]<a){var n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getStyle)(t.classList.contains("ui_search_new")?t:_,"width"));!o&&n&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(i,"height",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(t)[1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(t,"width",n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(t,"ui_search_fixed"));var r=Math.min(0,Math.max(-document.body.scrollLeft,document.body.clientWidth-(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("page_layout"))[0]));if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(t,{marginLeft:r}),s){var d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(s)[1]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(s)[1]-(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_8__.scrollGetY)()-_.offsetHeight;(e=Math.min(a,Math.max(-_.offsetHeight,d)))!==cur.lastUISearchPos&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(t,"top",e),cur.lastUISearchPos=e)}}else o&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(i,"height",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(t,{top:"",marginLeft:""}),cur.lastUISearchPos=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(t,"ui_search_fixed"))}},setStatic:function(_){_.ignoreFixed=!0;var e=uiSearch.getWrapEl(_),t=e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domPN)(e);e&&t&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(t,"height",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(e,{top:"",marginLeft:""}),cur.lastUISearchPos=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(e,"ui_search_fixed"))},setFixed:function(_){if(_.ignoreFixed=!1,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(_,"resizeEventHandler")){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isAncestor)(_,boxLayerWrap)?boxLayerWrap:window,t=uiSearch.scrollResize.pbind(_),i={stop:_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.removeEvent.pbind(e,"scroll",t),start:_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent.pbind(e,"scroll",t)};(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(_,"eventHandlers",((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(_,"eventHandlers")||[]).concat([i])),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(_,"resizeEventHandler",!0),i.start()}uiSearch.scrollResize(_)},initFilters:function(_,e){if(_){var t=uiSearch.getWrapEl(_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("ui_search_fltr_control",t),o={start:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(i,"click",(function(_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(i,"shown")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(_.target,"ui_search_fltr_control")||a(i)})),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(i,"mouseover",(function(){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(i,"shown")){var _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(i,"hidetimer");_&&(clearTimeout(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(i,"hidetimer",0)),a(i,!0)}})),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(i,"mouseout",(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(i,"hidetimer")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(i,"hidetimer",setTimeout((function(){a(i,!1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(i,"hidetimer",0)}),200))}))},stop:_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.removeEvent.pbind(i,"click mouseover mouseout")};(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(_,"eventHandlers",((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(_,"eventHandlers")||[]).concat([o])),o.start();var s=uiSearch._getFiltersPane(_);(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(s,"click",(function(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(e.target,"token_title")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(e.target,"token_del")){var t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.gpeByClass)("token",e.target),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)(t,"id");uiSearch.removeFilter(_,i)}}))}function a(_,e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(_,"shown",e)}},removeAllFilters:function(_){var e=uiSearch._getFiltersPane(_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(e,"cur_filters");(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.each)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.extend)({},t),(function(e){uiSearch.removeFilter(_,e,!0)}))},toggleFilter:function(_,e,t,i){i?uiSearch.addFilter(_,e,t):uiSearch.removeFilter(_,e)},addFilter:function(_,e,t){if(e&&t){var i=uiSearch._getFiltersPane(_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(i,"cur_filters")||{};o[e]=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(i,"cur_filters",o);var s=uiSearch.getOptions(_);s.onFiltersChanged&&s.onFiltersChanged(o),uiSearch._renderFilters(_)}},removeFilter:function(_,e,t){var i=uiSearch._getFiltersPane(_),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(i,"cur_filters")||{};if(o[e]){delete o[e],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(i,"cur_filters",o);var s=uiSearch.getOptions(_);s.onFilterRemoved&&s.onFilterRemoved(e,_,t),s.onFiltersChanged&&s.onFiltersChanged(o),uiSearch._renderFilters(_)}},_getFiltersPane:function(_){var e=uiSearch.getWrapEl(_)||_;return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("ui_search_filters_pane",e)},_renderFilters:function(_){clearTimeout((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(_,"renderFiltersTO")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(_,"renderFiltersTO",setTimeout(uiSearch._doRenderFilters.pbind(_)))},_doRenderFilters:function(_){var e=uiSearch._getFiltersPane(_),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(e,"cur_filters")||{},i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("ui_search_filters",e);if(i)if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.isEmpty)(t))(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(e,"expanded"),setTimeout((function(){i.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)(e)}),200);else{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClassDelayed)(e,"expanded");var o=[],s={},a=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.each)(t,(function(_,e){var t=!1,i=!1,l=_.match(/(.*?)_([^_]+)$/),n=l&&l[2]||!1;(l=l&&l[1]||!1)&&(void 0!==s[l]&&"from"===n?i=s[l]:void 0!==s[l]&&(t=s[l]+1),s[l]=a);var r=`<div class="token" id="token${_}" data-id="${_}">\n                         <div class="token_title">${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.replaceEntities)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.clean)(e))}</div>\n                         <div class="token_del"></div>\n                       </div>`;!1!==i?o.splice(i,0,r):!1!==t?o.splice(t,0,r):o.push(r),a++})),i.innerHTML=o.join("")}}};const __WEBPACK_DEFAULT_EXPORT__=uiSearch},636870:(_,e,t)=>{"use strict";t.d(e,{default:()=>u});var i=t(873589),o=t(342269),s=t(840060),a=t(152278),l=t(368752),n=t(660080),r=t(997109),d={initTabs:function(_,e,t){if(void 0===t&&(t=!0),!(s.browser.msie&&(0,o.intval)(s.browser.version)<10||s.browser.opera&&(0,o.intval)(s.browser.version)<15||(0,i.hasClass)(_,"ui_tabs_sliding"))){var a=(0,i.getSize)(e)[0],l=e.offsetLeft,n=(0,i.geByClass1)("_ui_tabs_slider",_);if(n&&!(0,i.domData)(_,"inited")){var r={width:a+"px",marginLeft:l};(0,i.setStyle)(n,r)}t&&d.tryInitTabsScroll(_)}},tryInitTabsScroll:function(_){var e=_.querySelector(".js-tabs-scroll:not(.js-tabs-scroll-inited)");if(e){e.classList.add("js-tabs-scroll-inited");var t=new n.UIGallery(e,{scrollY:!1}),i=(0,l.debounce)((()=>{t.refresh()}),200);window.addEventListener("resize",i),(0,r.pushNavDestroy)((()=>{t.destroy(),window.removeEventListener("resize",i)}))}},tryInit:function(_,e){if(void 0===e&&(e=!0),!(0,i.domData)(_,"inited")){var t=(0,i.geByClass1)("ui_tab_group_sel",_)||(0,i.geByClass1)("ui_tab_sel",_);t&&d.initTabs(_,t,e),(0,i.domData)(_,"inited",1)}},goTab:function(_,e,t,o){if(void 0===o&&(o=!1),(0,a.checkEvent)(e))return!0;var s=(0,i.gpeByClass)("ui_tabs",_);return!(!t&&(0,i.geByClass1)("ui_tab_sel",s)==_)&&(d.switchTab(_),d.showProgress(s),nav.go(_,e,{tab:_,noframe:o}))},switchTab:function(_,e){var t=(0,i.gpeByClass)("ui_tabs",_),s=(0,i.geByClass1)("ui_tab_sel",t),a=null,l=null,n=(0,i.hasClass)(s,"ui_tab_group_item")?l=(0,i.gpeByClass)("ui_tab_group",s):s,r=(0,i.hasClass)(_,"ui_tab_group_item")?a=(0,i.gpeByClass)("ui_tab_group",_):_;if(_!=s){if(_!=r&&(d.toggleGroup(r,!1),d.resetLabel(r,_)),n){d.initTabs(t,n),e=e||{};var u=(0,i.geByClass1)("_ui_tabs_slider",t);if(u){e.noAnim||r===n||((0,i.addClass)(t,"ui_tabs_sliding"),clearTimeout(cur.tabSlidingTO),cur.tabSlidingTO=setTimeout(i.removeClass.pbind(t,"ui_tabs_sliding"),300));var c=(0,o.intval)(u.style.marginLeft),h={width:(0,i.getSize)(r)[0]+"px"};h[cssTransformProp]="translateX("+(r.offsetLeft-c)+"px)",(0,i.setStyle)(u,h)}s!=n&&r!=n&&d.resetLabel(n),n!=s&&(0,i.removeClass)(n,"ui_tab_group_sel"),(0,i.removeClass)(s,"ui_tab_sel")}if(r!=_&&(0,i.addClass)(r,"ui_tab_group_sel"),(0,i.addClass)(_,"ui_tab_sel"),l&&(0,i.removeClass)(l,"ui_tab_hide_separator"),a){t=(0,i.geByClass1)("ui_tab_group_items",a,"div").children;var E=null;(0,o.each)(t,(function(_,e){"SPAN"===e.tagName?E=e:(0,i.hasClass)((0,i.domFC)(e),"ui_tab_sel")||(0,i.hasClass)(e,"unshown")||(E=null)})),E&&(0,i.addClass)(a,"ui_tab_hide_separator")}}return!1},resetLabel:function(_,e){var t=(0,i.geByClass1)("ui_tab_group_label",_,"span");t&&(t.innerHTML=(e||t).getAttribute("data-default-label"))},toggleGroup:function(_,e){var t=(0,i.data)(_,"visibletimer");t&&clearTimeout(t),(0,i.data)(_,"visibletimer",setTimeout(i.toggleClass.pbind(_,"visible",e),e?0:100)),(0,i.toggleClass)(_,"shown",e)},showGroup:function(_){var e=(0,i.data)(_,"hidetimer");e&&(clearTimeout(e),(0,i.data)(_,"hidetimer",0)),d.toggleGroup(_,!0)},hideGroup:function(_){(0,i.data)(_,"hidetimer")||(0,i.data)(_,"hidetimer",setTimeout((function(){d.toggleGroup(_,!1),(0,i.data)(_,"hidetimer",0)}),200))},showProgress:function(_){(0,i.hasClass)(_,"ui_tabs")||(_=(0,i.gpeByClass)("ui_tabs",_)),(0,i.addClass)(_,"ui_tabs_loading")},hideProgress:function(_){(0,i.hasClass)(_,"ui_tabs")||(_=(0,i.gpeByClass)("ui_tabs",_)),(0,i.removeClass)(_,"ui_tabs_loading")},showSearch:function(_,e){if(cur.viewAsBox)return cur.viewAsBox();if((0,a.checkEvent)(e))return!0;var t=(0,i.gpeByClass)("ui_tabs",_),o=(0,i.domByClass)(t,"_field");return(0,i.addClass)(t,"ui_tabs_search_opened"),uiSearch.focus(o),!1},hideSearch:function(_,e){if((0,a.checkEvent)(e))return!0;var t=(0,i.gpeByClass)("ui_tabs",_);return(0,i.removeClass)(t,"ui_tabs_search_opened"),!1},scrollToActiveTab(_){var e=document.querySelector(`#${_}`);if(e){var t=e.querySelector(".ui_tab_sel, .ui_tab_group_sel"),i=e.querySelector(`.${n.UI_GALLERY_CONTENT_CLASSNAME}`);if(t&&i){var o=t.offsetLeft,s=o+t.offsetWidth,a=i.scrollLeft,l=i.clientWidth,r=a+l,d=o-20,u=s+20;d<a?i.scrollTo({left:d}):u>r&&i.scrollTo({left:u-l})}}}};const u=d},941726:(_,e,t)=>{"use strict";t.d(e,{InlineDropdown:()=>d});var i=t(873589),o=t(840060),s=t(522801),a=t(152278),l=t(224558),n=t(733164),r=t(342269);function d(_,e){if(this.constructor!==d)throw new Error("InlineDropdown was called without 'new' operator");if(_=(0,i.ge)(_)){if(!_.nodeType)throw new Error("First argument not a DOM element");if(!(0,i.hasClass)(_,"idd_wrap")){if(this._opts=e||{},this._items=e.items?(0,r.clone)(e.items):JSON.parse(_.getAttribute("data-items")),!this._items)throw new Error("No items provided");this._title=e.keepTitle?e.title||_.innerHTML:"",this._selectable=!e.keepTitle||e.keepSelected,this._disableCancelClickEvent=!!e.disableCancelClickEvent&&!!e.disableCancelClickEvent;var t=(0,l.getIcon12Dropdown)().icon;this._iddEl=(0,i.se)(`<div class="idd_wrap" id="${_.id}">\n    <div class="idd_selected_value" tabindex="0" role="button">\n      ${_.innerHTML}\n    </div>\n    ${e.withArrow?`<div class="idd_chevron">${t}</div>`:""}\n    <input type="hidden" id="${_.id}_input" name="${_.getAttribute("name")||_.id}" />\n  </div>`);var o=this;if((0,n.each)(_.className.split(" "),(function(_,e){(0,i.addClass)(o._iddEl,e)})),(0,n.each)(_.attributes,(function(_,e){0==e.name.indexOf("data-")&&o._iddEl.setAttribute(e.name,e.value)})),_.parentNode.replaceChild(this._iddEl,_),this._els={valueEl:(0,i.geByClass1)("idd_selected_value",this._iddEl),itemsContentEl:(0,i.geByClass1)("idd_items_content",this._iddEl),hiddenInputEl:(0,i.geByTag1)("input",this._iddEl)},this._opts.autoShow){var s=!1,u=function(){s=!0,clearTimeout(o._autoShowTimeout),o._autoShowTimeout=setTimeout((function(){s&&o._onClick()}),100)};(0,a.addEvent)(this._iddEl,"mouseenter",u),(0,a.addEvent)(this._iddEl,"mouseleave",(function(){clearTimeout(o._autoShowTimeout),s=!1})),(0,a.addEvent)(this._iddEl,"keydown",(_=>"Enter"===_.key&&_.target.getAttribute("class").includes("idd_selected_value")?u():null))}else(0,a.addEvent)(this._iddEl,"click",this._onClick.bind(this)),(0,a.addEvent)(this._iddEl,"keydown",(_=>"Enter"===_.key&&_.target.getAttribute("class").includes("idd_selected_value")?this._onClick.call(this):null));this._rebuildDropdown();var c=!1;void 0!==e.selected?c=e.selected:_.hasAttribute("data-value")&&(c=_.getAttribute("data-value")),!1!==c&&this.select(c,!0)}}}d.IDD_HEADER_CORRECTION_LEFT=-10,d.IDD_HEADER_CORRECTION_TOP=-8,d.prototype._rebuildDropdown=function(){var _=this._opts.withIcon?"idd_with_icon":"",e=this._opts.idPrefix?this._opts.idPrefix:"",t=this._opts.idItemPrefix?this._opts.idItemPrefix:"",s=this,r=this._opts.ariaLabel||"",u=(0,l.getIcon12Dropdown)().icon,c=`<div class="idd_header_wrap ${_}">\n    <div class="idd_header" id="${e}${this._items[0][0]}"></div>\n      ${this._opts.withArrow?`<div class="idd_chevron">${u}</div>`:""}\n    </div>`,h=`<div class="idd_items_wrap"><div class="idd_items_content" role="list" aria-label="${r}">`;(0,n.each)(this._items,(function(e,i){h+="separator"===i?'<div class="idd_separator"></div>':function(e,i){i=i||"";var o=s._opts.sublists&&s._opts.sublists[e[0]]?"idd_sublist":"";return`<div class="idd_item ${i} ${_} ${o}" id="${t}idd_item_${e[0]}" data-id="${e[0]}" tabindex="0" role="button">\n      ${s._opts.withIcon?'<div class="idd_item_icon" id="'+e[0]+'"></div>':""}\n      <div class="idd_item_name">${s._opts.html?s._opts.html(e):e[1]}</div>\n    </div>`}(i)})),h+="</div></div>",this._els.popupItems=(0,i.se)(h),this._els.popupHeader=(0,i.se)(c),(0,a.addEvent)(this._els.popupItems,"click",(function(_){var e=_.target;if("a"!=e.tagName.toLowerCase()){for(;e&&!(0,i.hasClass)(e,"idd_item");)e=e.parentNode;e&&(s.select(e.getAttribute("data-id"))?s._hide():s._hoverItem(e)),(0,a.cancelEvent)(_)}else setTimeout((function(){s._hide()}))})),(0,n.each)((0,i.geByClass)("idd_item",this._els.popupItems),(function(_,e){(0,a.addEvent)(e,"mouseenter",(function(_){d._preventMouseHover||s._hoverItem(_.currentTarget)})),(0,a.addEvent)(e,"mouseleave",(function(_){d._preventMouseHover||s._unhoverItem(_.currentTarget,_)}))})),(0,a.addEvent)(this._els.popupItems,"mouseenter",function(){(0,a.addEvent)(this._els.popupItems,o.browserFeatures.wheelEvent,this._onWheel.bind(this))}.bind(this)),(0,a.addEvent)(this._els.popupItems,"mouseleave",function(){(0,a.removeEvent)(this._els.popupItems,o.browserFeatures.wheelEvent,this._onWheel.bind(this))}.bind(this))},d.prototype._onClick=function(_){if((0,i.isVisible)(this._els.popupEl))this._hide();else{d._currIDD&&d._currIDD._hide(),d._currIDD=this,window.tooltips&&tooltips.hideAll();var e=this,t=this._els.popupEl=(0,i.se)('<div class="idd_popup"></div>');this._opts.alignLeft&&(0,i.addClass)(t,"idd_align_left"),this._opts.popupClass&&(0,i.addClass)(t,this._opts.popupClass),this.openToUp=1==this._opts.forceDir||"up"==this._opts.forceDir||-1!=this._opts.forceDir&&"down"!=this._opts.forceDir&&(0,i.getXY)(e._iddEl)[1]-((window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0))+200>window.innerHeight,this.openToUp?(t.appendChild(this._els.popupItems),t.appendChild(this._els.popupHeader)):(t.appendChild(this._els.popupHeader),t.appendChild(this._els.popupItems));var o=(0,i.geByClass1)("idd_header",this._els.popupHeader);this._opts.keepTitle?o.innerHTML=this._title:o.innerHTML=this._selected?this._selected[1]:"",t.id="idd_"+this._iddEl.id,this._iddEl.appendChild(t);var s=(0,i.getSize)(t),l=(0,i.getSize)(this._els.valueEl),n=0;this.openToUp&&(n=-(0,i.getSize)(this._els.popupItems)[1]);var r={marginTop:(this._opts.headerTop||d.IDD_HEADER_CORRECTION_TOP)+n,width:s[0]+8,opacity:1};this._opts.alignLeft?r[vk.rtl?"marginRight":"marginLeft"]=l[0]-d.IDD_HEADER_CORRECTION_LEFT:r.marginLeft=(this._opts.headerLeft||d.IDD_HEADER_CORRECTION_LEFT)-(this._opts.withIcon?20:0),(0,i.setStyle)(t,r),this._unhoverItem(),this._highlightItem(),this._initOutEvent(),this._initKeypressEvent(),this._opts.onShow&&this._opts.onShow(this.ddEl),this._disableCancelClickEvent||(0,a.cancelEvent)(_)}},d.prototype._hide=function(){(0,i.re)(this._els.popupEl),this._els.popupEl=null,(0,i.removeClass)(this._hoveredItem,"idd_hover"),this._hoveredItem=null,this._deinitEvents(),this._hideSubmenu(),clearTimeout(this._hideSubmenuTimeout),this._opts.onHide&&this._opts.onHide()},d.prototype._highlightItem=function(_){if(this._selectable&&this._els.popupEl){if(void 0===_){if(!this._selected)return;_=this._selected[0]}var e=(0,i.geByClass1)("idd_hl",this._els.popupEl);e&&(0,i.removeClass)(e,"idd_hl");var t=(0,i.ge)("idd_item_"+_);(0,i.addClass)(t,"idd_hl");var o=this;(0,n.each)((0,i.geByClass)("idd_item",this._els.popupItems),(function(_,e){if(e==t)return o._els.popupItems.scrollTop=(_+1)*(0,i.getSize)(e)[1]-(0,i.getSize)(o._els.popupItems)[1]/2,!1}))}},d.prototype._onWheel=function(_){var e=(0,i.getSize)((0,i.geByClass1)("idd_items_content",this._els.popupItems))[1],t=(0,i.getSize)(this._els.popupItems)[1];e!=t&&(0==this._els.popupItems.scrollTop&&_.deltaY<0||this._els.popupItems.scrollTop==e-t&&_.deltaY>0)&&(0,a.cancelEvent)(_)},d.prototype._onKeyDown=function(_){switch(_.keyCode){case 9:case 38:case 40:case 13:case 27:this._onKey(_.keyCode,_)}},d.prototype._onKeyPress=function(_){this._onKey(_.which,_)},d.prototype._hideSubmenu=function(){(0,i.removeClass)(this._currSubmenuItem,"idd_hover_sublist_parent"),(0,i.re)(this._els.currCascade),delete this._currSubmenuItem,this._hoveredItem&&this._showSubmenu(this._hoveredItem)},d.prototype._showSubmenu=function(_){if(clearTimeout(this._hideSubmenuTimeout),_){var e=this,t=_.getAttribute("data-id");if(this._opts.sublists&&this._opts.sublists[t]){if((0,i.addClass)(_,"idd_hover_sublist_parent"),this._currSubmenuItem==_)return void clearTimeout(this._submenuHideTimeout);var o=this._opts.sublists[t],l='<div class="idd_popup"><div class="idd_items_wrap"><div class="idd_items_content">',r=o.withIcon?"idd_with_icon":"";function b(_,e){return'<div class="idd_item '+(e=e||"")+" "+r+'" id="idd_item_'+_[0]+'" data-id="'+_[0]+'" role="button" tabindex="0">'+(o.withIcon?'<div class="idd_item_icon" id="'+_[0]+'"></div>':"")+'<div class="idd_item_name">'+(o.html?o.html(_):_[1])+"</div></div>"}(0,n.each)(o.items,(function(_,e){l+=b(e)})),l+="</div></div></div>",this._els.currCascade=(0,i.se)(l),this._iddEl.appendChild(this._els.currCascade);for(var u=(0,i.getSize)(this._els.popupEl),c=(0,i.getSize)(_),h=(0,i.getSize)(this._els.currCascade),E=0,p=_;null!=(p=p.previousSibling);)E++;var P=u[0]+(this._opts.headerLeft||d.IDD_HEADER_CORRECTION_LEFT)-1;(0,i.setStyle)(this._els.currCascade,{marginLeft:P-3,marginTop:c[1]*E+6-(this.openToUp?u[1]:0),"z-index":200,width:h[0]+30}),setTimeout((function(){(0,s.cssAnim)(e._els.currCascade,{marginLeft:P,opacity:1},{duration:140})}),10),(0,n.each)((0,i.geByClass)("idd_item",this._els.currCascade),(function(_,t){(0,a.addEvent)(t,"mouseenter",(function(_){e._isInSubmenu=!0,d._preventMouseHover||e._hoverItem(_.currentTarget,null,!0)})),(0,a.addEvent)(t,"mouseleave",(function(_){e._isInSubmenu=!1,d._preventMouseHover||e._unhoverItem()}))})),(0,a.addEvent)(this._els.currCascade,"click",(function(_){var t=_.target;if("a"!=t.tagName.toLowerCase()){for(;t&&!(0,i.hasClass)(t,"idd_item");)t=t.parentNode;if(t){var s=!0,l=t.getAttribute("data-id"),n=(0,i.geByClass1)("idd_item_name",t).innerHTML;o.onSelect?s=o.onSelect(l,n):e._opts.onSelect&&(s=e._opts.onSelect(l,n)),s&&e._hide()}(0,a.cancelEvent)(_)}else setTimeout((function(){e._hide()}))})),this._currSubmenuItem=_}}},d.prototype._hoverItem=function(_,e,t){var o=this;if(this._unhoverItem(),(0,i.addClass)(_,"idd_hover"),this._hoveredItem=_,e&&_){var s=_.getAttribute("id"),a=this;(0,n.each)((0,i.geByClass)("idd_item"),(function(e,t){if(t.getAttribute("id")==s)return a._els.popupItems.scrollTop=(0,i.getSize)(_)[1]*(e+1)-(0,i.getSize)(a._els.popupItems)[1]/2,clearTimeout(d._preventMouseHover),d._preventMouseHover=setTimeout((function(){d._preventMouseHover=null}),100),!1}))}if(clearTimeout(this._hideSubmenuTimeout),t)(0,i.addClass)(this._currSubmenuItem,"idd_hover_sublist_parent");else{var l=this._currSubmenuItem==_;this._currSubmenuItem&&!l&&(this._hideSubmenuTimeout=setTimeout((function(){o._hideSubmenu()}),200)),this._currSubmenuItem||this._showSubmenu(_),(0,i.removeClass)(this._currSubmenuItem,"idd_hover_sublist_parent")}},d.prototype._unhoverItem=function(_,e){this._hoveredItem&&(0,i.removeClass)(this._hoveredItem,"idd_hover"),this._hoveredParentItem&&(0,i.removeClass)(this._hoveredParentItem,"idd_hover"),clearTimeout(d._preventMouseHover)},d.prototype._onKey=function(_,e){if(38==_||40==_){var t=this._hoveredItem||(0,i.geByClass1)("idd_hl",this._els.popupItems)||(0,i.geByClass1)("idd_item",this._els.popupItems);return t=38==_?t.previousSibling:t.nextSibling,this._hoverItem(t,!0),(0,a.cancelEvent)(e),!1}if(9==_){var o=(0,i.geByClass1)("idd_items_content",this._els.popupItems),s=e.target;return s=e.target.getAttribute("class").includes("idd_item")?e.shiftKey?s.previousSibling:s.nextSibling:e.shiftKey?o.lastChild:o.firstChild,this._hoverItem(s,!0),!1}13==_?this._hoveredItem&&this.select(this._hoveredItem.getAttribute("data-id"))&&this._hide():27==_?this._hide():this._quickSearch(_)},d.prototype._quickSearch=function(_){var e=this;if(void 0!==_){var t=String.fromCharCode(_).toLowerCase();if(!t)return;setTimeout((function(){e._currSearchStr=""}),600),this._currSearchStr=this._currSearchStr||"",this._currQuickSearchIndex=this._currQuickSearchIndex||0,1==this._currSearchStr.length&&this._currSearchStr[0]==t||(this._currSearchStr+=t)}for(var o=this._items,s=this._currQuickSearchIndex;s<o.length;s++){var a=o[s][1].toLowerCase();if(1==this._currSearchStr.length&&this._currSearchStr==a[0]||this._currSearchStr.length>1&&a.indexOf(this._currSearchStr)>=0){this._currQuickSearchIndex=s+1,this._hoverItem((0,i.ge)("idd_item_"+o[s][0]),!0),s==o.length-1&&(this._currQuickSearchIndex=0);break}s==o.length-1&&(this._currQuickSearchIndex=0,_&&this._quickSearch())}},d.prototype._deinitEvents=function(){(0,a.removeEvent)(window,"click",d._window_onOuterClick),(0,a.removeEvent)(window,"keypress",d._window_onKeyPress),(0,a.removeEvent)(window,"keydown",d._window_onKeyDown)},d.prototype._initKeypressEvent=function(){(0,a.addEvent)(window,"keypress",d._window_onKeyPress=this._onKeyPress.bind(this)),(0,a.addEvent)(window,"keydown",d._window_onKeyDown=this._onKeyDown.bind(this))},d.prototype._onOuterClick=function(_){for(var e=_.target,t=!0;e&&e!=document;){if((0,i.hasClass)(e,"idd_popup")){t=!1;break}e=e.parentNode}t&&this._hide()},d.prototype._initOutEvent=function(){var _=this;setTimeout((function(){(0,a.addEvent)(window,"click",d._window_onOuterClick=_._onOuterClick.bind(_))})),this._opts.autoHide>0&&((0,a.addEvent)(this._iddEl,"mouseleave",(function(){clearTimeout(_._leaveTimeout),_._leaveTimeout=setTimeout((function(){_._isInSubmenu||_._hide()}),_._opts.autoHide)})),(0,a.addEvent)(this._iddEl,"mouseenter",(function(){clearTimeout(_._leaveTimeout)})))},d.prototype.deinit=function(){this._deinitEvents()},d.prototype.setItems=function(_){this._items=(0,r.clone)(_),this.select(_[0][0],!0),this._rebuildDropdown()},d.prototype.getElement=function(){return this._iddEl},d.prototype.getSelected=function(){return this._selected},d.prototype.select=function(_,e){if(!this._opts.sublists||!this._opts.sublists[_]){var t=!1;if((0,n.each)(this._items,(function(e,i){if(i[0]==_)return t=i,!1})),!1===t)throw new Error("No item found for selection");this._selected=t,this._opts.keepTitle||(this._els.valueEl.innerHTML=t[1]),(0,i.val)(this._els.hiddenInputEl,_);var o=!0;if(!e&&this._opts.onSelect)try{o=!this._opts.onSelect(t[0],t)}catch(_){console.error(_)}return o}},d.prototype.val=function(_,e){return void 0!==_?this.select(_,e):this.getSelected()?this.getSelected()[0]:""}},335745:(_,e,t)=>{"use strict";t.d(e,{mapChoiceToActionChoice:()=>o});var i=t(570655);function o(_){switch(_.type){case"action":return _;case"link":{const{href:e}=_,t=(0,i.__rest)(_,["href"]);return Object.assign(Object.assign({},t),{type:"action",action:()=>{var _;null===(_=window.open(e,"_blank"))||void 0===_||_.focus()}})}}}},18432:(_,e,t)=>{"use strict";t.d(e,{CatalogBannerStatCollector:()=>s});var i=t(740517),o=t(214547);class s{constructor(_,e){this.blockId=e;this.observed_items=[],this.observer=new IntersectionObserver((_=>this.onView(_)),{root:null,rootMargin:"0px",threshold:.5}),this.productCollector=new o.ProductionStatCollector,this.viewCollector=new o.ViewStatCollector(this.productCollector),this.clickCollector=new o.ClickStatCollector(this.productCollector),this.elements=_,this.addHandlers()}destroy(){this.observer.disconnect(),this.observed_items.forEach(((_,e)=>this.sendViewStat(e))),this.elements.forEach((_=>_.removeEventListener("mousedown",this.clickHandler)))}addHandlers(){this.clickHandler=this.onClick.bind(this),this.elements.forEach((_=>_.addEventListener("mousedown",this.clickHandler))),this.elements.forEach((_=>this.observer.observe(_)))}onClick(_){if(_.currentTarget&&_.currentTarget instanceof HTMLElement&&_.currentTarget.parentElement&&_.currentTarget.dataset.id){const e=parseInt(_.currentTarget.dataset.id),t={type:i.ClickProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,position:[..._.currentTarget.parentElement.children].indexOf(_.currentTarget)+1},o={type:i.EventItemType.CATALOG_BANNER,id:e,track_code:this.blockId};this.clickCollector.logEvent(t,o)}}sendViewStat(_){if(void 0!==this.observed_items[_]){const e=Object.assign(Object.assign({},this.observed_items[_]),{end_view:this.productCollector.getCurrentTime()}),t={type:i.EventItemType.CATALOG_BANNER,id:_,track_code:this.blockId};this.viewCollector.logEvent(e,t),delete this.observed_items[_]}}onView(_){_.forEach((_=>{const e=_.target;if(e instanceof HTMLElement&&e.parentElement&&e.dataset.id){const t=parseInt(e.dataset.id);_.isIntersecting?void 0===this.observed_items[t]&&(this.observed_items[t]={type:i.ViewProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,start_view:this.productCollector.getCurrentTime(),end_view:"0",position:[...e.parentElement.children].indexOf(e)+1}):this.sendViewStat(t)}}))}}},571627:(_,e,t)=>{"use strict";t.d(e,{ConsumeReason:()=>i,BannersController:()=>s});var i,o=t(18432);!function(_){_.Click="click",_.Close="close"}(i||(i={}));class s{constructor(_,e){this.blockContent=_,this.blockId=e;const t=this.getBanners();this.bannerStatCollector=new o.CatalogBannerStatCollector(t,e)}getBanners(){return Array.from(this.blockContent.querySelectorAll(".BannerItem"))}setBannersEvents(){this.getBanners().forEach((_=>{if(_.dataset.id){const e=parseInt(_.dataset.id);this.addConsumableClick(_,e),this.addConsumableCloseClick(_,e)}}))}checkItems(){this.getBanners().length||this.blockContent&&this.blockContent.remove()}destroy(){this.bannerStatCollector.destroy()}onDataLoad(){}}},708284:(_,e,t)=>{"use strict";t.d(e,{formatAudioTime:()=>o});var i=t(683609);function o({duration:_,progress:e,negative:t}){return t&&e<1?"-"+(0,i.formatTime)(Math.round(_-e*_)):(0,i.formatTime)(Math.round(e*_))}},912334:(_,e,t)=>{"use strict";function i(_){let e=_.split(" ");e=e.slice(0,e.length-1);let t=e.join(" ");return t&&(t+="..."),t}function o(_,e=0){if(_.scrollHeight/_.clientHeight>1.1){let t=_.clientHeight,o=_.innerText;for(;o&&_.scrollHeight/t>1.1&&_.innerText.split(" ").length>e;)o=i(o),_.innerHTML=o}}t.d(e,{truncateMultilineText:()=>o})},918311:(_,e,t)=>{"use strict";t.d(e,{createReactInitiator:()=>i.createReactInitiator});var i=t(206189)},206189:(_,e,t)=>{"use strict";t.d(e,{createReactInitiator:()=>i.createReactInitiator});var i=t(695956)},695956:(_,e,t)=>{"use strict";t.d(e,{createReactInitiator:()=>s});t(570655);var i=t(785893),o=t(382878);function s(_,e=null,t){const s=(0,o.createBasicReactInitiator)(e,t);return Object.assign(Object.assign({},s),{render:function(e){return s.render((0,i.jsx)(_,Object.assign({},e),void 0))}})}},382878:(_,e,t)=>{"use strict";t.d(e,{createBasicReactInitiator:()=>a});var i=t(973935),o=t(997109),s=t(830285);function a(_=null,e={}){const{onRendered:t,onMounted:a,onUpdated:l,onUnmounted:n}=e,r=!_;let d=null;function u(){if(!d)return!1;const _=i.unmountComponentAtNode(d);return r&&d.remove(),d=null,null==n||n(_),_}return{render:function(e){let n=!1;if(d||(n=!0,d=function(_){if("function"==typeof _)return _();return _}(function(){if(_)return _;const e=(0,s.createReactContainer)();return document.body.appendChild(e),e}())),i.render(e,d),null==t||t(u),n){const _=d;(0,o.pushNavDestroy)((()=>{_===d&&u()})),null==a||a(u)}else null==l||l(u)},unmount:u,getContainer:function(){return d},isMounted:function(){return!!d}}}},830285:(_,e,t)=>{"use strict";function i(){const _=document.createElement("div");return _.id=`${o}_${s++}`,_}t.d(e,{createReactContainer:()=>i});const o=`rc_${(0,t(733164).srand)()}`;let s=0},830169:(_,e,t)=>{"use strict";t.d(e,{useUpdateEffect:()=>o,useUpdateLayoutEffect:()=>s});var i=t(667294);const o=a(i.useEffect),s=a(i.useLayoutEffect);function a(_){return function(e,t){const o=(0,i.useRef)();_((()=>{if(o.current)return e();o.current=!0}),t)}}},818709:(_,e,t)=>{"use strict";t.d(e,{BannersController:()=>s});var i=t(571627),o=t(514191);class s extends i.BannersController{constructor(_,e){super(_,e),this.setBannersEvents()}consumeBanner(_,e){o.ajax.post("/al_audio.php?act=consume_banner",{id:_,ref:this.blockId,reason:e},{onFail:()=>!0})}addConsumableClick(_,e){_.classList.contains("BannerItem--consumable")&&_.dataset.id&&_.addEventListener("click",(()=>this.consumeBanner(e,i.ConsumeReason.Click)))}addConsumableCloseClick(_,e){const t=_.querySelector(".BannerItem__close");t instanceof HTMLElement&&(t.onclick=t=>{this.consumeBanner(e,i.ConsumeReason.Close),_.remove(),this.checkItems(),t.stopPropagation(),t.preventDefault()})}checkItems(){const _=this.getBanners();if(_.length){if(1===_.length){const _=this.blockContent.querySelectorAll(".audio_promo__control");_&&_.forEach((_=>_.remove()))}}else this.blockContent&&this.blockContent.remove()}}},204900:(_,e,t)=>{"use strict";t.d(e,{BaseController:()=>a});var i=t(332603),o=t(581359),s=t(325551);class a{fetchNext(){return this.fetchSection(this.id,this.nextFrom)}fetchSection(_,e,t={}){return this.fetchInProgress=!0,new Promise(((i,o)=>{const s=Object.assign({section_id:_,start_from:e},t);window.nav.objLoc.claim&&(s.claim=window.nav.objLoc.claim),window.ajax.post("al_audio.php?act=load_catalog_section",s,{onDone:(_,e,t)=>{this.fetchInProgress=!1,i({blocks:_,data:e,blockItems:t})},onFail:()=>(o(),this.fetchInProgress=!1,!0)})}))}getId(){return this.id}static getHint(_,e){switch(e.type){case i.HintType.Tooltip:return new o.TooltipHint(e,_);case i.HintType.Highlight:return new s.HighlightHint(e,_)}return null}}},30284:(_,e,t)=>{"use strict";t.d(e,{BlockController:()=>g});var i=t(99320),o=t(274642),s=t(350284),a=t(204900),l=t(5e3),n=t(622858),r=t(660080),d=t(456495),u=t(818709),c=t(873589),h=t(642789),E=t(881771),p=t(514191),P=t(303539),b=t(937884);class g extends a.BaseController{constructor(_,e){super(),this.section=_,this.block=e,this.listenEvents=[],this.setFromBlockContent(),this.blockItemsContainer=e.querySelector(`.${s.BLOCK_ITEMS_CONTAINER}`),this.blockItemsContainer&&(this.initialItems=[...this.blockItemsContainer.children]),this.initSpecificBlockController(),this.initGallery(),this.loader=e.getElementsByClassName(s.AUTO_LIST_LOADER)[0],this.initSearch(),this.initSortSelector(),this.initHints(),this.initListenEvents()}initSpecificBlockController(){if(this.blockContent)switch(this.blockContent.dataset.type){case"catalog_banners":this.specificController=new u.BannersController(this.blockContent,this.getId());break;case"artist":case"curator":this.specificController=new P.MusicAuthorController(this.blockContent)}}enable(){this.reorderer&&this.reorderer.enable()}disable(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.disable()}emitEvent(_){if(this.listenEvents.includes(_))if(_===b.events.PLACEHOLDER_REMOVE)this.removeBlock();else this.reloadData()}initSearch(){const _=this.block.getElementsByClassName("ui_search");_.length&&Array.prototype.forEach.call(_,(_=>d.default.init(_)))}initListenEvents(){var _,e;if(null===(_=this.blockContent)||void 0===_?void 0:_.dataset.listenEvents)try{this.listenEvents=JSON.parse(null===(e=this.blockContent)||void 0===e?void 0:e.dataset.listenEvents)}catch(_){}}onSectionInit(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(s.BLOCK_ITEMS_REORDERABLE)&&this.initListReorder("current"!==this.section.name)}hasBlockName(_){return this.blockContent&&this.blockContent.classList.contains(`${s.BLOCK_ELEMENT}__${_}`)}reloadData(){this.fetchSection(this.id,"").then((({blockItems:_,data:e})=>{if(this.setItems(g.createNodesFromItems(_)),e.playlists&&e.playlists.length){const _=(0,o.getAudioPlayer)();_&&_.addWithReplacePlaylists(e.playlists.filter(Boolean))}})).catch((()=>!0))}setFromBlockContent(){if(this.blockContent=this.block.classList.contains(s.BLOCK_CONTENT)?this.block:this.block.querySelector(`.${s.BLOCK_CONTENT}`),this.blockContent){this.id=this.blockContent.dataset.id||"",this.nextFrom=this.blockContent.dataset.next||"",this.dataType=this.blockContent.dataset.type||null;const _=this.blockContent.classList.toString().match(/CatalogBlock__layout--(.*)/);this.layoutName=_&&_[1]}}removeBlock(){this.destroy();const _=this.block.closest(`.${s.BLOCK_ELEMENT}`);let e=this.block;_ instanceof HTMLElement&&1===_.childElementCount&&(e=_),e.remove()}clearList(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")}destroy(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.destroy(),this.specificController&&this.specificController.destroy()}hideLoader(){this.loader&&(this.loader.style.display="none")}showLoader(){this.loader&&(this.loader.style.display="")}setNextFrom(_){this.nextFrom=_,this.blockContent&&(this.blockContent.dataset.next=this.nextFrom)}setId(_){this.id=_,this.blockContent&&(this.blockContent.dataset.id=this.id),this.blockItemsContainer&&this.blockItemsContainer.dataset.playlistId&&(this.blockItemsContainer.dataset.playlistId=this.id)}setItems(_){if(this.blockItemsContainer&&this.dataType&&this.layoutName){new h.BlockItemsReplacer(this.blockItemsContainer,this.dataType,this.layoutName).replaceItems(_)}}resetItems(){this.blockItemsContainer&&(this.clearItems(),this.blockItemsContainer.append(...this.initialItems))}clearItems(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")}initAutoList(_=[]){let e=_;this.blockItemsContainer&&(this.blockAutoList&&this.blockAutoList.destroy(),this.blockAutoList=new i.default(this.blockItemsContainer,{scrollNode:!1,onRendered:()=>{(0,o.getAudioPlayer)().updateCurrentPlaying(),this.specificController&&this.specificController.onDataLoad()},onNoMore:()=>this.hideLoader(),onNeedRows:_=>{if(this.showLoader(),e.length){const t=e;return e=[],void _(t)}this.nextFrom?this.fetchNext().then((({blockItems:e,data:t})=>{this.setNextFrom(t.nextFrom),this.dataType===E.DataType.RadioStations&&t.playlist&&g.mergePlaylistFromPaginatedResponse(t.playlist),_(e)})).catch((()=>{})):_(null)}}))}updateListReorder(){this.reorderer&&this.reorderer.update()}initListReorder(_=!0){let e;switch(this.dataType){case E.DataType.MusicAudios:e=(e,t,i)=>this.onAudioBlockReorder(e,t,i,_);break;case E.DataType.MusicPlaylists:e=this.onPlaylistsBlockReorder.bind(this);break;default:e=()=>{}}this.reorderer=new n.default(this.blockItemsContainer,"",{onReorder:e.bind(this)})}onAudioBlockReorder(_,e,t,i){window.currentAudioPage(this.block).onAudioRowsReorder(!i,_,e,t)}onPlaylistsBlockReorder(_,e,t){window.currentAudioPage(this.block).onPlaylistsReorder(_,e,t)}static mergePlaylistFromPaginatedResponse(_){const e=(0,o.getAudioPlayer)(),t=e.getPlaylist(_.type,_.ownerId,_.id);e.mergePlaylistData(t,_)}initSortSelector(){const _=this.block.querySelector(`.${s.SORTER_ACTION}`);_&&(this.sortSelector=new l.BlockSorter(_,(_=>{p.ajax.post("/al_audio.php?act=replace_blocks",{replacement_ids:_},{onDone:_=>this.section.replaceBlocks(_.replacements,_.nextFrom,_.playlists)})})))}initGallery(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(s.GALLERY)&&(this.gallery=new r.UIGallery(this.blockItemsContainer,{scrollY:!1}))}static search(_,e,t,i){const o=g.findBlockById(_,i.target);o&&!o.fetchInProgress&&(t?o.fetchSection(e,"",{search_query:t}).then((({blockItems:_})=>{o.setItems(g.createNodesFromItems(_))})).catch((()=>!0)):o.resetItems())}static showMore(_,e){const t=g.findBlockById(_,e);t&&!t.fetchInProgress&&t.fetchNext().then((({blockItems:_,data:e})=>{t.setItems(g.createNodesFromItems(_)),t.nextFrom=e.nextFrom})).catch((()=>!0))}static findBlockById(_,e){const t=window.currentAudioPage(e).catalogController.currentSection;return t?t.getBlockById(_):null}static findBlockByElement(_){const e=(0,c.gpeByClass)("CatalogBlock__content",_);return(null==e?void 0:e.dataset.id)||null}static createNodesFromItems(_){return _.map((_=>{const e=document.createElement("template");return e.innerHTML=_,e.content.firstElementChild})).filter((_=>!!_))}initHints(){if(this.block.dataset.catalogHintId){const _=this.section.getHintById(this.block.dataset.catalogHintId);if(_){const e=a.BaseController.getHint(this.block,_);if(e){const t=this.section.hintsToShow.findIndex((_=>e.id===_.id&&_.initialElement.parentElement===e.initialElement.parentElement));if(t>-1){const e=this.section.hintsToShow[t],i=e.initialElement.parentElement||e.initialElement,o=a.BaseController.getHint(i,_);o&&(this.section.hintsToShow[t]=o)}else this.section.hintsToShow.push(e)}delete this.block.dataset.catalogHintId}}const _=this.block.querySelectorAll("[data-catalog-hint-id]");if(_.length){const e={};_.forEach((_=>{_.dataset.catalogHintId&&(Array.isArray(e[_.dataset.catalogHintId])?e[_.dataset.catalogHintId].push(_):e[_.dataset.catalogHintId]=[_],delete _.dataset.catalogHintId)})),Object.entries(e).forEach((([_,e])=>{const t=this.section.getHintById(_);if(!t)return;let i;i=1===e.length?e[0]:this.block;const o=a.BaseController.getHint(i,t);o&&this.section.hintsToShow.push(o)}))}}}},642789:(_,e,t)=>{"use strict";t.d(e,{BlockItemsReplacer:()=>s});var i=t(881771),o=t(864809);class s{constructor(_,e,t){this.container=_,this.dataType=e,this.layoutName=t}replaceItems(_){switch(this.dataType){case i.DataType.MusicAudios:this.replaceItemsBase(_);break;case i.DataType.MusicPlaylists:this.replaceMusicPlaylists(_);break;case i.DataType.MusicOwners:this.replaceMusicOwners(_);break;default:this.replaceItemsBase(_)}}replaceMusicPlaylists(_){let e=_;this.layoutName===o.LayoutName.LargeSlider&&(e=_.slice(0,5)),this.replaceItemsBase(e)}replaceItemsBase(_){this.container.innerHTML="",this.container.append(..._)}replaceMusicOwners(_){const e=_[0];if(e){const _=e.querySelector(".MusicOwnerCell__actions");if(_){const e=this.container.querySelector(".MusicOwnerCell__actions");if(e)e.innerHTML=_.innerHTML;else{const e=this.container.querySelector(".MusicOwnerCell__after");e&&e.appendChild(_)}}}}}},5e3:(_,e,t)=>{"use strict";t.d(e,{BlockSorter:()=>s});var i=t(350284),o=t(941726);class s{constructor(_,e){this.element=_;const t=this.getConfig();this.dropdown=new o.InlineDropdown(_,Object.assign({onSelect:e},t))}getConfig(){const _=this.element.querySelector(`.${i.SORTER_ACTION_DATA}`);if(!_)return null;const e=Array.from(_.querySelectorAll("li"));if(0===e.length)return null;const t={};return t.items=e.map((_=>{const e=_.dataset.id||"";return _.dataset.selected&&(t.selected=e),[e,_.innerText]})),t.withArrow=!0,_.remove(),t}}},64500:(_,e,t)=>{"use strict";t.d(e,{CatalogController:()=>o});var i=t(951566);class o{constructor(_){this.sections={},this.root=_;const e=this.root.querySelector(".CatalogSection--header_section");e instanceof HTMLElement&&(this.headerSection=new i.SectionController(e,{})),this.tabs=Array.from(this.root.querySelectorAll("._audio_section_tab .ui_tab"))}setSection(_,e,t){this.sections[_]&&this.sections[_].getId()===t.sectionId?(this.currentSection=this.sections[_],this.enableSection(_)):(this.currentSection=new i.SectionController(e,t,this),this.sections[_]=this.currentSection)}disableSection(_){this.sections[_]&&this.sections[_].disable()}enableSection(_){this.sections[_]&&this.sections[_].enable()}emitEvent(_,e){Object.values(this.sections).forEach((t=>t.emitEvent(_,e)))}deleteSection(_){const e=this.sections[_];e&&(e.destroy(),delete this.sections[_])}destroy(){Object.entries(this.sections).forEach((([,_])=>{_.destroy()})),this.headerSection&&this.headerSection.destroy()}updateSectionReorder(){this.currentSection&&this.currentSection.updateReorder()}initBlocksManually(){this.currentSection=new i.SectionController(this.root,{nextFrom:"",isBlockPagination:!1,sectionId:"",name:""},this),this.currentSection.initBlocksManually()}}},325551:(_,e,t)=>{"use strict";t.d(e,{HighlightHint:()=>l});var i=t(332603),o=t(324676),s=t(743469),a=t(927766);class l extends o.Hint{constructor(_,e){super(i.HintType.Highlight,_),this.initialElement=e,this.options={highlight:!0,width:280,offset:[0,-17],scrollOffset:40,side:"bottom"},_.unskipable?this.options.ttOnHide=()=>{}:this.options.onBGClick=()=>this.hide()}show(){this.highlight=new s.default(this.initialElement,this.generateContent(),this.options),(0,a.disableBodyScroll)(),this.highlight.showTT()}hide(){this.highlight.hideTT(),(0,a.enableBodyScroll)(),super.hide()}}},324676:(_,e,t)=>{"use strict";t.d(e,{Hint:()=>a});var i=t(608021),o=t(152278),s=t(514191);class a{constructor(_,e){this.type=_,this.id=e.id,this.title=e.title,this.text=e.text,this.hintId=e.hintId,this.hideHash=e.hideHash,this.actions=e.actions,e.currentStep&&e.totalSteps&&(this.tutorialSteps={current:e.currentStep,total:e.totalSteps})}hide(){this.onHide&&this.onHide(),s.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:this.hintId,hash:this.hideHash})}generateContent(){let _=document.createElement("div");if(this.title&&(_.innerHTML+=`<div class="CatalogHint__title">${this.title}</div>`),this.text&&(_.innerHTML+=`<div class="CatalogHint__text">${this.text}</div>`),this.actions){const e=document.createElement("div");e.classList.add("CatalogHint__actions");let t=this.actions.map((_=>{const e=document.createElement("a");switch(e.classList.add("flat_button"),_.type){case"open_url":e.href=_.url,e.onclick=e=>{window.nav.go(_.url),this.hide(),(0,o.cancelEvent)(e)};break;case"switch_section":e.onclick=t=>{(0,o.cancelEvent)(t);window.currentAudioPage(e).catalogController.currentSection.switchSection(_.targetSectionId),this.hide()}}return e.innerHTML=_.label,e}));if(e.append(...t),this.tutorialSteps){const _=document.createElement("div");_.classList.add("CatalogHint__tutorialSteps"),_.innerHTML=(0,i.langStr)(i.getLang("audio_onboarding_tutorial_progress"),"step",this.tutorialSteps.current,"total_steps",this.tutorialSteps.total),e.append(_)}_.append(e)}return _}}},332603:(_,e,t)=>{"use strict";var i;t.d(e,{HintType:()=>i}),function(_){_.Tooltip="tooltip",_.Highlight="highlight"}(i||(i={}))},581359:(_,e,t)=>{"use strict";t.d(e,{TooltipHint:()=>a});var i=t(332603),o=t(324676),s=t(517920);class a extends o.Hint{constructor(_,e){let t=e,o="center",a="top";(e.classList.contains("CatalogBlock__layout--header")||e.classList.contains("CatalogBlock__layout--header_extended"))&&(t=e.querySelector(".CatalogBlock__title")||e,o="left"),e.classList.contains("MusicAuthor__follow_btn")&&(o="right",a="bottom"),super(i.HintType.Tooltip,_),this.initialElement=e;const l=Object.assign({force_side:a,align:o,offset_left:0,offset_top:0,width:"250px"},_);this.tooltip=new s.ElementTooltip(t,{content:this.title||this.text||"",cls:`feature_intro_tt ${this.id} CatalogTooltip`,forceSide:l.force_side,align:l.align,width:l.width,offset:[l.offset_left,l.offset_top],autoShow:!1,onHide:()=>this.hide()})}show(){this.tooltip.show()}}},303539:(_,e,t)=>{"use strict";t.d(e,{MusicAuthorController:()=>o});var i=t(912334);class o{constructor(_){this.blockContent=_,this.truncateName()}truncateName(){const _=this.blockContent.querySelector(".MusicAuthor_block__title");if(_ instanceof HTMLElement){(0,i.truncateMultilineText)(_);parseInt(getComputedStyle(_).lineHeight)===_.clientHeight&&_.classList.add("MusicAuthor_block__title--singleLine"),_.classList.remove("MusicAuthor_block__title--hidden")}}destroy(){}onDataLoad(){}}},951566:(_,e,t)=>{"use strict";t.d(e,{SectionController:()=>d});var i=t(43873),o=t(274642),s=t(99320),a=t(30284),l=t(350284),n=t(204900),r=t(325551);class d extends n.BaseController{constructor(_,e,t){super(),this.sectionData=e,this.catalogController=t,this.blocks=[],this.hintsToShow=[];const i=_.classList.contains(l.SECTION)?_:_.querySelector(`.${l.SECTION}`);i?(this.sectionEl=i,this.name=e.name,this.initTabsHints(),this.initBlocks(),this.nextFrom=void 0===this.sectionEl.dataset.next?e.nextFrom:this.sectionEl.dataset.next,this.id=e.sectionId,e.playlists&&e.playlists.length&&this.addPlaylists(e.playlists),e.playlist&&this.setPagePlaylist(e.playlist),this.isBlockPagination=this.sectionData.isBlockPagination,this.initSectionAutoList(),this.hideShowMoreLoaders(),this.sectionInited(),this.showHints()):this.sectionEl=_}showHints(){if(this.hintsToShow.length){let _;const e=this.hintsToShow.filter((_=>_ instanceof r.HighlightHint));e.length?(_=e[0],this.hintsToShow.splice(this.hintsToShow.indexOf(_),1),_.onHide=()=>this.showHints(),_.show()):this.hintsToShow.forEach((_=>_.show()))}}initBlocksManually(){this.initBlocks()}getSectionElement(){return this.sectionEl}enable(){this.initSectionAutoList(),this.blocks.forEach((_=>_.enable()))}disable(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks.forEach((_=>_.disable()))}emitEvent(_,e){this.blocks.forEach((t=>{e&&e!==t.getId()||t.emitEvent(_)}))}switchSection(_){var e;const t=null===(e=this.catalogController)||void 0===e?void 0:e.tabs;t&&t.forEach((e=>{e.dataset.sectionId===_&&e.click()}))}replaceBlocks(_,e,t){let i=!1;t&&this.addPlaylists(t),_.forEach((_=>{var e;const t=_.fromIds.map((_=>this.getBlockById(_))).filter((_=>null!==_));let o=null;if(t.length&&(null===(e=t[t.length-1])||void 0===e?void 0:e.block)&&(o=t[t.length-1].block),!o)return;const s=a.BlockController.createNodesFromItems(_.toBlocks);s.forEach((_=>null==o?void 0:o.insertAdjacentElement("beforebegin",_))),i=i||t.some((_=>_===this.paginatedBlockController)),t.forEach((_=>{_.block.remove(),_.destroy(),this.blocks=this.blocks.filter((e=>e!==_))}));const l=s.map((_=>new a.BlockController(this,_)));this.blocks.push(...l),this.hideShowMoreLoaders()})),"string"==typeof e&&this.setNextFrom(e),i&&(this.initPaginatedBlock(),e&&(this.isBlockPagination?this.initBlockAutoList([],this.nextFrom):this.sectionAutoList.isDone()&&this.initSectionAutoList()))}sectionInited(){this.blocks.forEach((_=>_.onSectionInit()))}initTabsHints(){var _;const e=null===(_=this.catalogController)||void 0===_?void 0:_.tabs;e&&e.forEach((_=>{if(_.dataset.catalogHintId){const e=this.getHintById(_.dataset.catalogHintId);if(e){const t=n.BaseController.getHint(_,e);t&&this.hintsToShow.push(t),delete _.dataset.catalogHintId}}}))}getHintById(_){return this.sectionData.hints&&this.sectionData.hints[_]||null}destroy(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks&&this.blocks.forEach((_=>_.destroy()))}getBlockById(_){return this.blocks&&this.blocks.find((e=>e.getId()===_))||null}reloadBlock(_){const e=this.findBlockByBlockName(_);e&&e.reloadData()}updateReorder(){this.blocks&&this.blocks.forEach((_=>{_.updateListReorder()}))}hideShowMoreLoaders(){this.blocks.forEach((_=>_.hideLoader()))}addPlaylists(_){_.forEach((_=>{_&&new i.AudioPlaylist(_)}))}setPagePlaylist(_){const e=window.currentAudioPage(this.sectionEl);let t=(0,o.getAudioPlayer)().getPlaylist(_.type,_.ownerId,_.id,"",_.blockId);t.mergeWith(_),t.getAudiosCount()||t.load(),e.setPagePlaylist(t)}setNextFrom(_){this.nextFrom=_,this.sectionEl&&(this.sectionEl.dataset.next=_)}initSectionAutoList(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.sectionAutoList=new s.default(this.sectionEl,{fetchImmediate:!1,onNeedRows:_=>{var e;if(this.isBlockPagination)return this.initBlockAutoList(),void _(null);this.nextFrom?(null===(e=this.paginatedBlockController)||void 0===e||e.showLoader(),this.fetchNext().then((({blocks:e,data:t,blockItems:i})=>{if(this.setNextFrom(t.nextFrom),t.isBlockPagination||t.blockIds&&1===t.blockIds.length&&this.getBlockById(t.blockIds[0])){if(_(null),this.isBlockPagination=this.isBlockPagination||t.isBlockPagination,this.initBlockAutoList(i,this.nextFrom),t.playlist&&"search"===t.playlist.type){(0,o.getAudioPlayer)().getPlaylist().sendSearchStats("search_view")}}else t.playlists&&this.addPlaylists(t.playlists),_(e||null),this.initBlocks()})).catch((()=>{}))):_(null)}})}initBlocks(){this.blocks=[];const _=[];[...this.sectionEl.getElementsByClassName(l.BLOCK_ELEMENT)].forEach((e=>{e.classList.contains(l.BLOCK_DIVIDED)?e.querySelectorAll(`.${l.BLOCK_CONTENT}`).forEach((e=>_.push(e))):_.push(e)})),this.blocks=_.map((_=>new a.BlockController(this,_))),this.initPaginatedBlock()}initPaginatedBlock(){const _=this.sectionEl.querySelector(`.${l.PAGINATED_BLOCKS_CONTAINER}`);if(_){const e=[..._.getElementsByClassName(l.BLOCK_CONTENT)],t=e[e.length-1].dataset.id;t&&(this.paginatedBlockController=this.getBlockById(t))}else this.paginatedBlockController=this.blocks[this.blocks.length-1]}initBlockAutoList(_=[],e){this.paginatedBlockController&&(void 0!==e&&this.paginatedBlockController.setNextFrom(e),this.paginatedBlockController.initAutoList(_))}findBlockByBlockName(_){return this.blocks.find((e=>e.hasBlockName(_)))}}},881771:(_,e,t)=>{"use strict";var i;t.d(e,{DataType:()=>i}),function(_){_.MusicAudios="music_audios",_.MusicPlaylists="music_playlists",_.MusicOwners="music_owners",_.RadioStations="radiostations"}(i||(i={}))},864809:(_,e,t)=>{"use strict";var i;t.d(e,{LayoutName:()=>i}),function(_){_.LargeSlider="large_slider",_.List="list"}(i||(i={}))},350284:(_,e,t)=>{"use strict";t.d(e,{SECTION:()=>i,PAGINATED_BLOCKS_CONTAINER:()=>o,BLOCK_ITEMS_CONTAINER:()=>s,BLOCK_ITEMS_REORDERABLE:()=>a,BLOCK_ELEMENT:()=>l,BLOCK_SEPARATOR:()=>n,BLOCK_DIVIDED:()=>r,AUTO_LIST_LOADER:()=>d,BLOCK_CONTENT:()=>u,SORTER_ACTION:()=>c,SORTER_ACTION_DATA:()=>h,GALLERY:()=>E,AUTOPLAY_HEADER_WRAPPER:()=>p,AUTOPLAY_CONTAINER:()=>P});const i="CatalogSection",o="CatalogSection__paginatedBlocks",s="CatalogBlock__itemsContainer",a="CatalogBlock__itemsContainer--reorderable",l="CatalogBlock",n="CatalogBlock--separator",r="CatalogBlock--divided",d="CatalogBlock__autoListLoader",u="CatalogBlock__content",c="CatalogBlock__sorter",h="CatalogBlock__sortingData",E="ui_gallery",p="Autoplay--header__wrapper",P="Autoplay--container"},905067:(_,e,t)=>{"use strict";t.d(e,{AutoplayBlock:()=>u});var i=t(570655),o=t(70162),s=t(937884),a=t(624715),l=t(819086),n=t(274642),r=t(350284),d=t(873589);class u{constructor(){this.autoplayQueue=(0,n.getAudioPlayer)().getPlaylistQueue().autoplayQueue,this.eventBus=(0,n.getAudioPlayer)().getPlaylistQueue().eventBus,this.audioListContainer=document.createElement("div"),this.onAutoplayTrackStart=_=>{const{autoplayQueue:e}=this,t=this.container.querySelector(".audio_page__audio_rows_list"),i=this.audioListContainer.querySelector(`.${r.AUTOPLAY_HEADER_WRAPPER}`),o=(0,a.audioTupleToAudioObject)(_),s=this.audioListContainer.querySelector(`[data-full-id="${null==o?void 0:o.fullId}"]`);if(!(t&&i&&s&&s.parentNode))return;let l=Array.from(s.parentNode.childNodes);if(!e.hasMore&&0===e.list.length)return t.append(...l.slice(1)),void i.remove();const n=i.offsetHeight,u=s.offsetHeight,c=l.indexOf(s);l=l.slice(1,c+1),requestAnimationFrame((()=>{(0,d.setStyle)(i,{transform:`translateY(${c*u}px)`,transition:"transform  0.5s ease"}),l.forEach((_=>{(0,d.setStyle)(_,{transition:"transform  0.5s ease",transform:`translateY(-${n+18}px)`})}));const _=()=>{(0,d.setStyle)(i,{transition:null,transform:null}),l.forEach((_=>{(0,d.setStyle)(_,{transition:null,transform:null})})),t.append(...l),i.removeEventListener("transitionend",_)};i.addEventListener("transitionend",_)}))},this.unsubscribeCallbacks=[],this.onNeedRows=()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{if(this.isPending)return;this.isPending=!0;const _=this.audioListContainer;if(_){const e=yield this.autoplayQueue.getNextAudios(this.offset);if(0===e.length&&!this.autoplayQueue.hasMore)return this.onNoMore();const t=e.map((_=>{const e=l.AudioUtils.drawAudio(_);e.trim();const t=document.createElement("div");return t.innerHTML=e,t.firstChild}));0!==t.length&&(_.append(...t),this.offset+=t.length),this.isPending=!1}}catch(_){this.isPending=!1,console.log(_)}}))}onNoMore(){this.uiScroll&&this.uiScroll.emitter.removeListener("more",this.onNeedRows)}init(_,e){if(this.container=_,(this.autoplayQueue.hasMore||0!==this.autoplayQueue.list.length)&&(this.audioListContainer.classList.add(r.BLOCK_ELEMENT,r.AUTOPLAY_CONTAINER),this.audioListContainer.innerHTML=`<div class="${r.AUTOPLAY_HEADER_WRAPPER}">\n            <div>\n                 <div class="${r.BLOCK_SEPARATOR}">\n                    <div class="${r.BLOCK_CONTENT} CatalogBlock__layout--in_block_separator"></div>\n                </div>\n            </div>\n            <div class="${r.BLOCK_CONTENT} CatalogBlock__layout--header_multiline" >\n                <h2 class="CatalogBlock__title">${o.getLang("audio_autoplay_title")}</h2>\n                <div class="CatalogBlock__subtitle">${o.getLang("audio_autoplay_subtitle")}</div>\n            </div>\n        </div>`,this.uiScroll=e,this.offset=0,this.isPending=!1,this.uiScroll)){this.container.append(this.audioListContainer),this.uiScroll.emitter.addListener("more",this.onNeedRows);const _=this.eventBus.subscribe(s.AudioPlayerEventType.PLAY_TRACK_FROM_AUTOPLAY,this.onAutoplayTrackStart);this.unsubscribeCallbacks.push(_.unsubscribe)}}destroy(){this.container&&(this.audioListContainer.remove(),this.unsubscribeCallbacks.forEach((_=>_())),this.unsubscribeCallbacks=[],this.uiScroll&&this.uiScroll.emitter.removeAllListeners())}}},651207:(_,e,t)=>{"use strict";t.d(e,{FullscreenBanner:()=>n});var i=t(514191),o=t(146143),s=t(571627),a=t(214547),l=t(740517);class n{constructor(_,e,t){this.sectionId=_,this.bannerId=e,this.productCollector=new a.ProductionStatCollector,this.viewCollector=new a.ViewStatCollector(this.productCollector),this.box=new o.MessageBox({bodyStyle:"padding: 0",width:655,containerClass:"FullscreenBanner",noControls:!0,onHide:()=>this.consume(s.ConsumeReason.Close)}),this.box.content(t),this.addEventListeners(),this.show()}static initiate(_){n.fetch(_).then((({banner:e,bannerId:t})=>e?new n(_,t,e):null)).catch((()=>null))}show(){this.box.show(),this.startView=this.productCollector.getCurrentTime()}hide(){this.box.hide(),this.sendViewStat()}sendViewStat(){const _={end_view:this.productCollector.getCurrentTime(),start_view:this.startView},e={type:l.EventItemType.AUDIO_FULLSCREEN_BANNER,id:this.bannerId,track_code:this.sectionId};this.viewCollector.logEvent(_,e)}static fetch(_){return new Promise(((e,t)=>{i.ajax.post("/audio?act=get_fullscreen_banner",{section_id:_},{onDone:_=>{(null==_?void 0:_.bannerId)?e(_):t()},onFail:()=>(t(),!0)})}))}addEventListeners(){const _=this.box.bodyNode.querySelector(".FullscreenBanner__closeButton");_&&_.addEventListener("click",this.close.bind(this));this.box.bodyNode.querySelectorAll(".FullscreenBanner__button").forEach((_=>{_.addEventListener("click",(()=>{this.consume(_.dataset.reason||s.ConsumeReason.Click),setTimeout((()=>this.hide()))}))}))}close(){this.consume(s.ConsumeReason.Close),this.hide()}consume(_){i.ajax.post("/al_audio.php?act=consume_banner",{id:this.bannerId,type:"fullscreen",track_code:this.sectionId,reason:_})}}},658651:(_,e,t)=>{"use strict";t.d(e,{AudioAdActionsModalApplication:()=>u});var i=t(785893),o=t(667294),s=t(100281),a=t(826867),l=t(99656),n=t(830169),r=t(335745),d=t(878774);function u({target:_,ad:e,onClosed:t}){const[u,c]=(0,o.useState)((()=>{const t=e.choices.map(r.mapChoiceToActionChoice);return t.length?(0,i.jsx)(s.DropdownActionSheet,Object.assign({shown:!0,onShownChange:_=>{_||c(null)},content:(0,i.jsx)(i.Fragment,{children:t.map((({label:_,action:e},t)=>(0,i.jsx)(a.DropdownActionSheetItem,Object.assign({autoClose:!0,onClick:e},{children:_}),t)))},void 0)},{children:(0,i.jsx)(d.ForwardElementRef,{element:_},void 0)}),void 0):null}));return(0,n.useUpdateEffect)((()=>{u||t()}),[u]),(0,i.jsx)(l.AppRootProvider,{children:u},void 0)}},590393:(_,e,t)=>{"use strict";t.d(e,{AudioAdActionsModalController:()=>a});var i=t(918311),o=t(658651);let s;class a{constructor(){this.initiator=(0,i.createReactInitiator)(o.AudioAdActionsModalApplication),this.handleClosed=()=>{this.unmount()}}static ensure(){return s||(s=new a),s}open(_,e){this.mount(_,e)}close(_){_&&_!==this.currentTarget||this.unmount()}isOpen(_){return(!_||_===this.currentTarget)&&this.initiator.isMounted()}unmount(){this.initiator.unmount(),this.currentTarget=null}mount(_,e){this.isOpen(_)||(this.currentTarget=_),this.initiator.render({target:_,ad:e,onClosed:this.handleClosed})}}},878774:(_,e,t)=>{"use strict";t.d(e,{ForwardElementRef:()=>i});const i=(0,t(667294).forwardRef)((function({element:_,getRootRef:e},t){return e&&o(e,_),o(t,_),null}));function o(_,e){_&&("function"==typeof _?_(e):_.current=e)}}}]);try{stManager.done("dist/db518e9c64536d311f4629724f55e979.5e7d97ae2cd758896f4e.js")}catch(_){}