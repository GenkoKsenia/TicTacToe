(self.webpackChunkvk=self.webpackChunkvk||[]).push([[40885],{816024:(e,t,i)=>{"use strict";i.d(t,{drawAlbumPartRow:()=>o});var a=i(70162);function o(e){return`<div class="audio_album_part_row">${a.getLang("audio_album_part").replace("{part}",e)}</div>`}},851887:(e,t,i)=>{"use strict";i.d(t,{getAlbumParts:()=>o});var a=i(722904);function o(e){if(e&&e.getAudiosCount()&&e.isFullyLoadable()&&!e.hasMore()){for(var t=e.getAudiosList(),i=e.getAudiosCount(),o=[],s=0,r=0;r<i;r++){var l=t[r][a.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_PART];l>s&&(s=l,o.push({number:l,offset:r}))}if(o.length>1)return o}return!1}},543688:(e,t,i)=>{"use strict";i.d(t,{showAudioAlbum:()=>r});var a=i(53721),o=i(819086),s=i(837565);function r(e,t){return cur.viewAsBox?cur.viewAsBox():(t=o.AudioUtils.audioTupleToAudioObject(t),layers.fullhide&&layers.fullhide(),(0,s.onAdditionalEvent)(e,t,{type:a.TYPE_SHOW_ALBUM}),o.AudioUtils.showAudioPlaylist(t.album[0],t.album[1],t.album[2]))}},642687:(e,t,i)=>{"use strict";i.d(t,{followArtist:()=>d});var a=i(897449),o=i(819086),s=i(70162),r=i(124041),l=i(501389);function d(e,t,i,d){(0,a.lockButton)(d),ajax.post("al_artist.php",{act:"follow",artist_id:e,ref:t,hash:i},{onFail:()=>(0,a.unlockButton)(d),onDone:i=>{(0,a.unlockButton)(d),r.FlatButton.setLabel(d,s.getLang("audio_following_artist_button")),d.classList.add("MusicAuthor__follow_btn__followed"),(0,l.showDoneBoxFull)("",{},{text:s.getLang("audio_follow_artist_success_notification_text"),title:s.getLang("audio_follow_artist_success_notification_title")}),d.onclick=a=>{a.preventDefault(),o.AudioUtils.unfollowArtist(e,t,i,d)}}})}},680353:(e,t,i)=>{"use strict";function a(e,t){ajax.post("al_artist.php",{act:"track_to_official",hash:e,url:t},{onFail:()=>!0})}i.d(t,{trackArtistToOfficial:()=>a})},972224:(e,t,i)=>{"use strict";i.d(t,{unfollowArtist:()=>d});var a=i(897449),o=i(819086),s=i(70162),r=i(873589),l=i(124041);function d(e,t,i,d){(0,a.lockButton)(d),ajax.post("al_artist.php",{act:"unfollow",artist_id:e,ref:t,hash:i},{onFail:()=>(0,a.unlockButton)(d),onDone:i=>{d&&((0,a.unlockButton)(d),(0,r.hasClass)(d,"MusicAuthor__follow_btn__can_follow")?(l.FlatButton.setLabel(d,s.getLang("audio_follow_artist_button")),d.classList.remove("MusicAuthor__follow_btn__followed"),d.onclick=a=>{a.preventDefault(),o.AudioUtils.followArtist(e,t,i,d)}):(0,r.re)(d))}})}},273712:(e,t,i)=>{"use strict";i.d(t,{getRowActionName:()=>s});var a=i(70162),o=i(819086);function s(e,t,i){var s,r=o.AudioUtils.getAddRestoreInfo();switch(e){case"current_delete":s=a.getLang("audio_delete_from_current");break;case"recoms_delete":s=a.getLang("audio_dont_show");break;case"listened_delete":s=a.getLang("audio_remove_from_list");break;case"delete":if(o.AudioUtils.isPodcast(t))s=a.getLang("audio_podcast_delete_episode");else if(window.AudioPage&&window.AudioPage.isInRecentPlayed(i))s=a.getLang("audio_remove_from_list");else{var l=r[t.fullId];s=l&&l.deleteAll?l.deleteAll.text:a.getLang("global_delete_audio")}break;case"restore_recoms":s=a.getLang("audio_restore_audio");break;case"more":s=a.getLang("global_media_selector_more");break;case"add":var d=r[t.fullId];if(d&&r[d.addedFullId]&&(d=null),o.AudioUtils.isPodcast(t))s=a.getLang("audio_podcast_restore_episode");else if(d&&"deleted"==d.state)s=a.getLang("audio_restore_audio");else if(d&&"added"==d.state)s=a.getLang("global_delete_audio");else{var n=!!window.AudioPage&&currentAudioPage(i);s=n&&n.getOwnerId()<0&&n.canAddToGroup()&&n.getOwnerId()!==t.ownerId?a.getLang("audio_add_to_group"):a.getLang("audio_add_to_audio")}break;case"edit":s=o.AudioUtils.isPodcast(t)?a.getLang("audio_podcast_edit_episode"):a.getLang("audio_edit_audio");break;case"next":s=a.getLang("audio_set_next_audio");break;case"recoms":s=a.getLang("audio_show_recommendations");break;case"fave":s=o.AudioUtils.isPodcast(t)?a.getLang("audio_podcast_listen_later"):"";break;case"lyrics":s=a.getLang("audio_show_lyrics");break;default:s=""}return s}},365506:(e,t,i)=>{"use strict";i.d(t,{hasAudioHQBodyClass:()=>o});var a=i(722904);function o(){return document.body.classList.contains(a.AUDIO_PLAYER_ENUMS.AUDIO_HQ_LABEL_CLS)}},677060:(e,t,i)=>{"use strict";i.d(t,{renderAudioDiag:()=>r});var a=i(873589),o=i(342269),s=i(722904);function r(){var e=(0,a.ge)("audio_diag_log"),t=ls.get(s.AUDIO_PLAYER_ENUMS.LOG_LS_KEY)||[];e&&(0,o.each)(t,(function(t,i){var o=new Date(i.shift()).toUTCString();i=i.join(", "),e.appendChild((0,a.se)('<div class="audio_diag_log_row"><span class="audio_diag_log_time">'+o+"</span>"+i+"</div>"))}))}},989191:(e,t,i)=>{"use strict";i.d(t,{toggleAudioHQBodyClass:()=>o});var a=i(722904);function o(){var e=AudioPlayer.showHQLabel();document.body.classList.toggle(a.AUDIO_PLAYER_ENUMS.AUDIO_HQ_LABEL_CLS,e)}},156453:(e,t,i)=>{"use strict";i.d(t,{updateQueueReceivedPost:()=>s});var a=i(873589),o=i(342269);function s(e){e&&(0,o.each)((0,a.geByClass)("_audio_row",e),(function(){(0,a.domData)(this,"new-post","groups"==cur.module?"wall":"feed")}))}},43873:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{AudioPlaylist:()=>AudioPlaylist});var _shared_lib_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(733164),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(501389),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(342269),_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(819086),_playlist_loadAllPlaylistAudios__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(175345),_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(315720),_web_audio_FetchService__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(414325);class AudioPlaylist{static splitId(e){var t=e.split("_"),i=t[0],a=t[1],o=t.slice(2);return[i,a,o=o.join("_")]}static getFullIdFromData(e){var t=e||{},i=t.ownerId,a=t.id,o=t.albumId,s=t.accessHash;return`${i||vk.id}_${a||o||0}${s?"_"+s:""}`}constructor(e,t,i){var a={};if(e&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isFunction)(e.getId))return e.isReference()?(window.getAudioPlayer().addPlaylist(this),e):(this._ref=e,void window.getAudioPlayer().addPlaylist(this));(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isObject)(e)?a=e:(a.ownerId=t,a.type=e,a.albumId=i||++AudioPlaylist.plIndex),this._type=a.type,this._ownerId=a.ownerId||vk.id,this._albumId=a.albumId||0,this._fromId=a.fromId||0,this._list=[],this._context=a.context||"",this._blockId=a.blockId,this._isFakeId=!1,this._expire=a.expire||null,this._noDiscover=a.hasOwnProperty("noDiscover")?a.noDiscover:null,this._nextOffset=a.nextOffset,this._forceReload=!1,this._fetchService=new _web_audio_FetchService__WEBPACK_IMPORTED_MODULE_6__.FetchService,this._noConsecutivePlay=!1,this.mergeWith(a),window.getAudioPlayer().addPlaylist(this)}updatePlaylist(e){var t=this.getSelf(),i=!1;return t&&e?(t._title!==e.title&&(t._title=e.title,i=!0),t._titleLang!==e.titleLang&&(t._titleLang=e.titleLang,i=!0),i):i}_ensureIndex(e){var t=this.getSelf();if(t._index)e&&e();else{var i=t.getAudiosList();if(i){var a=(e,t)=>{var i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.intval)(t);return i>=33&&i<48?String.fromCharCode(i):e};t._index=new _web_indexer_indexer__WEBPACK_IMPORTED_MODULE_5__.vkIndexer(i,(e=>(e[_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]+" "+e[_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]).replace(/\&\#(\d+);?/gi,a)),e)}}}cleanIndex(){this.getSelf()._index=null}search(e,t){var i=this.getSelf();(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isObject)(e)||(e={q:e}),this._ensureIndex((()=>{var a=i._index?i._index.search(e.q):[];return a=a.filter((function(t){return!e.lyrics||""!==t[_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_LYRICS]})),t(a)}))}setNextOffset(e){this._nextOffset=e}getNextOffset(){var e=this.getSelf();return e._forceReload?0:""===e._nextOffset?e._nextOffset:e._nextOffset||this.getAudiosCount()}getIsFakeId(){return this.getSelf()._isFakeId}setIsFakeId(e){this.getSelf()._isFakeId=e}getId(){return this.getType()+"_"+this.getOwnerId()+"_"+this.getAlbumId()}getFullId(){return this.getOwnerId()+"_"+this.getAlbumId()+(this.getAccessHash()?"_"+this.getAccessHash():"")}isReference(){return!!this._ref}getSelf(){return this._ref&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isObject)(this._ref)?this._ref:this}getType(){return this.getSelf()._type}getExpire(){return this.getSelf()._expire}getOwnerId(){return+this.getSelf()._ownerId}getAlbumId(){return this.getSelf()._albumId}getPlaylistId(){return this.getSelf()._albumId}getNoConsecutivePlay(){return this.getSelf()._noConsecutivePlay}getOriginalPlaylistRawId(){return this.getSelf()._originalPlaylistRawId}getFollowHash(){return this.getSelf()._followHash}getContext(){return this.getSelf()._context}setContext(e){this.getSelf()._context=e}getRef(){return this.getSelf()._ref}getRawId(){return this.getSelf()._implPlay_rawId}getGridCovers(){return this.getSelf()._gridCovers||""}getTitle(){return this.getSelf()._title||""}getTitleLang(){return null==this.getSelf()._titleLang?null:this.getSelf()._titleLang}getSubtitle(){return this.getSelf()._subTitle||""}getDescription(){return this.getSelf()._description||""}getRawDescription(){return this.getSelf()._rawDescription||""}getAccessHash(){return this.getSelf()._accessHash||""}getFromId(){return this.getSelf()._fromId||0}setFromId(e){this.getSelf()._fromId=e}getAuthorLine(){return this.getSelf()._authorLine||""}getAuthorHref(){return this.getSelf()._authorHref||""}getAuthorName(){return this.getSelf()._authorName||""}getInfoLine1(){return this.getSelf()._infoLine1||""}getInfoLine2(){return this.getSelf()._infoLine2||""}getListens(){return this.getSelf()._listens||0}getAddClasses(){return this.getSelf()._addClasses||""}getLastUpdated(){return this.getSelf()._lastUpdated||""}getEditHash(){return this.getSelf()._editHash||""}getDeleteHash(){return this.getSelf()._deleteHash||""}getReplaceHash(){return this.getSelf()._replaceHash||""}getCoverUrl(){return this.getSelf()._coverUrl||""}getBlocks(){return this.getSelf()._blocks||{}}getSearchParams(){return this.getSelf()._searchParams||null}getSearchQid(){return this.getSelf()._searchQid||null}getLocalFoundCount(){return this.getSelf()._localFoundTotal||0}getTotalCount(){return this.getSelf()._totalCount}getTotalCountHash(){return this.getSelf()._totalCountHash}getFriendId(){return this.getSelf()._friend}getNoDiscover(){return this.getSelf()._noDiscover}getAudiosList(){return this.getSelf()._list}getPostId(){return this.getSelf()._postId}getWallQuery(){return this.getSelf()._wallQuery}getWallType(){return this.getSelf()._wallType}getCommunititesBlock(){return this.getSelf()._communitiesBlock}getArtistsBlock(){return this.getSelf()._artistsBlock}getPlaylistsBlock(){return this.getSelf()._playlistsBlock}getLiveInfo(){var e=this.getSelf()._live;return!!e&&{hostId:(e=e.split(","))[0],audioId:e[1],hash:e[2]}}getAudiosCount(){var e=this.getSelf();return Array.isArray(e._list)?e._list.length:0}getTotalDuration(){var e=this.getAudiosList(),t=0;return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.each)(e,(function(e,i){t+=i[_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_DURATION]})),t}getAudio(e){if(!e)return null;var t=this.getSelf();"string"==typeof e&&(e=e.split("_"));for(var i=0,a=t._list.length;i<a;i++)if(e[0]==t._list[i][_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]&&e[1]==t._list[i][_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_ID])return t._list[i];return null}getAudioAt(e){var t=this.getSelf();return e<t._list.length?t._list[e]:null}setLocalFoundCount(e){this.getSelf()._localFoundTotal=e}setAdsAllowed(e){return this.getSelf()._isAdsAllowed=e}setFollowed(e){var t=this.getAddClasses()||"";return t=t.replace("audio_playlist__followed",""),e&&(t+=" audio_playlist__followed"),this.getSelf()._addClasses=t,this.getSelf()._isFollowed=e}isBlocked(){return!!this.getSelf()._isBlocked}hasMore(){return!!this.getSelf()._hasMore}isOfficial(){return!!this.getSelf()._isOfficial}isFollowed(){return this.getSelf()._isFollowed}isAdsAllowed(){return!!this.getSelf()._isAdsAllowed}getForceReload(){return this.getSelf()._forceReload}isFullyLoadable(){return this.getType()===AudioPlaylist.TYPE_PLAYLIST}isLive(){return!!this.getLiveInfo()}getFeedOffset(){return this._feedOffset}getFeedFrom(){return this._feedFrom}_unref(){var e=this._ref;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isObject)(e)){var t={};for(var i in e)if(e.hasOwnProperty(i)&&!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isFunction)(e[i])&&0===i.indexOf("_")){var a=e[i];t[i.substr(1)]=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isObject)(a)?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.clone)(a):a}t.hasMore=!1,delete this._ref,this._type=AudioPlaylist.TYPE_TEMP,this._albumId=t.albumId,this._list=[],this._fetchService=t.fetchService,this.mergeWith(t)}}equals(e){return this.getSelf()===e.getSelf()}serialize(){return JSON.stringify(this.asObject())}indexOfAudio(e){if(!e)return-1;var t=[];(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isString)(e)?t=e.split("_"):(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isObject)(e)?t=[e.ownerId,e.id]:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isArray)(e)&&(t=[e[_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID],e[_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_ID]]);var i=this.getAudiosList();if(!i)return-1;for(var a=0,o=i.length;a<o;a++)if(i[a]&&t[0]==i[a][_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]&&t[1]==i[a][_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_ID])return a;return-1}asObject(){var e={};return e.type=this.getType()||AudioPlaylist.TYPE_TEMP,e.ownerId=this.getOwnerId(),e.albumId=this.getAlbumId(),e.accessHash=this.getAccessHash(),e.hasMore=this.hasMore(),e.nextOffset=this.getNextOffset(),e.title=this.getTitle(),e.titleLang=this.getTitleLang(),e.context=window.getAudioPlayer()._getPlayingContext(),e.originalPlaylistRawId=this.getOriginalPlaylistRawId(),e.expire=this.getExpire?this.getExpire():null,e.blockId=this.getBlockId(),this.getType()===AudioPlaylist.TYPE_PLAYLIST&&this.getAlbumId()>0&&(e.originalPlaylistRawId=this.getOwnerId()+"_"+this.getAlbumId()+"_"+this.getAccessHash()),this.getType()===AudioPlaylist.TYPE_RADIO&&(e.list=this.getAudiosList()),e}asPlaylistData(){return{type:this.getType(),ownerId:this.getOwnerId(),id:this.getId(),title:this.getTitle(),hasMore:this.hasMore(),list:this.getAudiosList(),nextOffset:this.getNextOffset(),subtitle:this.getSubtitle(),totalCount:this.getTotalCount(),blockId:this.getBlockId()}}toString(){return this.getId()}clean(e){e||this._unref();var t=this.getSelf();t._hasMore=!0,t._list=[],t._feedOffset=t._feedFrom=0,t._nextOffset=0}initSortedList(e){return this.getSelf()._list=e||[]}setForceReload(e){var t=this.getSelf();return e&&(t._hasMore=!0),t._forceReload=e}getBlockId(){return this.getSelf()._blockId}getAudioIds(e){return this.getSelf()._fetchService.getAudioIdsBySource({playlist_id:this.getFullId(),block_id:this.getBlockId(),trackType:e,context:this.getContext()})}loadAll(e,t){if(void 0===t&&(t=""),!this.isFullyLoadable())return e&&e(this);this.load(0,e,!0,"default",t)}loadByBlockId(e,t,i,a){var o=this;void 0===a&&(a="default");var s=function(e,t){void 0===t&&(t=null);var i=o._onDoneLoading;delete o._onDoneLoading,delete o._loadingAll,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.each)(i||[],((e,i)=>{i&&i(o,t)}))},r=this.getNextOffset();return!this.getAudiosCount()||e&&e===r?(this._onDoneLoading=this._onDoneLoading||[],this._onDoneLoading.push(t),this._loadingAll?void 0:i?(this._loadingAll=!0,void(0,_playlist_loadAllPlaylistAudios__WEBPACK_IMPORTED_MODULE_4__.loadAllPlaylistAudios)(this,s)):void ajax.post("al_audio.php?act=load_block_playlist",{block_id:this._blockId,start_from:r},{onDone:e=>{this._blockId=e.blockId;var t=window.getAudioPlayer();t.mergePlaylistData(this,e),s(),t.saveStateCurrentPlaylist(),""===this.getNextOffset()&&(clearTimeout(this._sendSearchStatsTimeout),this._sendSearchStatsTimeout=setTimeout(this.sendSearchStats.bind(this,"search_view"),3e3),this._searchPlayStatsSent=!1)}})):t&&t(this)}load(offset,_onDone,needAll,trackType,viewType){void 0===trackType&&(trackType="default"),void 0===viewType&&(viewType=null),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isFunction)(offset)?(_onDone=offset,offset=0):offset=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.intval)(offset),this.getSelf().isExpired()&&(this.getSelf()._hasMore=!0,this.getSelf().setForceReload(!0));var searchParams=this.getSearchParams(),wasPreload=!1,countAvailable=this.getType()===this.getAudiosCount(),isGoingToLoadAll=this.isFullyLoadable()&&needAll&&this.hasMore(),callOnDones=(e,t,i)=>{var a=this._onDoneLoading;i||(delete this._onDoneLoading,delete this._loadingAll),(!wasPreload||wasPreload&&cur.audioChooseBox&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_1__.curBox)())&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.each)(a||[],((i,a)=>{a&&a(e,t)})),i&&(wasPreload=!0)},params;if(this.getSelf().getForceReload()&&(offset<countAvailable&&!isGoingToLoadAll||""===this.getNextOffset()||!this.hasMore()||searchParams&&this.getType()===AudioPlaylist.TYPE_SEARCH&&!searchParams.globalQuery))return _onDone&&_onDone(this);if(this._onDoneLoading=this._onDoneLoading||[],this._onDoneLoading.push(_onDone),this._loadingAll)return _onDone&&_onDone(this);if(needAll)return this._loadingAll=!0,void(0,_playlist_loadAllPlaylistAudios__WEBPACK_IMPORTED_MODULE_4__.loadAllPlaylistAudios)(this,callOnDones,viewType);offset=this.getNextOffset(),offset===this.getLocalFoundCount()&&(offset-=this.getLocalFoundCount()),offset||clearTimeout(this._sendSearchStatsTimeout),this.getSelf().getForceReload()&&this.getSelf().setForceReload(!1);var isCatalog=!1;if(this._blockId)params={act:"load_block_playlist",block_id:this._blockId,start_from:this.getNextOffset()},isCatalog=!0;else{var ownerId=cur.audioPage&&this.getType()===AudioPlaylist.TYPE_SEARCH?cur.audioPage.getOwnerId():this.getOwnerId();params={act:"load_section",type:this.getType(),owner_id:ownerId,playlist_id:this.getPlaylistId(),offset,context:this.getContext(),access_hash:this.getAccessHash(),search_q:searchParams?searchParams.globalQuery:null,search_performer:searchParams?searchParams.performer:null,search_lyrics:searchParams?searchParams.lyrics:null,search_sort:searchParams?searchParams.sort:null,search_history:searchParams?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.intval)(searchParams.fromHistory):null,search_qid:this.getSearchQid(),feed_from:this.getFeedFrom(),feed_offset:this.getFeedOffset(),post_id:this.getPostId(),wall_query:this.getWallQuery(),wall_type:this.getWallType(),claim:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.intval)(nav.objLoc.claim),track_type:trackType}}return ajax.post("al_audio.php",params,{onDone:(loadedPlaylist,tpl,langs,templatesScript,data)=>{if(!loadedPlaylist)return this.getSelf().setNextOffset(""),void(isCatalog?_onDone&&_onDone(loadedPlaylist):callOnDones(loadedPlaylist));if(window.addTemplates({audio_playlist_snippet:tpl}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.extend)(cur.lang,langs),templatesScript&&eval(templatesScript),!this._loadingAll||needAll){var audioPlayer=window.getAudioPlayer();audioPlayer.mergePlaylistData(this,loadedPlaylist),isCatalog?_onDone&&_onDone(loadedPlaylist.list):callOnDones(loadedPlaylist),audioPlayer.saveStateCurrentPlaylist(),offset&&""!==loadedPlaylist.nextOffset||(clearTimeout(this._sendSearchStatsTimeout),this._sendSearchStatsTimeout=setTimeout(this.sendSearchStats.bind(this,"search_view"),3e3),this._searchPlayStatsSent=!1)}},onFail:()=>!0,cache:this.getType()===AudioPlaylist.TYPE_SEARCH?1:0})}isExpired(){var e=this.getExpire();return!!e&&new Date(1e3*e).getTime()<(new Date).getTime()}mergeInfo(e){this._albumId=e.id||this._albumId;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.each)(["accessHash","addClasses","artistsBlock","authorLine","authorHref","authorName","communitiesBlock","coverUrl","description","gridCovers","editHash","feedFrom","feedOffset","followHash","hasMore","infoLine1","infoLine2","isAdsAllowed","isFollowed","isOfficial","isBlocked","lastUpdated","listens","live","nextOffset","noConsecutivePlay","originalList","ownerId","playlistsBlock","postId","rawId","rawDescription","searchQid","searchParams","subTitle","title","titleLang","noDiscover","totalCount","totalCountHash","type","wallQuery","wallType","expire"],((t,i)=>{void 0!==e[i]&&(this["_"+i]=e[i])}))}mergeWith(e){var t=e.list;this.isExpired()&&(this.getSelf()._list=[]),t&&t.length&&(this.getType()===AudioPlaylist.TYPE_RADIO?this.pushAudio(t,0):this.pushAudio(t)),this.mergeInfo(e)}pushAudio(e,t){this._unref();var i=void 0===t,a=e=>{for(var a=this.getAudiosList(),o=[],s=0;s<e.length;s++){var r=e[s],l=this.indexOfAudio(r);l<0?o.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.clone)(r)):i||(o.push((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.clone)(r)),a.splice(l,1),l<t&&t--)}for(var d=0,n=o;d<n.length;d++){var u=n[d];u[_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.clean)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.replaceEntities)(u[_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]).replace(/(<em>|<\/em>)/g,"")),u[_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_2__.clean)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.replaceEntities)(u[_utils__WEBPACK_IMPORTED_MODULE_3__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]).replace(/(<em>|<\/em>)/g,""))}i?a.push(...o):a.splice(t,0,...o),this._index&&o.forEach((e=>this._index.add(e)))};(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isArray)(e)&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_0__.isArray)(e[0])?a(e):e&&e.length&&a([e])}moveAudio(e,t){this._unref();var i=this._list.splice(e,1);e<t&&(t-=1),this._list.splice(t,0,i[0])}removeAudio(e){var t=this.indexOfAudio(e);if(t>=0){var i;this._unref();var a=this._list.splice(t,1);return null==(i=this._index)||i.remove(a[0]),window.getAudioPlayer().saveStateCurrentPlaylist(),t}return-1}sendSearchStats(e){if("search_play"===e){if(this._searchPlayStatsSent)return;this._searchPlayStatsSent=!0}ajax.post("al_audio.php?act=search_stats",{event_type:e,search_type:this.getSearchQid()?"external":"internal",search_params:JSON.stringify(this.getSearchParams()),results_count:this.getTotalCount()})}fetchNextLiveAudio(e){var t=this.getLiveInfo();ajax.post("al_audio.php",{act:"a_get_audio_status",host_id:t.hostId,hash:t.hash},{onDone:t=>e&&e(t),onFail:()=>!0})}}AudioPlaylist.plIndex=0,AudioPlaylist.TYPE_CURRENT="current",AudioPlaylist.TYPE_PLAYLIST="playlist",AudioPlaylist.TYPE_MY="my",AudioPlaylist.TYPE_ALBUM="album",AudioPlaylist.TYPE_TEMP="temp",AudioPlaylist.TYPE_RECOM="recoms",AudioPlaylist.TYPE_SEARCH="search",AudioPlaylist.TYPE_LIVE="live",AudioPlaylist.TYPE_WALL="wall",AudioPlaylist.TYPE_RECENT="recent",AudioPlaylist.TYPE_RADIO="radio",AudioPlaylist.TYPE_ARTICLE_TTS="article_tts",AudioPlaylist.DEFAULT_PLAYLIST_ID=-1,AudioPlaylist.RADIO_PLAYLIST_ID=-110},183945:(e,t,i)=>{"use strict";i.d(t,{TopAudioPlayer:()=>h});var a=i(819086),o=i(840060),s=i(274642),r=i(70162),l=i(152278),d=i(342269),n=i(873589),u=i(937884),_=i(254820),c=i(794699),p="top_audio_player_enabled";class h{constructor(e){this.ap=(0,s.getAudioPlayer)(),this._el=e,this._playIconBtn=(0,n.ge)("top_audio"),this._audioBtnGroup=(0,n.ge)("top_audio_btn_group"),this.init()}static init(){var e=(0,n.ge)("top_audio_player"),t=(0,n.data)(e,"object");t||(t=new h(e),(0,n.data)(e,"object",t))}init(){var e=this;function t(t){return(0,n.hasClass)(this,"top_audio_player_play")?(e.ap.podcastSetActionRef(e.ap.getCurrentAudio(),e.ap.isPlaying()?a.AudioUtils.PodcastsLogs.ACTION_PAUSE:a.AudioUtils.PodcastsLogs.ACTION_PLAY,"top_player"),e.ap.isPlaying()?e.ap.pause():e.ap.play(),!1):(0,n.hasClass)(this,"top_audio_player_prev")?(e.ap.playPrev(),!1):(0,n.hasClass)(this,"top_audio_player_next")?(e.ap.playNext(),!1):void 0}this.ap.on(this,u.events.UPDATE,this.onUpdate.bind(this)),this.ap.on(this,u.events.PLAY,this.onPlay.bind(this)),this.ap.on(this,u.events.PLAY_REQUESTED,this.onPlay.bind(this)),this.ap.on(this,[u.events.PAUSE,u.events.STOP],this.onPause.bind(this)),this.ap.top=this,(0,d.each)(["prev","play","next"],(function(i,a){(0,l.addEvent)((0,n.geByClass1)("top_audio_player_"+a,e._el),"click",t)})),(0,l.addEvent)(this._el,"mousedown",(function(t){if(!(0,n.gpeByClass)("top_audio_player_btn",t.target,e._el))return 1!=t.which||(0,n.hasClass)(t.target,"top_audio_player_btn")||(0,n.hasClass)(t.target,"top_audio_player_act_icon")||a.AudioUtils.getLayer().toggle(),(0,l.cancelEvent)(t)})),(0,l.addEvent)((0,n.ge)("top_audio"),"mousedown",(function(e){return!0!==(0,l.checkEvent)(e)&&(a.AudioUtils.getLayer().toggle(),(0,l.cancelEvent)(e))})),o.browser.safari||(0,l.addEvent)(document,"keydown keyup",(function(e){(0,n.toggleClass)((0,n.ge)("top_audio_play"),"shuffle",e.shiftKey)})),this._resetAudio(),this._updateTitle(this.ap.getCurrentAudio())}onPause(){this._el&&((0,n.removeClass)(this._el,"top_audio_player_playing"),this._el.querySelector(".top_audio_player_play svg").outerHTML=(0,_.getIcon24Play)().icon);var e=(0,n.geByClass1)("_top_audio_player_play_blind_label");e&&(e.innerHTML=r.getLang("global_audio_play"))}onPlay(e,t,i){this._hideButton(),requestAnimationFrame((function(){var e=a.AudioUtils.getLayer();e&&e.isShown()&&e.updatePosition()})),(0,n.addClass)(this._el,p),(0,n.toggleClass)(this._el,"top_audio_player_playing",!0),this._el.querySelector(".top_audio_player_play svg").outerHTML=(0,c.getIcon24Pause)().icon;var o=(0,n.geByClass1)("_top_audio_player_play_blind_label");o&&(o.innerHTML=this.ap.isPlaying()?r.getLang("global_audio_pause"):r.getLang("global_audio_play")),this._updateTitle(e,i)}onUpdate(e){e?(this._updateTitle(e),this._hideButton(),(0,n.addClass)(this._el,p)):this._resetAudio()}_updateTitle(e,t){if(t=(0,d.intval)(t),e=a.AudioUtils.audioTupleToAudioObject(e),(0,n.toggleClass)(this._el,"audio_player_podcast",a.AudioUtils.isPodcast(e)),(0,n.toggleClass)(this._el,"audio_player_article_tts",a.AudioUtils.isArticleTts(e)),(0,n.toggleClass)(this._el,"audio_player_external_stream_audio",a.AudioUtils.isExternalStream(e)),e){void 0!==this._currTitleReTO&&clearTimeout(this._currTitleReTO);var i=(0,n.geByClass1)("top_audio_player_title_out",this._el);(0,n.re)(i);var o=(0,n.geByClass1)("top_audio_player_title",this._el);if(0!==t){var s=t<0?-10:10,r=`opacity: 0; top: ${s}px; left: ${o.offsetLeft}px`,l=this.getTitleText(e),u=(0,n.se)('<div class="top_audio_player_title top_audio_player_title_next" style="'+r+'">'+l+"</div>");u.setAttribute("onmouseover","setTitle(this)"),t>0?(0,n.domInsertAfter)(u,o):(0,n.domInsertBefore)(u,o),(0,n.addClass)(o,"top_audio_player_title_out"),(0,n.setStyle)(o,{top:-s,opacity:0}),setTimeout((function(){(0,n.setStyle)(u,{top:0,opacity:1})}),10),clearTimeout(this._currTitleReTO),this._currTitleReTO=setTimeout((function(){(0,n.re)(o),(0,n.removeClass)(u,"top_audio_player_title_next")}),h.TITLE_CHANGE_ANIM_SPEED)}else o&&(o.innerHTML=this.getTitleText(e),o.titleSet=0,o.setAttribute("onmouseover","setTitle(this)"))}}getTitleText(e){return[e.performer,e.title].filter((e=>!!e)).join(" &mdash; ")}_resetAudio(){(0,n.removeClass)(this._playIconBtn,p),(0,n.removeClass)(this._el,p),(0,n.removeClass)(this._el,"top_audio_player_playing"),(0,n.removeClass)(this._el,"audio_player_podcast"),(0,n.removeClass)(this._el,"audio_player_article_tts"),(0,n.removeClass)(this._el,"audio_player_external_stream_audio"),(0,n.show)(this._audioBtnGroup);var e=a.AudioUtils.getLayer();e&&e.isShown()&&e.updatePosition()}_hideButton(){(0,n.hide)(this._audioBtnGroup),(0,n.hasClass)(this._playIconBtn,p)||(0,n.addClass)(this._playIconBtn,p)}}h.TITLE_CHANGE_ANIM_SPEED=190},51488:(e,t,i)=>{"use strict";i.d(t,{WebPlayerAdapter:()=>d});var a=i(226126),o=i(342269),s=i(819086),r=i(873589),l=i(624715);class d extends a.AudioStatsPlayerAdapter{getPausedBy(e){var t=this.player,i=t.pausedByVideo,a=t.pausedByStories,o=t.pausedByAudio,s=t.pausedByQueue;return i&&e<i||window.Videoview&&Videoview.isLayerShown()?"video":a&&e<a||window.cur&&cur.storyLayer?"stories":o&&e<o?"audio":s&&e<s?"queue":null}getState(){var e=super.getState(),t=this.getAudioId();if(t){var i=(0,r.geByClass)("_audio_row_"+t+" audio_row__current",(0,r.ge)("page_layout"));if(i&&i.length)return a.FULL_SCREEN_STATE}return e}getAudio(){return(0,l.audioTupleToAudioObject)(this.player.getCurrentAudio())}getProgress(){return this.player.getCurrentProgress()}getProgressInSeconds(){var e=this.player.getCurrentAudio();return e?Math.round(this.player.getCurrentProgress()*e[s.AudioUtils.AUDIO_ITEM_INDEX_DURATION]):0}getVolume(){return Math.round(100*(e=this.player.getVolume(),Math.log(1+34*e)/Math.log(35)));var e}getAudioId(){var e=this.player.getCurrentAudio();if(e)return e[s.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+e[s.AudioUtils.AUDIO_ITEM_INDEX_ID]}getAudioTrackCode(){var e=this.player.getCurrentAudio();if(e)return e[s.AudioUtils.AUDIO_ITEM_INDEX_TRACK_CODE]}getPrevAudioId(){var e=this.player._prevAudio;if(e)return e[s.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+e[s.AudioUtils.AUDIO_ITEM_INDEX_ID]}getPrevPlaylistId(){var e=this.player._prevPlaylist;return e&&!e.getIsFakeId()?e.getFullId():null}getPlaylistId(){var e=this.player.getCurrentPlaylist();return e&&!e.getIsFakeId()?e.getFullId():null}getContext(){return this.player._getPlayingContext()}getSequence(){return this.player._seq}getType(){if(this.player._impl)return this.player._impl.type}getSearchParams(){var e=this.player.getCurrentPlaylist();if(e)return e.getSearchParams()}isShuffledPlaylist(){var e=this.player.getPlaylistQueue();if(e)return e.shuffled}isRealPlaylist(){var e=this.player.getCurrentPlaylist();return!!e&&e.getType()===AudioPlaylist.TYPE_PLAYLIST}isRealPrevPlaylist(){var e=this.player._prevPlaylist;return!!e&&e.getType()===AudioPlaylist.TYPE_PLAYLIST}isPodcast(){var e=this.player.getCurrentAudio();return s.AudioUtils.isPodcast(e)}isExternalStream(){var e=this.player.getCurrentAudio();return s.AudioUtils.isExternalStream(e)}isRadio(){var e=this.player.getCurrentAudio();return s.AudioUtils.isRadio(e)}isMarusiaTrack(){var e=this.player.getCurrentAudio();return s.AudioUtils.isMarusiaTrack(e)}isLastTrack(){var e=this.player.getCurrentAudio(),t=this.player.getCurrentPlaylist();return!!e&&(!(!e||t)||t.indexOfAudio(e)+1===t.getAudiosCount())}getTrackPosition(){var e=this.player.getCurrentAudio(),t=this.player.getCurrentPlaylist();return e?e&&!t?0:t.indexOfAudio(e):null}hasPlaylist(){return Boolean(this.player.getCurrentPlaylist())}hasSearchParams(){return this.getContext()===AudioPlaylist.TYPE_SEARCH}isDebug(){return Boolean(ls.get(AudioPlayer.LS_PREFIX+"stats_debug"))}sendListenedData(e){var t=e&&e.hash,i=(0,o.extend)({act:"listened_data",impl:this.getType(),hash:t,v:5,loc:nav.strLoc},e);ajax.post("al_audio.php",i,{onDone:e=>{this.player.setAdsConfig&&this.player.setAdsConfig(e)},onFail:()=>!0})}getPlaylistQueue(){this.player.getPlaylistQueue()}}},122992:(e,t,i)=>{"use strict";i.d(t,{followCurator:()=>n});var a=i(897449),o=i(819086),s=i(70162),r=i(124041),l=i(274642),d=i(937884);function n(e,t,i){(0,a.lockButton)(i),ajax.post("al_curator.php",{act:"follow",curator_id:e,hash:t},{onFail:()=>(0,a.unlockButton)(i),onDone:t=>{(0,l.getAudioPlayer)().notify(d.events.CURATOR_FOLLOW),(0,a.unlockButton)(i),r.FlatButton.setLabel(i,s.getLang("audio_following_artist_button")),i.classList.add("MusicAuthor__follow_btn__followed"),i.onclick=a=>{a.preventDefault(),o.AudioUtils.unfollowCurator(e,t,i)}}})}},267919:(e,t,i)=>{"use strict";i.d(t,{unfollowCurator:()=>n});var a=i(897449),o=i(819086),s=i(70162),r=i(124041),l=i(274642),d=i(937884);function n(e,t,i){(0,a.lockButton)(i),ajax.post("al_curator.php",{act:"unfollow",curator_id:e,hash:t},{onFail:()=>(0,a.unlockButton)(i),onDone:t=>{(0,l.getAudioPlayer)().notify(d.events.CURATOR_UNFOLLOW),(0,a.unlockButton)(i),r.FlatButton.setLabel(i,s.getLang("audio_follow_artist_button")),i.classList.remove("MusicAuthor__follow_btn__followed"),i.onclick=a=>{a.preventDefault(),o.AudioUtils.followCurator(e,t,i)}}})}},954020:(e,t,i)=>{"use strict";i.d(t,{addToGroupBox:()=>l});var a=i(873589),o=i(70162),s=i(146143),r=i(501389);function l(e,t,i){var l=e+"_"+t,d=(0,s.showBox)("al_audio.php",{act:"add_to_groups_box",playlist_id:l,access_hash:i}).setButtons(o.getLang("Save"),(()=>{var e=[];for(var t in cur.wdd.follow_playlist_wwd.selected)e.push(cur.wdd.follow_playlist_wwd.selected[t][0]);e.length&&((0,a.ge)("add_playlist_to_group_fail").innerHTML="",ajax.post("al_audio.php",{act:"add_to_group",group_ids:e,hash:(0,a.ge)("add_playlist_to_group_hash").value,playlist_id:l},{onDone(e){d.hide(),(0,r.showDoneBox)(e)},onFail:e=>((0,a.ge)("add_playlist_to_group_fail").innerHTML=e,!0)}))}))}},528924:(e,t,i)=>{"use strict";i.d(t,{removeFromGroup:()=>d});var a=i(873589),o=i(70162),s=i(146143),r=i(501389),l=i(844142);function d(e,t,i,d){void 0===d&&(d=null);var n=e+"_"+t,u=null,_=cur.audioPage&&cur.audioPage._ownerId;if(l.Ranges.isGroupId(_))u=-_;else{var c=cur.group_id;l.Ranges.isGroupId(-c)&&(u=c)}if(u)var p=(0,s.showBox)("al_audio.php",{act:"delete_from_group_box",playlist_id:n,group_id:u}).setButtons(o.getLang("global_yes"),(()=>{ajax.post("al_audio.php",{act:"delete_from_group",group_id:u,hash:i,playlist_id:n},{onDone(e){if(p.hide(),(0,r.showDoneBox)(e),d){var t=(0,a.gpeByClass)("audio_pl_snippet2",d);t&&t.classList.remove("audio_pl__can_remove_from_club")}},onFail:e=>(p.hide(),(0,r.showDoneBox)(e),!0)})}),o.getLang("global_cancel"),(()=>p.hide())).show()}},806734:(e,t,i)=>{"use strict";i.d(t,{addToPlaylistsBoxInit:()=>c});var a=i(873589),o=i(152278),s=i(342269),r=i(501389),l=i(897449),d=i(70162),n=i(368752),u=i(325900),_=i(233438);function c(e,t,i,p,h){if("undefined"==typeof AutoList)return window.stManager.add(window.jsc("web/auto_list.js"),(()=>{c(e,t,i,p,h)}));var g=(0,r.curBox)(),y=(0,a.geByClass1)("_audio_atp_content",g.bodyNode),A=(0,a.geByClass1)("_audio_atp_list",g.bodyNode),f=(0,a.ge)("audio_atp_search"),P=(0,a.geByClass1)("_audio_atp_empty"),v=(0,a.getSize)(y)[1];(0,a.setStyle)(A,{height:v-(0,a.getSize)(f)[1]});var E,m="";function w(){E&&E.destroy(),A.innerHTML="";var e=[];e=m?p.filter((e=>e[2].toLowerCase().indexOf(m)>=0)):p,(0,a.toggle)(A,0!=e.length),(0,a.toggle)(P,0==e.length),E=new AutoList(A,{onNeedRows:(t,i)=>{for(var a=[],o=i,s=Math.min(e.length,i+30),r=o;r<s;r++){var l=e[r];if(l){var d=l[4]?"ape_selected":"",n=`<div class="ape_check">\n              <div class="ape_check--unchecked">${(0,u.getIcon24CheckCircleOff)().icon}</div>\n              <div class="ape_check--checked">${(0,_.getIcon24CheckCircleOn)().icon}</div>\n            </div>`,c=`<div class="ape_pl_item _ape_pl_item ${d}" data-id="${l[1]}">${n}<div class="ape_pl_item_inner"><span class="ape_pl_title">${l[2]}</span> <span class="ape_pl_size">${l[3]}</span></div></div>`;a.push(c)}}t(a)}})}w(),cur.addToPlaylistSearch=(0,n.debounce)((function(e){m=(0,s.trim)(e).toLowerCase(),w()}),200);var b={},I={};(0,o.addEvent)(A,"click",(e=>{var t=(0,a.domClosest)("_ape_pl_item",e.target),i=(0,a.domData)(t,"id");(0,a.toggleClass)(t,"ape_selected")?(I[i]=!0,delete b[i]):(b[i]=!0,delete I[i])})),g.removeButtons(),g.addButton(d.getLang("global_save"),(a=>{var o=Object.keys(I),s=Object.keys(b);ajax.post("al_audio.php",{act:"save_audio_in_playlists",add_pl_ids:o.join(","),remove_pl_ids:s.join(","),owner_id:e,audio_owner_id:t,audio_id:i,hash:h},{showProgress:()=>(0,l.lockButton)(a),hideProgress:()=>(0,l.unlockButton)(a),onDone:()=>{g.hide()},onFail:()=>(g.hide(),!0)})}),"ok",!0),g.addButton(d.getLang("global_cancel"),g.hide.bind(this),"no",!0)}},561737:(e,t,i)=>{"use strict";i.d(t,{claimPlaylist:()=>o});var a=i(501389);function o(e,t,i){var o=nav.objLoc.claim;if(o){var s={act:i?"a_unclaim_playlist":"a_claim_playlist",claim:o,type:"audio",owner_id:e,playlist_id:t};ajax.post("al_claims.php",s,{onDone:e=>{(0,a.showDoneBox)(e)}})}}},864200:(e,t,i)=>{"use strict";i.d(t,{copyPlaylistLink:()=>d});var a=i(10141),o=i(70162),s=i(798262),r=i(501389),l=i(773653);function d(e,t,i){(0,s.statlogsValueEvent)("audio_copy_link",vk.id),(0,a.copyToClipboard)((0,l.getPlaylistUrl)(e,t,i,!0)),(0,r.showDoneBox)(o.getLang("audio_playlist_link_copied"))}},807772:(e,t,i)=>{"use strict";function a(e,t,i,a){window.stManager.add([window.jsc("web/audio.js"),"audio.css",window.jsc("web/auto_list.js")],(function(){ajax.post("al_audio.php?act=playlists_edit_data",{owner_id:e,playlist_id:t},{onDone:function(o){o.audio_playlist_cover_upload_options&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[e]=o.audio_playlist_cover_upload_options),o.editorial_playlists_params&&(cur.editorialPlaylistsParams=o.editorial_playlists_params),AudioPage.editPlaylist(e,t,i,a)},onFail:()=>!0})}))}i.d(t,{editPlaylist:()=>a})},220697:(e,t,i)=>{"use strict";i.d(t,{followPlaylist:()=>c});var a=i(873589),o=i(274642),s=i(70162),r=i(733164),l=i(501389),d=i(342269),n=i(146143),u=i(937884),_=[];function c(e,t,i,c,p,h){if(void 0===p&&(p=!1),void 0===h&&(h=""),vk&&vk.widget&&!vk.id&&window.Widgets)return Widgets.oauth(),!1;var g=(0,o.getAudioPlayer)().getPlaylist(AudioPlaylist.TYPE_PLAYLIST,t,i);function y(o){var s=(0,a.domData)(e,"text-followed"),r=(0,a.domData)(e,"text-follow"),l=o?s:r;(0,a.domData)(e,"tooltip-text",l),((0,a.geByClass1)("audio_pl_snippet__action_btn_add_text",e)||e).innerHTML=l,g.setFollowed(o);var n=g.getAddClasses()||"";n=n.replace("audio_pl__followed",""),o&&(n+=" audio_pl__followed"),g.mergeWith({addClasses:n}),(0,d.each)((0,a.geByClass)(`_audio_pl_${t}_${i}`),((t,i)=>{(0,a.toggleClass)(i,"audio_pl__followed",o);var s=i.querySelectorAll(".audio_pl_snippet__action_btn_add")[0];s&&(s.innerHTML=e.innerHTML)}))}function A(e){if(cur.audioPage&&cur.audioPage._data.playlists&&cur.audioPage.getOwnerId()===vk.id){if(e){var a=null;_=_.filter((e=>{var o=e.playlistId===i&&e.playlistOwnerId===t;return o&&(a=e.pl),!o})),a&&cur.audioPage._data.playlists.unshift(a)}else cur.audioPage._data.playlists=cur.audioPage._data.playlists.filter((e=>{var a=e.id===i&&e.owner_id===t;return a&&_.push({playlistId:i,playlistOwnerId:t,pl:e}),!a}));cur.audioPage.updatePlaylistsCounter(vk.id)}}var f=(0,a.gpeByClass)("_audio_pl",e),P=(0,a.toggleClass)(f,"audio_pl__followed");y(P),A(P),ajax.post("al_audio.php",{act:"follow_playlist",playlist_owner_id:t,playlist_id:i,hash:c,showcase:p,block_id:h},{onDone(e){(0,r.isObject)(e)&&P&&(0,o.getAudioPlayer)().notify(u.events.MUSIC_PLAYLISTS_ADD,e)},onFail:e=>(new n.MessageBox({title:s.getLang("global_error")}).content(e).setButtons(s.getLang("audio_ok"),(function(){(0,l.curBox)().hide()})).show(),y(!1),A(!1),!0)})}},977136:(e,t,i)=>{"use strict";i.d(t,{getContextPlaylist:()=>l});var a=i(873589),o=i(819086),s=i(274642),r=i(342269);function l(e,t){var i=(0,s.getAudioPlayer)(),l=o.AudioUtils.getAudioFromEl(e,!0);if(!l)return{};function d(e){return[].slice.call(e)}var n=null,u=[],_=(0,a.domData)(e,"new-post"),c=!1,p=null,h=AudioPlaylist.TYPE_TEMP,g=vk.id,y=null,A={},f=window.AudioPage&&currentAudioPage(e);if((0,a.traverseParent)(e,(e=>c=(0,a.domData)(e,"audio-context"))),c=(c=l.context||c)||("audio"==cur.module?cur.submodule:cur.module),t||"autoplay"===c)return{context:c};var P=o.AudioUtils.contextSplit(c),v=P[0],E=P[1],m=(0,a.gpeByClass)("_audio_pl",e),w=!1;if(m){var b=(0,a.domData)(m,"playlist-id");(p=i.getPlaylistByBlockId(b))||(p=i.getPlaylist(...AudioPlaylist.splitId(b||"")));var I=(0,a.domData)(m,"no-consecutive-play");I&&p.mergeWith({noConsecutivePlay:I});var C=(0,a.domData)(m,"title")||"";C&&p.mergeWith({title:(0,r.clean)(C)});var T=(0,a.domData)(m,"access-hash")||"";T&&p.mergeWith({accessHash:T})}else if(f&&f.getPageCurrentPlaylist())p=f.getPageCurrentPlaylist();else if("module"==v){var L=E;p=i.getPlaylist(AudioPlaylist.TYPE_PLAYLIST,L||cur.oid||vk.id,AudioPlaylist.DEFAULT_PLAYLIST_ID),u=[n]}else if(0===l.context.indexOf("admin"))(p=i.getPlaylist(AudioPlaylist.TYPE_PLAYLIST,l.ownerId,0,l.accessKey)).getAudiosCount()||p.setForceReload(!0);else if(0===l.context.indexOf("im"))n=(n=(0,a.gpeByClass)("_im_peer_history",e))||(0,a.gpeByClass)("_fc_tab_log_msgs",e),y="im"+(cur.peer||"");else if(0===l.context.indexOf("board"))w=!0,y=l.context,u=d((0,a.geByClass)("_wall_audio_rows",n));else if(0===l.context.indexOf("widget"))w=!0,y=l.context;else if(0===l.context.indexOf("wiki"))w=!0,y="wiki";else if(0===l.context.indexOf("post")){h=AudioPlaylist.TYPE_WALL,y=l.context,w=!0;var O=l.context.replace("post","").split("_");g=O[0],A={postId:O[1]}}else if(0===l.context.indexOf("choose"))y=l.context;else if("feed"==_||0===l.context.indexOf("feed")||0===l.context.indexOf("feedsearch"))y="feed",w=!0,u=d((0,a.geByClass)("wall_text",n));else if("group_wall"==v||"user_wall"==v||0===l.context.indexOf("reply")||"wall"==_){h=AudioPlaylist.TYPE_WALL,g=cur.oid;var D=(E||"").split("_")[1],k=cur.wallQuery||"",S=(0,a.ge)("wall_search"),U=(0,r.inArray)(cur.wallType,["own","full_own"])?"own":"all";y=hashCode(U+"_"+k),w=!0,"wall"==cur.module&&(0,a.val)(S)&&(k=(0,a.val)(S)),D&&(A={postId:D,wallQuery:k,wallType:U}),0===l.context.indexOf("reply")&&(u=d([(0,a.gpeByClass)("_replies_list",e)]),y="reply"+y,w=!0);var x=(0,a.gpeByClass)("wide_column",e);if(x){var M=(0,a.geByClass)("wall_text",x);u=Array.isArray(M)&&M.length>0?u.concat(M):u.concat(d([n]))}else u=u.concat(d([n]))}else"article"==v&&(p=cur.articlePlaylist);return n||(n=(0,a.domPN)(e)),(u=u.filter((function(e){return!!e})))&&0!=u.length||(u=[n]),"function"==typeof(p=p||i.getPlaylist(h,g,y)).setIsFakeId&&p.setIsFakeId(w),(p=p.getAudiosCount()?p:o.AudioUtils.initDomPlaylist(p,u)).mergeWith(A||{}),-1==p.indexOfAudio(l)&&(p=o.AudioUtils.initDomPlaylist(p,[(0,a.domPN)(e)])),0===l.context.indexOf("im")&&p.setContext(`im:${cur.peer||""}`),{playlist:p,context:c}}},569011:(e,t,i)=>{"use strict";function a(){return window.playlistAddRestoreInfo||(window.playlistAddRestoreInfo={}),window.playlistAddRestoreInfo}i.d(t,{getPlaylistAddRestoreInfo:()=>a})},759375:(e,t,i)=>{"use strict";i.d(t,{hidePlaylistFromRecoms:()=>r});var a=i(85258),o=i(70162),s=i(501389);function r(e,t,i){ajax.post("al_audio.php?act=hide_playlist_from_recoms",{owner_id:e,playlist_id:t,access_hash:i},{onDone(){(0,s.showDoneBox)(o.getLang("audio_playlist_recoms_was_hidden"));var a=document.getElementsByClassName("ui_actions_menu_item playlist_recoms_hide_or_show")[0];a.innerHTML=o.getLang("audio_playlist_recoms_show"),a.setAttribute("onclick","AudioUtils.showPlaylistInRecoms("+e+", "+t+", '"+i+"');");for(var r=0,l=["audio_search","audio_search_layer"];r<l.length;r++){var d=l[r],n=document.getElementById(d);if(n)window.currentAudioPage(n).catalogController.currentSection.reloadBlock("recommended_playlists")}},onFail(e){(0,a.showErrorBox)(e||o.getLang("global_unknown_error"))}})}},699256:(e,t,i)=>{"use strict";i.d(t,{initDomPlaylist:()=>s});var a=i(342269),o=i(377673);function s(e,t){var i=[];return(0,a.each)(t,(function(e,t){t&&[...t.querySelectorAll("._audio_row")].forEach((e=>{i.push((0,o.getAudioFromEl)(e))}))})),e.pushAudio(i),e}},121718:(e,t,i)=>{"use strict";i.d(t,{initRowPlaylistsChooser:()=>o});var a=i(819086);function o(e,t,i){var o,s=a.AudioUtils.audioTupleToAudioObject(e);o=cur.audioPage&&cur.audioPage.getOwnerId()<0&&cur.audioPage.canEditGroup()?cur.audioPage.getOwnerId():vk.id,a.AudioUtils.playlistsByAudioDataCache=a.AudioUtils.playlistsByAudioDataCache||{};var r=a.AudioUtils.playlistsByAudioDataCache,l=o+"_"+s.ownerId+"_"+s.id;r[l]?a.AudioUtils._showPlaylistsChooser(i,t,r[l],o,s,e):ajax.post("al_audio.php",{act:"playlists_by_audio",owner_id:o,audio_owner_id:s.ownerId,audio_id:s.id},{onDone:(d,n,u)=>{var _=r[l]={playlists:d,morePlaylists:n,newPlaylistHash:u};a.AudioUtils._showPlaylistsChooser(i,t,_,o,s,e)},onFail:()=>!0})}},175345:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{loadAllPlaylistAudios:()=>loadAllPlaylistAudios});var _web_lib_utils_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(342269),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(274642),AUDIO_LOAD_CHUNK_SIZE=1e3,chunks,isDeleted,isAttach,onDone,playlist,preloadedCount,totalCount=void 0;function loadAllPlaylistAudios(e,t,i){if(void 0===i&&(i=!1),e.getForceReload())e.list=[];else if(!e.hasMore()||!e.isFullyLoadable())return onDone&&onDone();e.setForceReload(!1),chunks=[],isAttach="attach"===i,onDone=t,playlist=e,preloadedCount=0,totalCount=e.getTotalCount(),loadChunk(0,(()=>{isDeleted?onAllLoaded():(isAttach&&onAllLoaded(),loadAllChunks(onAllLoaded,1))}))}function onAllLoaded(){if(isDeleted)return onDone&&onDone(null,isDeleted);var e=[];((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(chunks,(function(t,i){i&&(e=e.concat(i))})),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_1__.getAudioPlayer)().getPlaylists().forEach((t=>{t.getId()===playlist.getId()&&(t._list=e)})),(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_1__.getAudioPlayer)().mergePlaylistData(playlist,{hasMore:!1}),onDone)&&onDone(playlist,!1,isAttach&&totalCount>preloadedCount)}function loadAllChunks(e,t){t=t||0;var i=Math.max(0,Math.ceil((totalCount-preloadedCount)/AUDIO_LOAD_CHUNK_SIZE));isAttach&&t&&totalCount>preloadedCount&&i===t&&i++,i-t<=0?e():function(){for(var a=new CallHub(e,i-t),o=t;o<i;o++)loadChunk(o,(()=>{a.done()}))}()}function loadChunk(chunkIndex,callback){var isPreload=isAttach&&!chunkIndex?1:0,offset=chunkIndex*AUDIO_LOAD_CHUNK_SIZE;preloadedCount&&(offset=Math.abs(AUDIO_LOAD_CHUNK_SIZE-preloadedCount-chunkIndex*AUDIO_LOAD_CHUNK_SIZE)),ajax.post("al_audio.php?act=load_section",{type:playlist.getType(),owner_id:playlist.getOwnerId(),playlist_id:playlist.getPlaylistId(),access_hash:playlist.getAccessHash(),from_id:playlist.getFromId(),offset,is_loading_all:1,is_preload:isPreload,context:playlist.getContext(),claim:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_0__.intval)(nav.objLoc.claim),ref:playlist.getRef()},{onDone:function onDone(data,tpl,langs,templatesScript){if(0===chunkIndex){if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_0__.addTemplates)({audio_playlist_snippet:tpl}),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_0__.extend)(cur.lang,langs),templatesScript&&eval(templatesScript),!data)return isDeleted=!0,callback();isDeleted=!1,totalCount=data.totalCount,preloadedCount=data.list.length,(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_1__.getAudioPlayer)().mergePlaylistData(playlist,data)}chunks[chunkIndex]=data.list,callback()},onFail:()=>!0})}},506878:(e,t,i)=>{"use strict";i.d(t,{onAudioAddedToPlaylist:()=>r});var a=i(873589),o=i(274642),s=i(342269);function r(e,t,i,r){(0,o.getAudioPlayer)().getPlaylist(AudioPlaylist.TYPE_PLAYLIST,e,t).pushAudio(r,0),(0,s.each)((0,a.geByClass)(`_audio_pl_${e}_${t}`),((e,t)=>{(0,a.domReplaceEl)(t,(0,a.se)(i))}))}},486722:(e,t,i)=>{"use strict";function a(e,t){var i=t.getAccessHash();cur.chooseMedia("audio_playlist",t.getOwnerId()+"_"+t.getPlaylistId()+(i?":"+i:""),{id:t.getPlaylistId(),ownerId:t.getOwnerId(),coverUrl:t.getCoverUrl(),gridCovers:t.getGridCovers(),title:t.getTitle(),authorName:t.getAuthorName(),authorHref:t.getAuthorHref(),accessHash:t.getAccessHash()})}i.d(t,{onPlaylistChoose:()=>a})},863477:(e,t,i)=>{"use strict";i.d(t,{showAudioPlaylist:()=>h});var a=i(873589),o=i(819086),s=i(840060),r=i(274642),l=i(70162),d=i(501389),n=i(342269),u=i(152278),_=i(146143),c=i(99320),p=i(773653);function h(e,t,i,h,g,y){if(cur.apLayer)return(0,u.cancelEvent)(g);if(vk.widget)return!0;if(!g||!(g.metaKey&&s.browser.mac||g.ctrlKey)){var A=null;return window.Photoview&&window.cur&&cur.pvShown&&(A=(0,n.clone)(nav.objLoc),Photoview.hide(!0)),(0,d.boxRefreshCoords)(boxLoader),(0,a.show)(boxLoader),(0,a.show)(boxLayerWrap),window.stManager.add([window.jsc("web/auto_list.js"),"audio.css"],(function(){var s,g,f=(0,r.getAudioPlayer)().getPlaylist(AudioPlaylist.TYPE_PLAYLIST,e,t,i);function P(e){boxQueue.hideAll(),cur.apLayerAutoList&&(cur.apLayerAutoList.destroy(),cur.apLayerAutoList=null),layers.wraphide(window.audioPlaylistLayerWrap),layers.fullhide=!1,s&&(0,u.removeEvent)(window.audioPlaylistLayerWrap,"click",s),g&&(0,u.removeEvent)(document.body,"keydown",g),delete cur.apLayer,delete cur.apLayerPlaylistId,(0,a.removeClass)(layerBG,"ap_layer_bg_dark"),A?nav.change(A):nav.change({z:!1}),layerQueue.pop()}f.setContext(h),f.setForceReload(!0),f.setFromId(cur.oid),f.loadAll((function(f,v){if((0,a.hide)(boxLoader),(0,a.hide)(boxLayerWrap),v){var E=l.getLang("audio_error_deleted_playlist_box").split("/");return new _.MessageBox({title:E[0]}).content(E[1]).setButtons(l.getLang("global_close"),(function(){(0,d.curBox)().hide(),A&&nav.change(A)})).show(),void nav.setLoc((0,n.extend)(nav.objLoc,{z:!1}))}var m=(0,n.extend)(nav.objLoc,{z:"audio_playlist"+e+"_"+t+(i?"/"+i:"")});nav.setLoc(m),window.audioPlaylistLayerWrap||(window.audioPlaylistLayerWrap=(0,a.se)('<div class="ap_layer_wrap"></div>'),document.body.appendChild(window.audioPlaylistLayerWrap));window.audioPlaylistLayerWrap.innerHTML="";var w=f&&f.getAudiosList?f.getAudiosList().length:0,b=f.isBlocked&&f.isBlocked(),I=(0,p.getPlaylistUrl)(f.getOwnerId(),f.getPlaylistId(),f.getAccessHash()),C=(0,n.getTemplate)("audio_playlist_snippet",{title:f.getTitle(),subTitle:f.getSubtitle(),description:f.getDescription(),coverStyle:f.getCoverUrl()?"background-image:url('"+f.getCoverUrl()+"'); background-size: cover;":"",authorLine:f.getAuthorLine(),infoLine1:f.getInfoLine1(),infoLine2:f.getInfoLine2(),id:f.getPlaylistId(),ownerId:f.getOwnerId(),href:I,addCls:f.getAddClasses(),followHash:f.getFollowHash(),accessHash:f.getAccessHash(),editHash:f.getEditHash(),deleteHash:f.getDeleteHash(),replaceHash:f.getReplaceHash(),gridCovers:f.getGridCovers(),type:f.getType(),context:h,followButtonText:f.isFollowed()?l.getLang("audio_playlist_btn_added"):l.getLang("audio_playlist_btn_add")});if(cur.apLayer=(0,a.se)(`\n        <div class="ap_layer">\n          <div class="ap_layer__content">\n            ${C}\n          </div>\n          <div class="ap_layer__close _ap_layer__close"></div>\n        </div>\n      `),b){(0,a.geByClass1)("audio_pl_snippet__body",cur.apLayer).innerHTML=(0,n.getTemplate)("playlist_snippet_stub")}window.audioPlaylistLayerWrap.appendChild(cur.apLayer),(0,u.addEvent)(window.audioPlaylistLayerWrap,"click",s=function(e){e.target!=window.audioPlaylistLayerWrap&&e.target!=(0,a.geByClass1)("_ap_layer__close",cur.apLayer)||layers&&layers.fullhide&&layers.fullhide()}),(0,u.addEvent)(document.body,"keydown",g=function(e){if(27==e.keyCode)return layers&&layers.fullhide&&layers.fullhide(),(0,u.cancelEvent)(e)}),layerQueue.push(),layerQueue.hide(),boxQueue.hideAll(),layers.wrapshow(window.audioPlaylistLayerWrap,.7),(0,a.addClass)(layerBG,"ap_layer_bg_dark");var T=(0,a.geByClass1)("_audio_pl_snippet__list",cur.apLayer),L=o.AudioUtils.getAlbumParts(f),O=0;w&&!b&&(cur.apLayerAutoList=new c.default(T,{scrollNode:window.audioPlaylistLayerWrap,onNeedRows:function(e,t){for(var i=[],a=f.getAudiosList(),s=t-=O;s<t+30;s++){var r=a[s];if(!r)break;if(L&&L.length&&L[0].offset===s){var l=L.shift();O++,i.push(o.AudioUtils.drawAlbumPartRow(l.number))}i.push(o.AudioUtils.drawAudio(r))}e(i)}}));(0,d.boxRefreshCoords)(cur.apLayer),(0,r.getAudioPlayer)().updateCurrentPlaying(),layers.fullhide=P,cur.apLayerPlaylistId=[e,t],y&&y()}))})),!1}}},150525:(e,t,i)=>{"use strict";i.d(t,{showPlaylistInRecoms:()=>r});var a=i(85258),o=i(70162),s=i(501389);function r(e,t,i){ajax.post("al_audio.php?act=show_playlist_in_recoms",{owner_id:e,playlist_id:t,access_hash:i},{onDone(){(0,s.showDoneBox)(o.getLang("audio_playlist_recoms_was_showed"));var a=document.getElementsByClassName("ui_actions_menu_item playlist_recoms_hide_or_show")[0];a.innerHTML=o.getLang("audio_playlist_recoms_hide"),a.setAttribute("onclick","AudioUtils.hidePlaylistFromRecoms("+e+", "+t+", '"+i+"');");for(var r=0,l=["audio_search","audio_search_layer"];r<l.length;r++){var d=l[r],n=document.getElementById(d);if(n)window.currentAudioPage(n).catalogController.currentSection.reloadBlock("recommended_playlists")}},onFail(e){(0,a.showErrorBox)(e||o.getLang("global_unknown_error"))}})}},787632:(e,t,i)=>{"use strict";i.d(t,{showPlaylistsChooser:()=>u});var a=i(873589),o=i(819086),s=i(70162),r=i(146143),l=i(342269),d=i(53721),n=i(837565);function u(e,t,i,u,_,c){var p=i.playlists,h=i.newPlaylistHash,g=i.morePlaylists;o.AudioUtils.copiedToPlaylistAudios=o.AudioUtils.copiedToPlaylistAudios||{},o.AudioUtils.copiedToPlaylistAudiosHashes=o.AudioUtils.copiedToPlaylistAudiosHashes||{};var y=t,A=(0,a.se)((0,a.rs)(o.AudioUtils.AUDIO_ROW_ACTION_ROW_ITEM,["pl_new",0,s.getLang("audio_add_to_new_pl"),"audio_row__action_playlist"]));if((0,a.domInsertAfter)(A,y),y=A,A.addEventListener("click",(()=>{o.AudioUtils.editPlaylist(u,!1,"edit",{addAudio:c,newPlaylistHash:h})})),(0,l.each)(p,((e,t)=>{var i=!0,s=t[0]+"_"+t[1]+"_"+_.fullId,r=o.AudioUtils.copiedToPlaylistAudios[s],u="audio_row__action_playlist";(t[3]||r)&&(i=!1,u+=" audio_row__more_playlist_added");var c=(0,a.se)((0,a.rs)(o.AudioUtils.AUDIO_ROW_ACTION_ROW_ITEM,["pl_"+t[0]+"_"+t[1],0,t[2],u]));(0,a.domInsertAfter)(c,y),y=c;var p=!1;c.addEventListener("click",(()=>{if(!p){p=!0;var e=_.ownerId,r=_.id,u=o.AudioUtils.copiedToPlaylistAudios[s];u&&(e=(u=u.split("_"))[0],r=u[1]),i&&(o.AudioUtils.copiedToPlaylistAudiosHashes[s]=t[4]),ajax.post("al_audio.php",{act:"add_audio_to_playlist",hash:t[4],playlist_id:t[1],playlist_owner_id:t[0],audio_owner_id:e,audio_id:r,do_add:(0,l.intval)(i)},{onDone:(e,a,r)=>{(0,n.onAdditionalEvent)(c,_,{type:i?d.TYPE_ADDED:d.TYPE_REMOVED,playlistId:t[0]+"_"+t[1]}),o.AudioUtils.copiedToPlaylistAudios[s]=!!i&&r,t[4]=i?e:o.AudioUtils.copiedToPlaylistAudiosHashes[s],i=!i,p=!1},onFail:()=>!0}),(0,a.toggleClass)(c,"audio_row__more_playlist_added",i)}}))})),g){var f=(0,a.se)((0,a.rs)(o.AudioUtils.AUDIO_ROW_ACTION_ROW_ITEM,["pl_more",0,s.getLang("audio_row_show_all_playlists"),"audio_row__action_playlist"]));f.addEventListener("click",(()=>{(0,r.showBox)("al_audio.php?act=more_playlists_add",{owner_id:u,audio_owner_id:_.ownerId,audio_id:_.id},{params:{bodyStyle:"padding: 0px",width:560}})})),(0,a.domInsertAfter)(f,y),y=f}e.updatePosition()}},477951:(e,t,i)=>{"use strict";i.d(t,{turnPlaylistDiscover:()=>o});var a=i(501389);function o(e,t){var i={act:"turn_playlist_discover",owner_id:e,playlist_id:t};ajax.post("al_audio.php",i,{onDone:e=>{(0,a.showDoneBox)(e)}})}},865429:(e,t,i)=>{"use strict";i.d(t,{deleteEpisode:()=>o});var a=i(704042);function o(e,t){(0,a.isPodcast)(t)&&window.stManager.add([window.jsc("web/podcast.js")],(function(){Podcast.deleteEpisode(t.fullId,t.deleteHash)}))}},668327:(e,t,i)=>{"use strict";i.d(t,{editEpisode:()=>o});var a=i(704042);function o(e,t){(0,a.isPodcast)(t)&&(cur.podcastEditData={audioId:t.fullId},window.stManager.add([window.jsc("web/podcast.js")],(function(){Podcast.edit(t.fullId)})))}},310804:(e,t,i)=>{"use strict";i.d(t,{faveEpisode:()=>r});var a=i(704042),o=i(896438),s=i(274642);function r(e,t){if(e&&(0,a.isPodcast)(t)){var i=(0,o.getAudioExtra)(t).faveHash;(0,s.bookmarkPodcast)(e.querySelector(".audio_row__action_fave"),t.fullId,i)}}},404621:(e,t,i)=>{"use strict";i.d(t,{isPrivatePodcast:()=>s});var a=i(704042),o=i(896438);function s(e){return!(!(0,a.isPodcast)(e)||!(0,o.getAudioExtra)(e).private)}},917528:(e,t,i)=>{"use strict";i.d(t,{openEpisode:()=>r});var a=i(274642),o=i(624715),s=i(704042);function r(e,t){t=(0,o.audioTupleToAudioObject)(t),(0,s.isPodcast)(t)&&(0,a.showPodcast)(e,t.fullId,null,"audio")}},501037:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ACTION_PLAY:()=>o,ACTION_PAUSE:()=>s,ACTION_SEEK:()=>r,ACTION_HEARTBEAT:()=>l,ACTION_TIME_MARKER:()=>d,log:()=>n});var a=i(704042),o="play",s="pause",r="seek",l="heartbeat",d="time_marker";function n(e,t){var i=t.audio;(0,a.isPodcast)(i)&&window.stManager.add([window.jsc("web/podcast.js")],(function(){Podcast.log(e,t)}))}},25890:(e,t,i)=>{"use strict";i.d(t,{restoreEpisode:()=>o});var a=i(704042);function o(e,t){(0,a.isPodcast)(t)&&window.stManager.add([window.jsc("web/podcast.js")],(function(){Podcast.restoreEpisode(t.fullId,t.editHash)}))}},416148:(e,t,i)=>{"use strict";function a(e,t){cur.audioPage&&cur.audioPage.showRecoms(!1,t.fullId)}i.d(t,{showRecoms:()=>a})},847873:(e,t,i)=>{"use strict";i.d(t,{audioSearchPerformer:()=>o});var a=i(733164);function o(e,t,i){var o=!!window.AudioPage&&currentAudioPage(e),s=window.AudioPage&&currentAudioPage(e)||cur.audioPage;layers.fullhide&&layers.fullhide(!0),setTimeout((function(){o&&s?(t=(0,a.unclean)(t).replace(/<em>|<\/em>/g,""),nav.change({q:t,performer:1},i,{searchPerformer:!0,nav:!0,isLayer:o.isLayer()})):nav.go(e,i)}),50)}},837565:(e,t,i)=>{"use strict";i.d(t,{onAdditionalEvent:()=>u});var a=i(722122),o=i(53721),s=i(51488),r=i(274642),l=i(234910),d=i(977136),n=i(624715);function u(e,t,i){void 0===i&&(i={});var u,_=new o.AudioStats(new s.WebPlayerAdapter((0,r.getAudioPlayer)())),c=t&&t.context||e&&(0,l.getContext)(e)||"",p=(0,r.getAudioPlayer)(),h=p.getCurrentAudio()?(0,n.audioTupleToAudioObject)(p.getCurrentAudio()):null,g=(u=h&&t.fullId===h.fullId?p.getCurrentPlaylist():(0,d.getContextPlaylist)(e).playlist)?u.getFullId():"",y=(0,a.default)({},t,{context:c,playlistId:g},i);_.sendCurrentAudioEvent({type:y.type,subtype:y.subtype||_.getPlaySubtype(),ownerId:y.ownerId,audioId:y.id,trackCode:y.trackCode,state:_.playerAdapter.getState(),ref:window.cur&&vk.widget?String(cur.widgetReferrer||"").substring(0,20):"",context:y.context,playlistId:y.playlistId})}},536107:(e,t,i)=>{"use strict";i.d(t,{addAudio:()=>f});var a=i(873589),o=i(819086),s=i(274642),r=i(501389),l=i(342269),d=i(937884),n=i(53721),u=i(837565),_=i(977136),c=i(733164),p=i(517920),h=i(70162),g=i(514191),y=i(152278),A=i(146143);function f(e,t,i,f){var P;if(void 0===i&&(i=()=>{}),void 0===f&&(f=""),cur.viewAsBox)return cur.viewAsBox();if(vk&&vk.widget&&!vk.id&&window.Widgets)return Widgets.oauth(),!1;function v(t){return(0,a.domData)(e,"in-progress",(0,l.intval)(t))}if(!(0,l.intval)((0,a.domData)(e,"in-progress"))&&(v(!0),t=t||o.AudioUtils.getAudioFromEl(e,!0))){var E=window.AudioPage&&currentAudioPage(e),m=E&&E.getOwnerId()<0&&E.canAddToGroup()&&E.getOwnerId()!==t.ownerId?-E.getOwnerId():0,w=o.AudioUtils.getAddRestoreInfo(),b=w[t.fullId];b&&w[b.addedFullId]&&(b=null);var I=(0,a.geByClass1)("_audio_row_"+t.fullId);I=I!=e&&I;var C=E&&E.getPageCurrentPlaylist(),T=null!=(P=(0,_.getContextPlaylist)(e,!0))?P:{context:f},L={group_id:m,audio_owner_id:t.ownerId,audio_id:t.id,hash:t.addHash,from:T&&T.context||"",track_code:t.trackCode};b?"recom_hidden"==b.state?(E&&(E.restoreRecommendation(e),v(!1)),o.AudioUtils.onRowOver(e,!1,!0)):"deleted"==b.state?(g.ajax.post("al_audio.php",{act:"restore_audio",oid:t.ownerId,aid:t.id,hash:t.restoreHash,track_code:t.trackCode},{onDone:function(){(0,u.onAdditionalEvent)(e,t,{type:n.TYPE_ADDED}),v(!1)},onFail:()=>(v(!1),!0)}),(0,a.removeClass)(e,"audio_row__deleted"),delete w[t.fullId],o.AudioUtils.onRowOver(e,!1,!0)):"added"==b.state&&(g.ajax.post("al_audio.php",{act:"delete_audio",oid:b.audio.ownerId,aid:b.audio.id,hash:b.audio.deleteHash,track_code:t.trackCode},{onDone:function(){(0,u.onAdditionalEvent)(e,t,{type:n.TYPE_REMOVED});var i=(0,s.getAudioPlayer)();i&&(i.getPlaylist(AudioPlaylist.TYPE_PLAYLIST,m?-m:vk.id,AudioPlaylist.DEFAULT_PLAYLIST_ID).removeAudio(b.addedFullId),i.notify(d.events.MUSIC_AUDIOS_DELETE,t)),v(!1)},onFail:()=>(v(!1),!0)}),(0,a.removeClass)(e,"audio_row__added"),I&&(0,a.removeClass)(I,"audio_row__added"),delete w[t.fullId],(0,s.getAudioPlayer)().notify(d.events.REMOVED,t.fullId,b.addedFullId)):(g.ajax.post("al_audio.php?act=add",L,{onDone:function(r,l){if((0,u.onAdditionalEvent)(e,t,{type:n.TYPE_ADDED}),r){var _=r[o.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+r[o.AudioUtils.AUDIO_ITEM_INDEX_ID];w[t.fullId]={state:"added",addedFullId:_,audio:o.AudioUtils.audioTupleToAudioObject(r)},(0,s.getAudioPlayer)().notify(d.events.MUSIC_AUDIOS_ADD,t),(0,c.isFunction)(i)&&i(),function(e,t){var i;if(!t||!t.id)return;var o=null==e||null==(i=e.parentElement)?void 0:i.querySelector(".audio_page_player_share");if(!o)return;var s=(0,a.se)(`\n    <div class="ta_l">\n      <div>${t.text}</div>\n    </div>\n `),r=()=>{window.ajax.post("al_index.php",{act:"help_hints_hide",hash:t.hash,hint_id:t.id})};(0,y.addEvent)(s,"click",r);var l=new p.ElementTooltip(o,{appendToParent:!0,cls:"feature_intro_tt feature_intro_blue_tt feature_intro_blue_tt--heightSmall",content:s,offset:[0,10],align:p.ElementTooltip.ALIGN_RIGHT,onHide:r});l.show(),o.addEventListener("mouseenter",(()=>{l.hide()}))}(e,l)}v(!1)},onFail:function(t){return t&&new A.MessageBox({title:h.getLang("global_error")}).content(t).setButtons(h.getLang("global_close"),(()=>(0,r.curBox)().hide())).show(),(0,a.removeClass)(e,"audio_row__added"),v(!1),!0}}),(0,a.addClass)(e,"audio_row__added"),I&&(0,a.addClass)(I,"audio_row__added"),(0,s.getAudioPlayer)().notify(d.events.ADDED,t.fullId),E&&C&&E.onUserAction(t,C))}}},965495:(e,t,i)=>{"use strict";i.d(t,{addAudioToOwner:()=>o});var a=i(152278);function o(e,t){return window.onAudioPageLoaded=function(){return this.uploadAudio({})},nav.go("audios"+e),(0,a.cancelEvent)(t)}},318801:(e,t,i)=>{"use strict";i.d(t,{cancelReplacement:()=>o});var a=i(873589);function o(e,t,i){ajax.post("al_audio.php",{act:"cancel_replacement",hash:t,audio_id:e},{onFail:()=>!0}),(0,a.re)(i)}},398237:(e,t,i)=>{"use strict";i.d(t,{chooseAudioBox:()=>s});var a=i(873589),o=i(152278);function s(e,t,i){if(void 0!==e.selected)cur.lastAddMedia.unchooseMedia(e.selected),e.selected=void 0,(0,a.removeClass)((0,a.domPN)(e),"audio_selected"),e.innerHTML=t.labels.add;else{var s=cur.attachCount&&cur.attachCount()||0;cur.chooseMedia("audio",t.owner_id+"_"+t.id,t.info),(!cur.attachCount||cur.attachCount()>s)&&cur.lastAddMedia&&(e.selected=cur.lastAddMedia.chosenMedias.length-1,(0,a.addClass)((0,a.domPN)(e),"audio_selected"),e.innerHTML=t.labels.cancel)}return(0,o.cancelEvent)(i)}},814979:(e,t,i)=>{"use strict";i.d(t,{claim:()=>r});var a=i(873589),o=i(748499),s=i(624715);function r(e,t,i){(0,a.addClass)(t,"audio_moder_claimed"),(0,o.onRowOver)(t,!1,!0),e=(0,s.audioTupleToAudioObject)(e),window.ajax.post("al_claims.php",{act:"a_claim",claim:i,type:"audio",id:e.id,owner_id:e.ownerId})}},775950:(e,t,i)=>{"use strict";i.d(t,{deleteAudio:()=>h});var a=i(873589),o=i(274642),s=i(342269),r=i(897449),l=i(146143),d=i(70162),n=i(53721),u=i(837565),_=i(819086),c=i(977136),p=i(937884);function h(e,t,i,h,g){function y(t){return(0,a.domData)(e,"in-progress",(0,s.intval)(t))}if(window.tooltips&&tooltips.hideAll(),!(0,s.intval)((0,a.domData)(e,"in-progress"))){y(!0);var A=!1;t.isClaimed&&(A=!0);var f=_.AudioUtils.getAddRestoreInfo(),P=f[t.fullId];if(P&&P.deleteAll)(0,l.showFastBox)({title:d.getLang("audio_delete_all_title"),dark:1,onHide:()=>y(!1)},P.deleteConfirmMsg||"",d.getLang("global_delete"),(function(e){var t=(0,s.extend)({act:"delete_all"},P.deleteAll);ajax.post("al_audio.php",t,{showProgress:()=>(0,r.lockButton)(e),onDone:function(){var e=(0,o.getAudioPlayer)().getPlaylist(AudioPlaylist.TYPE_PLAYLIST,P.deleteAll.from_id,AudioPlaylist.DEFAULT_PLAYLIST_ID);(0,o.getAudioPlayer)().deletePlaylist(e),nav.reload()},onFail:()=>!0})}),d.getLang("global_cancel"));else{if(A?(0,a.re)(e):(0,a.addClass)(e,"audio_row__deleted"),g){ajax.post("al_audio.php",{act:"remove_listened",audio_id:t.id,audio_owner_id:t.ownerId,hash:t.actionHash},{onFail:()=>!0}),(0,a.re)(e);var v=(0,o.getAudioPlayer)().getCurrentPlaylist();v&&v.getType()==AudioPlaylist.TYPE_RECOM&&v.getAlbumId()==_.AudioUtils.AUDIO_RECOMS_TYPE_LISTENED&&v.removeAudio(t.fullId)}else if(h){var E=_.AudioUtils.getAudioExtra(t).recom,m=null,w=(0,c.getContextPlaylist)(e);w&&(m=w.playlist&&w.playlist.getAlbumId());var b={act:"hide_recommendation",hash:E.hash,audio_id:t.fullId,playlist_id:m};nav.objLoc.audio_id&&(b.recommendation_type="query"),ajax.post("al_audio.php",b,{onDone:()=>{(0,u.onAdditionalEvent)(e,t,{type:n.TYPE_RECOMMENDATION_REMOVED}),y(!1)},onFail:()=>(y(!1),!0)}),f[t.fullId]={state:"recom_hidden"};var I=(0,o.getAudioPlayer)().getCurrentPlaylist();I&&I.getType()==AudioPlaylist.TYPE_RECOM&&(f[t.fullId].removedCurrentPos=I.removeAudio(t))}else ajax.post("al_audio.php",{act:"delete_audio",oid:t.ownerId,aid:t.id,hash:t.deleteHash,restore:1,track_code:t.trackCode},{onDone:(i,a)=>{(0,u.onAdditionalEvent)(e,t,{type:n.TYPE_REMOVED}),A||y(!1),f[t.fullId]={state:"deleted",deleteAll:i,deleteConfirmMsg:a},A&&_.AudioUtils.deleteDeletedAudios(),(0,o.getAudioPlayer)().notify(p.events.MUSIC_AUDIOS_DELETE,t),_.AudioUtils.onRowOver(e,!1,!0)},onFail:()=>!0});_.AudioUtils.onRowOver(e,!1,!0)}}}},462951:(e,t,i)=>{"use strict";i.d(t,{deleteCurrentAudio:()=>s});var a=i(873589),o=i(274642);function s(e,t){window.tooltips&&"function"==typeof window.tooltips.hideAll&&window.tooltips.hideAll(e);var i=(0,o.getAudioPlayer)(),s=i.getPlaylistQueue();s&&(s.removeAudio(t.fullId),i.saveStateCurrentPlaylist()),(0,a.re)(e)}},402803:(e,t,i)=>{"use strict";i.d(t,{deleteDeletedAudios:()=>r});var a=i(342269),o=i(274642),s=i(183489);function r(){(0,a.each)((0,s.getAddRestoreInfo)(),((e,t)=>{"deleted"!==t.state&&"recom_hidden"!==t.state||(0,o.getAudioPlayer)().deleteAudioFromAllPlaylists(e)}))}},314449:(e,t,i)=>{"use strict";i.d(t,{deleteListenedAudio:()=>o});var a=i(775950);function o(e,t){(0,a.deleteAudio)(e,t,!1,!1,!0)}},399245:(e,t,i)=>{"use strict";i.d(t,{deleteRecomsAudio:()=>o});var a=i(775950);function o(e,t){(0,a.deleteAudio)(e,t,!1,!0)}},619416:(e,t,i)=>{"use strict";i.d(t,{getDurationMod:()=>n,drawAudio:()=>u});var a=i(624715),o=i(819086),s=i(114704),r=i(342269),l=i(679740),d=i(166773);function n(e){return e<600?"s":e<3600?"m":e<36e3?"l":"n"}function u(e,t){for(var i=JSON.parse((0,r.getTemplate)("audio_bits_to_cls")),u=e[o.AudioUtils.AUDIO_ITEM_INDEX_FLAGS],_=[],c=0;c<32;c++){var p=1<<c;u&p&&_.push(i[p])}var h=(0,a.audioTupleToAudioObject)(e),g=o.AudioUtils.isPodcast(e);g&&(_.push("audio_podcast"),o.AudioUtils.isPrivatePodcast(e)&&_.push("audio_podcast_private")),t&&_.push(t);var y,A=e[o.AudioUtils.AUDIO_ITEM_INDEX_COVER_URL],f=(null==A?void 0:A.split(/(,(?!\d))/g).filter((e=>","!==e)))[0],P=void 0===f?"":f,v=o.AudioUtils.getAudioPerformers(e),E=e[o.AudioUtils.AUDIO_ITEM_INDEX_DURATION],m=(0,l.formatTime)(E),w=(0,r.clean)(JSON.stringify(e));try{var b=(0,r.getTemplate)("podcast_row",e);y=g&&b?b:(0,r.getTemplate)("audio_row",e)}catch(e){return""}var I="";return h.hasTrackPage&&(_.push("audio_has_track_page"),I=`/audio${h.trackPageId}`),(0,d.isRadio)(h)&&_.push("audio_row--radio"),y=(y=(y=(y=(y=(y=(y=(y=(y=y.replace(/%cls%/,(()=>_.join(" ")))).replace(/%duration%/,(()=>m))).replace(/%serialized%/,(()=>w))).replace(/%cover_image%/,(()=>{return e=P,t=h.title,e?`<img class='audio_row__cover' alt='${t}' src='${e}' loading='lazy' decoding='async' width='40' height='40' />`:`<div class='audio_row__cover audio_row__without_cover'>${(0,s.getIcon24Song)().icon}</div>`;var e,t}))).replace(/%performers%/,(()=>v))).replace(/%track_url%/,(()=>I))).replace(/%duration_mod%/,(()=>n(E)))).replace(/%chart_info_position%/,(()=>{return(t=e[o.AudioUtils.AUDIO_ITEM_CHART_INFO_INDEX]&&e[o.AudioUtils.AUDIO_ITEM_CHART_INFO_INDEX].position)?`<div class="audio_row__position">${t}</div>`:"";var t}))).replace(/%chart_info_state%/,(()=>function(e){var t="";switch(e){case 0:t="audio_row__state-new_release";break;case 1:t="audio_row__state-no_changes";break;case 2:t="audio_row__state-moved_up";break;case 3:t="audio_row__state-moved_down";break;case 4:t="audio_row__state-crown";break;default:t=""}return t?`<div class="audio_row__state ${t}"></div>`:""}(e[o.AudioUtils.AUDIO_ITEM_CHART_INFO_INDEX]&&e[o.AudioUtils.AUDIO_ITEM_CHART_INFO_INDEX].state)))}},297065:(e,t,i)=>{"use strict";i.d(t,{editAudio:()=>o});var a=i(146143);function o(e,t,i){(0,a.showBox)("al_audio.php",{act:"edit_audio_box",aid:t.fullId,force_edit_hash:i},{params:{width:"456px",bodyStyle:"padding: 20px;",hideButtons:1},dark:1})}},280945:(e,t,i)=>{"use strict";i.d(t,{getActionIcon:()=>g});var a=i(111588),o=i(180805),s=i(500001),r=i(41850),l=i(198435),d=i(210747),n=i(567589),u=i(447666),_=i(254805),c=i(343189),p=i(705960),h={current_delete:(0,a.getIcon20Cancel)(),recoms_delete:(0,a.getIcon20Cancel)(),listened_delete:(0,a.getIcon20Cancel)(),delete:(0,a.getIcon20Cancel)(),restore_recoms:(0,o.getIcon20Add)(),more:(0,s.getIcon20More)(),edit:(0,r.getIcon20WriteOutline)(),recoms:(0,l.getIcon20Stars)(),lyrics:(0,d.getIcon20TextTtOutline)()};function g(e){var t=h[e],i="";if(t)i=y(t);else switch(e){case"add":i=y((0,n.getIcon20Check)())+y((0,o.getIcon20Add)());break;case"next":i=`<div class="audio_row__icon--horizontal">${y((0,u.getIcon20ListPlayOutline)())+y((0,_.getIcon20ListAddOutline)())}</div>`;break;case"fave":i=y((0,c.getIcon24FavoriteOutline)())+y((0,p.getIcon24Favorite)())}return i}function y(e){return`<div class="audio_row__icon audio_row__icon_${e.name}">${e.icon}</div>`}},183489:(e,t,i)=>{"use strict";function a(){return window.audioAddRestoreInfo||(window.audioAddRestoreInfo={}),window.audioAddRestoreInfo}i.d(t,{getAddRestoreInfo:()=>a})},377673:(e,t,i)=>{"use strict";i.d(t,{getAudioFromEl:()=>s});var a=i(873589),o=i(819086);function s(e,t){e=(0,a.domClosest)("_audio_row",e);var i=(0,a.data)(e,"audio")||JSON.parse((0,a.domData)(e,"audio"));if(!i)return null;if(t){(i=o.AudioUtils.audioTupleToAudioObject(i)).isDeleted=(0,a.hasClass)(e,"audio_row__deleted"),i.isCurrent=(0,a.hasClass)(e,o.AudioUtils.AUDIO_CURRENT_CLS),i.isPlaying=(0,a.hasClass)(e,o.AudioUtils.AUDIO_PLAYING_CLS),i.isFromCurrentPlaylist=!!(0,a.gpeByClass)("_audio_section__current",e),i.isFromAutoplay=!!(0,a.gpeByClass)("Autoplay--container",e),i.isNumeric=!!(0,a.gpeByClass)("audio_numeric",e),i.isWithCovers=!!(0,a.gpeByClass)("audio_w_covers",e),i.withInlinePlayer=!i.isWithCovers&&!(0,a.gpeByClass)("audio_no_inline_player",e),i.isInSnippet=!!(0,a.gpeByClass)("_audio_pl_snippet__list",e),i.isInEditBox=!!(0,a.gpeByClass)("_audio_pl_edit_box",e),i.isInRecomsBlock=!!(0,a.gpeByClass)("_audio_recoms_blocks",e),i.isInFastChat=!!(0,a.gpeByClass)("fc_tab",e),i.isInAttach=!!(0,a.gpeByClass)("media_preview",e),i.isSetClaimed=(0,a.hasClass)(e,"audio_moder_claimed"),i.isPodcastListSnippet=(0,a.hasClass)(e,"podcast_list_snippet");var s=(0,a.gpeByClass)("_audio_pl",e);i.isCurrentAlbumSnippet=!!i.album&&!!s&&s.dataset.playlistId===`playlist_${i.album[0]}_${i.album[1]}`}return i}},502830:(e,t,i)=>{"use strict";i.d(t,{onAudioChoose:()=>l});var a=i(342269),o=i(70162),s=i(873589),r=i(152278);function l(e,t,i,l){if((0,a.isUndefined)(t.selected)){var d=cur.attachCount&&cur.attachCount()||0,n=i.fullId+(i.accessKey?"_"+i.accessKey:"");if(cur.chooseMedia("audio",n,l),(!cur.attachCount||cur.attachCount()>d)&&cur.lastAddMedia){t.selected=cur.lastAddMedia.chosenMedias.length-1,(0,s.addClass)((0,s.domPN)(t),"audio_selected");var u=(0,s.getSize)(t)[0];(0,s.setStyle)(t,"width",u),t.innerHTML=o.getLang("global_cancel")}}else cur.lastAddMedia.unchooseMedia(t.selected),t.selected=void 0,(0,s.removeClass)((0,s.domPN)(t),"audio_selected"),t.innerHTML=o.getLang("global_add_media");return(0,r.cancelEvent)(e)}},760553:(e,t,i)=>{"use strict";i.d(t,{onRowLeave:()=>o});var a=i(873589);function o(e){(0,a.data)(e,"leaved",!0);var t=(0,a.data)(e,"tt");if((!t||!t.isShown())&&(clearTimeout(window.audioRowHoverTO),(0,a.data)(e,"actions"))){var i=(0,a.geByClass1)("_audio_row__actions",e),o=(0,a.geByClass1)("_audio_row__duration",e);(0,a.re)(i),(0,a.setStyle)(o,"visibility","visible"),(0,a.data)(e,"actions",0)}}},748499:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{onRowOver:()=>onRowOver});var _web_lib_dom__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(873589),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(819086),_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(274642),_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(70162),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(152278),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(342269),_web_audio_player_track_getActionIcon__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(280945);function onRowOver(audioEl,event,forceRedraw){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(audioEl,"podcast_list_snippet")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(audioEl,"podcast_snippet__controls")||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(audioEl,"leaved",!1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(audioEl,"actions")&&!forceRedraw||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(audioEl,"no_extra")||(clearTimeout(window.audioRowHoverTO),window.audioRowHoverTO=setTimeout((()=>{window.tooltips&&"function"==typeof window.tooltips.hideAll&&window.tooltips.hideAll(audioEl);var audio=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.getAudioFromEl(audioEl),audioObject=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.getAudioFromEl(audioEl,!0),playerUI=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayerUI)(),actions=[],moreActions=[],context=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.getContextPlaylist(audioEl,!0),_AudioUtils$contextSp=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.contextSplit(context),sectionContext=_AudioUtils$contextSp[0],blockContext=_AudioUtils$contextSp[1],extra=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.getAudioExtra(audioObject);if(context=sectionContext,audioObject.isDeleted)if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.isPodcast(audioObject))actions.push(["add",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.restoreEpisode,"",'onmouseover="audioShowActionTooltip(this)"']);else if("recoms_recoms"===context)actions.push(["restore_recoms",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.addAudio,"",'onmouseover="audioShowActionTooltip(this)"']);else{var deleteRestoreInfo=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.getAddRestoreInfo();deleteRestoreInfo[audioObject.fullId]&&deleteRestoreInfo[audioObject.fullId].deleteAll&&actions.push(["delete",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.deleteAudio,"",'onmouseover="audioShowActionTooltip(this)"']),actions.push(["add",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.addAudio,"",'onmouseover="audioShowActionTooltip(this)"'])}else{var actionsList=["next","add","share","open_album","add_to_playlist"];if(extra.claim&&nav.objLoc.claim||audioObject.isReplaceable)actionsList=[];else if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.isPodcast(audioObject))actionsList=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(audioEl,"audio_podcast_no_actions")?[]:["fave","edit","delete","open_episode","share"];else if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.isExternalStream(audioObject))actionsList=[];else if(audioObject.isFromCurrentPlaylist)actionsList=["recoms","add",!audioObject.isCurrent&&"delete","share","open_album","add_to_playlist"];else if(audioObject.isInSnippet)actionsList=["recoms","next","edit","add","share","open_album","add_to_playlist"];else if(audioObject.isInEditBox)actionsList=[];else if(audioObject.isInFastChat)actionsList=["add"];else if(vk.widget)actionsList=["add"];else if(context)if("my_audios_block"===blockContext)actionsList=["recoms","edit","next","add","delete","share","open_album","add_to_playlist"];else switch(context){case"search_results":"search_owned_audios"===blockContext&&(actionsList=["recoms","edit","next","add","delete","share","open_album","add_to_playlist"]);break;case"catalog":actionsList=["recoms","edit","next","add","delete","share","open_album","add_to_playlist"];break;case"album_page":actionsList=["recoms","next","edit","add","share","open_album","add_to_playlist"];break;case"my":case"my_audios_short":case"module":case"user_list":case"group_list":actionsList=[playerUI.lyrics.enabled&&"lyrics","recoms","edit","next","add","delete","share","open_album","add_to_playlist"].filter(Boolean);break;case"edit_playlist":actionsList=["add","next","edit"];break;case"attach":case"attach_preview":case"podcast":actionsList=[];break;case"apps_edit":actionsList=["apps_edit_delete"];break;case"clips":case"clip_effect_list":audioObject.isOriginalSound&&(actionsList=[]);break;default:audioObject.isCurrent&&audioObject.withInlinePlayer&&(actionsList=["recoms","add","share","open_album","add_to_playlist"])}("moderation_video"===context||window.AdminVideoCatalogue)&&(actionsList=["link_to_clip"]),actionsList.push("uma"),audioObject.isReplaceable&&actionsList.push("replace"),extra.moder_actions&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.each)(extra.moder_actions,((i,act)=>{moreActions.push(["moder_"+i,(audioEl,audio)=>{eval(act[1])},act[2]])})),audioObject.isCurrentAlbumSnippet&&(actionsList=actionsList.filter((e=>"open_album"!==e))),vk.id||(actionsList=actionsList.filter((e=>"open_album"===e)));var ap=(0,_web_lib_feature_entries__WEBPACK_IMPORTED_MODULE_2__.getAudioPlayer)(),addDeleteAction=()=>{audioObject.isFromCurrentPlaylist?audioObject.isFromAutoplay||audioObject.isCurrent||actions.push(["current_delete",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.deleteCurrentAudio,"",'onmouseover="audioShowActionTooltip(this)"']):audioObject.canDelete&&!vk.widget&&actions.push(["delete",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.isPodcast(audioObject)?_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.deleteEpisode:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.deleteAudio,"",'onmouseover="audioShowActionTooltip(this)"'])},currentAudioPage=window.currentAudioPage&&window.currentAudioPage(audioEl),isInLayer=currentAudioPage&&currentAudioPage.isLayer(),shouldShowEdit=!isInLayer&&audioObject.canEdit&&!vk.widget;actionsList.forEach((e=>{switch(e){case"next":audioObject.isCurrent||audioObject.isClaimed||_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.isPodcast(audioObject)||actions.push(["next",ap.setNext.bind(ap),"",'onmouseover="audioShowActionTooltip(this)"']);break;case"restore_recoms":actions.push(["restore_recoms",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.addAudio,"",'onmouseover="audioShowActionTooltip(this)"']);break;case"add":var t=vk.id;cur.audioPage&&cur.audioPage.canAddToGroup()&&cur.audioPage.getOwnerId()!==audioObject.ownerId&&(t=cur.audioPage.getOwnerId()),!audioObject.isClaimed&&audioObject.canAdd&&audioObject.ownerId!=t&&actions.push(["add",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.addAudio,"",'onmouseover="audioShowActionTooltip(this)"']);break;case"recoms":!audioObject.isClaimed&&cur.audioPage&&actions.push(["recoms",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.showRecoms,"",'onmouseover="audioShowActionTooltip(this)"']);break;case"uma":audioObject.isUMA&&actions.push(["uma",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.getUMAInfo,"UMA"]);break;case"replace":audioObject.isReplaceable&&actions.push(["replace",()=>{showAudioClaimWarning(audioObject,extra.claim,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.replaceWithOriginal.bind(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils,audioEl,audioObject))},_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("global_audio_replace")]);break;case"edit":shouldShowEdit&&actions.push(["edit",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.isPodcast(audioObject)?_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.editEpisode:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.editAudio,"",'onmouseover="audioShowActionTooltip(this)"']);break;case"delete":addDeleteAction();break;case"apps_edit_delete":actions.push(["delete",window.AppsEdit.removeAudio,"",'onmouseover="AppsEdit.showRemoveAudioTooltip(this)"']);break;case"fave":_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.isPodcast(audioObject)&&actions.push(["fave",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.faveEpisode,"",'onmouseover="audioShowActionTooltip(this)"',_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.getAudioExtra(audioObject).fave?" activated":""]);break;case"share":audioObject.isClaimed||moreActions.push(["share",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.shareAudio,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("audio_share_audio")]);break;case"add_to_playlist":audioObject.isClaimed||cur.viewAsBox||moreActions.push(["add_to_playlist","",_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("audio_add_to_playlist")]);break;case"open_album":!audioObject.isClaimed&&audioObject.album&&moreActions.push(["open_album",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.showAudioAlbum,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("audio_open_album")]);break;case"open_episode":_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.isPodcast(audioObject)&&moreActions.push(["open_episode",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.openEpisode,_shared_lib_langs__WEBPACK_IMPORTED_MODULE_3__.getLang("audio_podcast_open_episode")]);break;case"lyrics":audioObject.hasLyrics&&actions.push(["lyrics",()=>{playerUI.lyrics.open({audio,playlist:context.playlist,context:audioObject.context||context.context})},"",'onmouseover="audioShowActionTooltip(this)"'])}})),extra.claim&&nav.objLoc.claim&&(audioObject.isSetClaimed?actions.push(["claim_btn",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.unclaim.bind(this,audio,audioEl,extra.claim),"Unclaim"]):actions.push(["claim_btn",_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.claim.bind(this,audio,audioEl,extra.claim),"Claim"]))}if(moreActions.length&&actions.push(["more"]),actions.length){var actionsEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.se)('<div class="_audio_row__actions audio_row__actions"></div>');actions.forEach((e=>{var t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.getRowActionName(e[0],audioObject,audioEl),i=(0,_web_audio_player_track_getActionIcon__WEBPACK_IMPORTED_MODULE_6__.getActionIcon)(e[0]),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.se)(`<button\naria-label="${t}"\ndata-action="${e[0]}"\nclass="audio_row__action audio_row__action_${e[0]} _audio_row__action_${e[0]}${e[4]?" "+e[4]:""}" ${e[3]||""}>\n${e[2]||i}\n</button>`);e[1]&&a.addEventListener("click",(t=>(e[1]&&e[1].call(window,audioEl,audioObject),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.cancelEvent)(t)))),actionsEl.appendChild(a)}));var rectoreInfo=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.getAddRestoreInfo(),audioRestorationInfo=rectoreInfo[audioObject.fullId];audioRestorationInfo&&rectoreInfo[audioRestorationInfo.addedFullId]&&(audioRestorationInfo=null),audioRestorationInfo&&"added"===audioRestorationInfo.state&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(audioEl,"audio_row__added");var rowInfoEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("_audio_row__info",audioEl),rowDurationEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("_audio_row__duration",audioEl),rowAlreadyActionsEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("_audio_row__actions",audioEl);if(!rowInfoEl)return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)(rowAlreadyActionsEl),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(rowDurationEl,"visibility","hidden"),rowInfoEl.appendChild(actionsEl);var moreActionsBtnEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("_audio_row__action_more",actionsEl);moreActions.length&&moreActionsBtnEl&&setMoreAction(audioEl,audio,audioObject,moreActions,moreActionsBtnEl),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(audioEl,"actions",1)}audioObject.showInfo&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.showAudioInfo(audioEl,audioObject,!1)}),forceRedraw?0:10)))}function setMoreAction(e,t,i,a,o){var s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.gpeByClass)("im-page_classic",e),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.gpeByClass)("_im_peer_history_w",e),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.gpeByClass)("_im_peer_history",e),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.gpeByClass)("_im_chat_body_abs",e),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.se)('<div class="_audio_row__more_actions audio_row__more_actions"></div>'),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.gpeByClass)("wk_history_audio_content",e),_=e.closest(".CatalogBlock"),c={};l?(c.getWrapEl=()=>s?null:d,c.appendTo=l):u?c.appendTo=u:_?c.appendTo=_:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.gpeByClass)("post",e)?c.appendTo=document.body:c.appendToParent=!0;var p=new ElementTooltip(o,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_5__.extend)({cls:"_audio_row__tt",defaultSide:"bottom",rightShift:20,content:n,bottomGap:s&&r?parseInt((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getStyle)(r,"border-bottom-width"))+30+150:150,preventSideChange:!0,autoShow:!0,onFirstTimeShow:function(e,t){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)(t,"nodrag",1),setTimeout(function(){this.getOptions().bottomGap=0}.bind(this))},onHide:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(e,"leaved")&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.onRowLeave(e)}},c));a.forEach((a=>{var o,s,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.se)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.rs)(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.AUDIO_ROW_ACTION_ROW_ITEM,a));"add_to_playlist"===a[0]?(r.addEventListener("mouseenter",o=()=>{clearTimeout(s),s=setTimeout((()=>{r.removeEventListener("mouseenter",o),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.initRowPlaylistsChooser(t,r,p)}),150)}),r.addEventListener("click",(()=>{s||_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_1__.AudioUtils.initRowPlaylistsChooser(t,r,p)})),r.addEventListener("mouseleave",(()=>{clearTimeout(s)}))):r.addEventListener("click",(t=>(a[1].call(window,e,i),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.cancelEvent)(t))));n.appendChild(r)})),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.addEvent)(o,"click",(e=>{p.isShown()||p.show(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_4__.cancelEvent)(e)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(e,"tt",p)}},313462:(e,t,i)=>{"use strict";i.d(t,{replaceWithOriginal:()=>d});var a=i(873589),o=i(274642),s=i(722904),r=i(619416),l=i(624715);function d(e,t,i){(t=t||(0,o.getAudioPlayer)().getCurrentAudio())&&(t=(0,l.audioTupleToAudioObject)(t),ajax.post("al_audio.php",{act:"replace_with_original",hash:t.replaceHash,audio_id:t.fullId},{onDone:function(o){var l=JSON.parse(t.extra).claim.original;l[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]=o,l[s.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]=t.ownerId;var d=(0,a.se)((0,r.drawAudio)(l));e.parentElement.insertBefore(d,e),e.parentElement.removeChild(e),i&&i()},onFail:()=>(i(),!0)}))}},204732:(e,t,i)=>{"use strict";i.d(t,{shareAudio:()=>u});var a=i(53721),o=i(274642),s=i(146143),r=i(501389),l=i(837565),d=i(704042),n=i(624715);function u(e,t){if(cur.viewAsBox)return cur.viewAsBox();if(t=t||(0,o.getAudioPlayer)().getCurrentAudio()){t=(0,n.audioTupleToAudioObject)(t);var i=(0,d.isPodcast)(t)?"podcast":"audio";return(0,l.onAdditionalEvent)(e,t,{type:a.TYPE_SHARE_AUDIO}),!(0,s.showBox)("like.php",{act:"publish_box",object:i+t.fullId,list:t.actionHash,to:"mail"},{stat:["page.js","page.css","wide_dd.js","wide_dd.css",window.jsc("web/sharebox.js")],onFail:function(e){return(0,r.showDoneBox)(e),!0},params:{shareButtonElement:e}})}}},167694:(e,t,i)=>{"use strict";i.d(t,{showAudioRestriction:()=>P});var a=i(624715),o=i(70162),s=i(501389),r=i(342269),l=i(619416),d=i(722904),n=i(873589),u=i(67328),_=i(274642),c=i(146143),p=i(315882),h=i(733164),g=i(124041),y=i(691033),A=i(301061);function f(e){var t=g.FlatButton.render({children:o.getLang("global_close"),appearance:g.FlatButtonAppearance.PRIMARY,size:g.FlatButtonSize.M,restAttrs:{onclick:"curBox().hide()"}});(0,c.showFastBox)({hideButtons:!0,title:!1,containerClass:"audio_restriction_box",onHide:()=>{(0,p.statlogsValueEvent)("audio_restriction_popup","hide",e.restrictionStatus)}},`\n    <button class="audio_restriction_box__close" onclick="curBox().hide()" aria-label="${o.getLang("global_close")}">\n      ${(0,y.getIcon24Cancel)().icon}\n    </button>\n    <div class="audio_restriction_box__icon">${(0,A.getIcon56PensiveFace)().icon}</div>\n    <div class="audio_restriction_box__title">${o.getLang("audio_restriction_title_claim")}</div>\n    <div class="audio_restriction_box__controls">\n      ${t}\n    </div>\n  `)}function P(e,t){if(void 0===t&&(t={}),!e)return!1;if((e=(0,a.audioTupleToAudioObject)(e)).restrictionStatus){if(e.actionHash){(0,p.statlogsValueEvent)("audio_restriction_popup","show",e.restrictionStatus);var i=(0,c.showBox)("al_audio.php",{act:"restriction_box",audio_id:e.id,owner_id:e.owner_id,hash:e.actionHash},{params:{hideButtons:!0,onShow:function(){var i=(0,s.curBox)();(0,h.isFunction)(t.onShow)&&t.onShow(),i&&i.once("click:ok",(()=>{(0,p.statlogsValueEvent)("audio_restriction_popup","click",e.restrictionStatus)}))},onHide:i=>{(0,h.isFunction)(t.onHide)&&t.onHide(),i||(0,p.statlogsValueEvent)("audio_restriction_popup","hide",e.restrictionStatus)}},containerClass:"audio_restriction_box audio_restriction_box_type_"+e.restrictionStatus,onDone:(t,i)=>{if(i&&i.play){t.hide();var o=function(e){var t=(0,n.geByClass)("_audio_row_"+e.fullId);if(!t||!t.length)return!1;var i=(0,u.parseJSON)((0,n.domData)(t[0],"audio"));if(!i)return!1;var a=(0,u.parseJSON)(i[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]);a&&delete a.claim,i[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION]=0,i[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS]&=~d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CLAIMED_BIT,i[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]=JSON.stringify(a);var o=(0,_.getAudioPlayer)().getCurrentPlaylist(),s=(0,n.se)((0,l.drawAudio)(i,"no_extra"));if(o){var c=i[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+i[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID],p=o.getAudio(c);p&&(p[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION]=i[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION],p[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS]=i[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS],p[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]=i[d.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA])}return(0,r.each)(t,((e,t)=>{var a=e>0?(0,n.se)((0,l.drawAudio)(i,"no_extra")):s;t.parentElement.insertBefore(a,t),t.parentElement.removeChild(t)})),s}(i.audio?(0,a.audioTupleToAudioObject)(i.audio):e),s=(0,_.getAudioPlayer)();o&&s.toggleAudio(o,{target:o})}},onFail:()=>(i&&i.hide(),f(e),!0)})}else f(e);return!0}return!1}},53531:(e,t,i)=>{"use strict";i.d(t,{toggleAudioLyrics:()=>s});var a=i(873589),o=i(819086);function s(e,t){var i=(0,a.geByClass1)("_audio_row__lyrics",e);if(i){if((0,a.toggle)(i)){var s=(0,a.getSize)(e)[1],r=(0,a.getSize)(i)[1];(0,a.setStyle)(e,"height",s+r),(0,a.data)(e,"prevHeight",s)}else{var l=(0,a.data)(e,"prevHeight");(0,a.setStyle)(e,"height",l)}}else{(0,a.addClass)(e,"audio_loading");var d={act:"get_lyrics",aid:t.fullId,lid:t.lyrics};o.AudioUtils.isPodcast(t)&&(d.podcast=!0),ajax.post("al_audio.php",d,{onDone:function(s){(0,a.removeClass)(e,"audio_loading"),i=(0,a.se)(`<div class="_audio_row__lyrics audio_row__lyrics" data-nodrag="1" style="display:none;"><div class="audio_row__lyrics_inner">${s}</div></div>`),(0,a.geByClass1)("_audio_row_content",e).appendChild(i),o.AudioUtils.toggleAudioLyrics(e,t)},onFail:()=>!0})}}},918812:(e,t,i)=>{"use strict";i.d(t,{unclaim:()=>r});var a=i(873589),o=i(748499),s=i(624715);function r(e,t,i){(0,a.removeClass)(t,"audio_moder_claimed"),(0,o.onRowOver)(t,!1,!0),e=(0,s.audioTupleToAudioObject)(e),window.ajax.post("al_claims.php",{act:"a_unclaim",claim:i,type:"audio",id:e.id,owner_id:e.ownerId,hash:e.actionHash})}},895754:(e,t,i)=>{"use strict";i.d(t,{initUpload:()=>c});var a=i(722122),o=i(873589),s=i(819086),r=i(840060),l=i(101178),d=i(70162),n=i(501389),u=i(342269),_=i(555030);function c(e,t,i,c,p,h,g,y,A,f,P,v){cur.loadAudioDone=function(t,i){if(cur.audioPage){if(cur.boxClose&&cur.audioPage.onAudioAllUploaded(),cur.audioPage.onAudioUploaded(t,i),cur.boxClose){delete cur.boxClose;var a=cur.audiosLoaded>1?d.getLang("audio_success_msg_multiple"):d.getLang("audio_success_msg");e.setOptions({title:d.getLang("audio_uploading_over"),bodyStyle:"padding: 16px 23px;"}),e.content(a),(0,o.hide)(e.progress),setTimeout((function(){e.hide(200)}),2e3),delete cur.audiosLoaded,_tbLink&&_tbLink.loc&&(cur.__phinputs=cur.__phinputs||[],(0,l.globalHistoryDestroy)(_tbLink.loc))}}else cur.boxClose&&nav.go("/audios"+i[s.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID],!1,{onDone(){cur.__phinputs=cur.__phinputs||[],(0,l.globalHistoryDestroy)(nav.objLoc[0])}})},cur.loadAudioFailed=function(i,a){(0,o.hide)(e.progress),Upload.embed(i);var s=(0,o.ge)("audio_new_error"),r=s&&(0,o.domFC)(s),l=a.split("|");r&&(a=l[0],l=l[1],r.innerHTML=l||(t[a]||d.getLang("audio_loading_error").replace("{code}",(0,u.intval)(a))),(0,o.show)(s))},Upload.init("audio_add_upload_btn",i,c,{file_name:"file",file_size_limit:p,file_types_description:"Audio files (*.mp3)",file_types:"*.mp3;*.MP3",accept:"audio/mpeg",lang:h,onUploadStart:function(t,i){"form"===Upload.types[t]&&(0,o.show)(e.progress),"form"!==Upload.types[t]&&"fileApi"!==Upload.types[t]||((0,o.geByClass1)("file",(0,o.ge)("audio_add_upload_btn")).disabled=!0),(0,n.curBox)().changed=!0},onUploadProgress:function(e,t,i){if(!(0,o.ge)("form"+e+"_progress")){for(var a=Upload.obj[e],s=(0,o.getSize)(a)[1]/2+10,l=a.firstChild;l;)1===l.nodeType&&(l.id==="uploader"+e&&r.browser.msie?(0,o.setStyle)(l,{position:"relative",left:"-5000px"}):(0,o.setStyle)(l,{visibility:"hidden"})),l=l.nextSibling;a.appendChild((0,o.ce)("div",{innerHTML:'<div class="audio_progress_wrap"><div id="form'+e+'_progress" class="audio_progress" style="width: 0%;"></div></div></div>'},{height:s+"px",marginTop:-s+"px"}))}var d=(0,u.intval)(t/i*100);(0,o.setStyle)((0,o.ge)("form"+e+"_progress"),{width:d+"%"})},onUploadComplete:function(e,t){var i;this.use_go_uploader||(t=t.replace(/\+/g," "));try{i=JSON.parse(t)}catch(e){i=(0,_.fromQueryString)(t)}var o={};this.use_go_uploader?o={act:"done_add",upldr:1,go_uploader_response:t}:(i.title=decodeURIComponent(i.title),i.artist=decodeURIComponent(i.artist),o=(0,a.default)({},i,{},{act:"done_add",upldr:1})),i.code?cur.loadAudioFailed(e,i.code):ajax.post("al_audio.php",o,{onDone:function(t){cur.loadAudioDone(e,t)},onFail:function(t){return cur.loadAudioFailed(e,t),!0}})},onUploadCompleteAll:function(e,t){cur.boxClose=!0},onUploadError:cur.loadAudioFailed,clear:1,multiple:1,force_max_files:!0,max_files:g,max_files_hide_last:1,type:"audio",max_attempts:3,reverse_files:1,server:y,error:A,error_hash:f,dropbox:"choose_audio_dropbox",use_go_uploader:v}),e.setControlsText(P)}},433102:(e,t,i)=>{"use strict";i.d(t,{getUMAInfo:()=>o});var a=i(146143);function o(e,t){t.isInEditBox||(0,a.showBox)("al_audio.php",{act:"get_uma_restrictions",id:t.id,owner_id:t.owner_id,hash:t.actionHash},{params:{width:1e3}})}},472606:(e,t,i)=>{"use strict";i.d(t,{getUMAInfoAlbum:()=>o});var a=i(146143);function o(e,t){t.isInEditBox||(0,a.showBox)("al_audio.php",{act:"get_uma_restrictions_album",playlist_raw_id:e},{params:{width:750}})}},819086:(e,t,i)=>{"use strict";i.d(t,{AudioUtils:()=>Ne});var a=i(722122),o=i(722904),s=i(847873),r=i(53531),l=i(273712),d=i(748499),n=i(760553),u=i(506878),_=i(787632),c=i(121718),p=i(806734),h=i(416148),g=i(204732),y=i(543688),A=i(917528),f=i(313462),P=i(297065),v=i(668327),E=i(462951),m=i(399245),w=i(314449),b=i(775950),I=i(865429),C=i(25890),T=i(402803),L=i(310804),O=i(780477),D=i(863477),k=i(502830),S=i(486722),U=i(807772),x=i(220697),M=i(495468),R=i(156453),B=i(989191),N=i(365506),j=i(183489),W=i(569011),F=i(536107),K=i(965495),H=i(398237),Y=i(436030),V=i(454746),G=i(619416),Q=i(927313),X=i(377673),$=i(408357),q=i(624715),z=i(699256),J=i(977136),Z=i(162632),ee=i(677060),te=i(814979),ie=i(918812),ae=i(433102),oe=i(472606),se=i(735537),re=i(318801),le=i(528924),de=i(954020),ne=i(704042),ue=i(262121),_e=i(309427),ce=i(144670),pe=i(404621),he=i(501037),ge=i(864200),ye=i(167694),Ae=i(851887),fe=i(816024),Pe=i(642687),ve=i(972224),Ee=i(122992),me=i(267919),we=i(285132),be=i(291976),Ie=i(680353),Ce=i(561737),Te=i(895754),Le=i(477951),Oe=i(759375),De=i(150525),ke=i(944568),Se=i(341487),Ue=i(719927),xe=i(333097),Me=i(896438),Re=i(166773),Be=i(890458),Ne=(0,a.default)({},o.AUDIO_PLAYER_ENUMS,{audioSearchPerformer:s.audioSearchPerformer,toggleAudioLyrics:r.toggleAudioLyrics,getRowActionName:l.getRowActionName,initRowPlaylistsChooser:c.initRowPlaylistsChooser,addToPlaylistsBoxInit:p.addToPlaylistsBoxInit,showRecoms:h.showRecoms,shareAudio:g.shareAudio,showAudioAlbum:y.showAudioAlbum,openEpisode:A.openEpisode,replaceWithOriginal:f.replaceWithOriginal,editAudio:P.editAudio,editEpisode:v.editEpisode,deleteCurrentAudio:E.deleteCurrentAudio,deleteRecomsAudio:m.deleteRecomsAudio,deleteListenedAudio:w.deleteListenedAudio,deleteAudio:b.deleteAudio,deleteEpisode:I.deleteEpisode,restoreEpisode:C.restoreEpisode,deleteDeletedAudios:T.deleteDeletedAudios,faveEpisode:L.faveEpisode,contextSplit:O.contextSplit,showAudioPlaylist:D.showAudioPlaylist,editPlaylist:U.editPlaylist,followPlaylist:x.followPlaylist,getLayer:M.getLayer,updateQueueReceivedPost:R.updateQueueReceivedPost,toggleAudioHQBodyClass:B.toggleAudioHQBodyClass,hasAudioHQBodyClass:N.hasAudioHQBodyClass,getAddRestoreInfo:j.getAddRestoreInfo,getPlaylistAddRestoreInfo:W.getPlaylistAddRestoreInfo,addAudio:F.addAudio,addAudioToOwner:K.addAudioToOwner,chooseAudioBox:H.chooseAudioBox,getAudioArtistsString:Y.getAudioArtistsString,getAudioPerformers:V.getAudioPerformers,drawAudio:G.drawAudio,isClaimedAudio:Q.isClaimedAudio,getDurationMod:G.getDurationMod,getAudioExtra:Me.getAudioExtra,getAudioFromEl:X.getAudioFromEl,getAudioFullId:$.getAudioFullId,audioTupleToAudioObject:q.audioTupleToAudioObject,initDomPlaylist:z.initDomPlaylist,getContextPlaylist:J.getContextPlaylist,renderAudioDiag:ee.renderAudioDiag,claim:te.claim,unclaim:ie.unclaim,getUMAInfo:ae.getUMAInfo,getUMAInfoAlbum:oe.getUMAInfoAlbum,showAudioInfo:se.showAudioInfo,cancelReplacement:re.cancelReplacement,removeFromGroup:le.removeFromGroup,addToGroupBox:de.addToGroupBox,showAudioRestriction:ye.showAudioRestriction,isPodcast:ne.isPodcast,isArticleTts:ue.isArticleTts,isRadio:Re.isRadio,isExternalStream:Be.isExternalStream,isMarusiaTrack:_e.isMarusiaTrack,isMarusiaTale:ce.isMarusiaTale,isPrivatePodcast:pe.isPrivatePodcast,followArtist:Pe.followArtist,unfollowArtist:ve.unfollowArtist,followCurator:Ee.followCurator,unfollowCurator:me.unfollowCurator,followOwner:we.followOwner,unfollowOwner:be.unfollowOwner,trackArtistToOfficial:Ie.trackArtistToOfficial,PodcastsLogs:he,copyPlaylistLink:ge.copyPlaylistLink,getAlbumParts:Ae.getAlbumParts,drawAlbumPartRow:fe.drawAlbumPartRow,onRowOver:d.onRowOver,onRowLeave:n.onRowLeave,onAudioAddedToPlaylist:u.onAudioAddedToPlaylist,onAudioChoose:k.onAudioChoose,onPlaylistChoose:S.onPlaylistChoose,claimPlaylist:Ce.claimPlaylist,initUpload:Te.initUpload,turnPlaylistDiscover:Le.turnPlaylistDiscover,hidePlaylistFromRecoms:Oe.hidePlaylistFromRecoms,showPlaylistInRecoms:De.showPlaylistInRecoms,hideCatalogBlock:ke.hideCatalogBlock,mergeAudioTupleWithoutContext:Se.mergeAudioTupleWithoutContext,followRadiostation:Ue.followRadiostation,unfollowRadiostation:xe.unfollowRadiostation,_showPlaylistsChooser:_.showPlaylistsChooser,debugLog:Z.debugLog})},14004:(e,t,i)=>{"use strict";i.d(t,{connectListenQueue:()=>g});var a=i(511867),o=i(819086),s=i(274642),r=i(146143),l=i(143707),d=i(506770),n=null,u=null,_=!1,c=0,p=new a.WebQueueListener((function(e){if(e.failed)return void g(!0);for(var t=(0,s.getAudioPlayer)(),i=t.isPlaying(),a=t.getCurrentAudio(),l=o.AudioUtils.isPodcast(a),d=0;d<e.events.length;d++){var n=e.events[d].data;if("start"===n.type&&AudioPlayer.getDeviceId()!==n.uuid&&!u&&!l&&i){t.pausedByQueue=Date.now(),t.pause(),u=(0,r.showBox)("al_audio.php",{act:"start_playback_box",uuid:n.uuid,device_name:n.device_name},{params:{hideButtons:!0,onHide:()=>{u=!1}},containerClass:"audio_playback_box"});break}}})),h=new a.WebQueueListener((function(e){e.events.length&&e.events.forEach((e=>{1===e.data.product_id&&(vk.audioAdsConfig.enabled=!e.data.active)}))}));function g(e){if(window.Notifier&&vk.id){var t=window.ap&&(0,s.getAudioPlayer)(),i=t&&t.getCurrentAudio(),a=window.Notifier&&!vk.widget,r=!_&&i?p.listenQueueKey:h.listenQueueKey,u=o.AudioUtils.isPodcast(i);(e||a&&!u&&!r)&&(i||(0,d.partConfigEnabled)("audio_subscription_update"))&&function(e,t,i){void 0===e&&(e={});void 0===t&&(t=()=>{});void 0===i&&(i=()=>!0);ajax.post("al_audio.php",{act:"queue_params",audio_id:e.id,owner_id:e.owner_id,hash:e.actionHash},{onDone:t,onFail:i})}(i=i?o.AudioUtils.audioTupleToAudioObject(i):{},(e=>{var t=function(e){var t=(0,l.unpackQueues)(e);t.audio&&p.connect(t.audio);t.subscription&&h.connect(t.subscription);return t}(e);_=!i||!t.audio,(t.audio||t.subscription)&&(n&&clearTimeout(n),n=window.setTimeout((()=>g(!0)),3e4))}),(()=>(++c<3&&g(!0),!0)))}}},780477:(e,t,i)=>{"use strict";i.d(t,{contextSplit:()=>o});var a=i(733164);function o(e){return(0,a.isObject)(e)&&(e=e.context),(e||"").split(":")}},162632:(e,t,i)=>{"use strict";function a(){}i.d(t,{debugLog:()=>a})},234910:(e,t,i)=>{"use strict";i.d(t,{getContext:()=>s});var a=i(977136),o=i(780477);function s(e){var t,i=window.currentAudioPage&&window.currentAudioPage(e),s=i&&i.getPageCurrentPlaylist(),r=(0,a.getContextPlaylist)(e,!0);return r&&(r=(0,o.contextSplit)(r),Array.isArray(r)&&r.length>0&&(t=r[0])),("search"===t&&s&&s.getSearchQid()||"search"===window.cur.module&&window.cur.qid)&&(t="search:external"),t}},495468:(e,t,i)=>{"use strict";function a(){var e=window.audioLayer;return e||(window.audioLayer=e=new AudioLayer),e}i.d(t,{getLayer:()=>a})},773653:(e,t,i)=>{"use strict";i.d(t,{getPlaylistUrl:()=>o});var a=i(844142);function o(e,t,i,o){void 0===o&&(o=!1);var s=`/music/${a.Ranges.isOfficialPlaylist(e)?"album":"playlist"}/${e}_${t}${i?`_${i}`:""}`;return o?`${location.protocol}//${location.host}${s}`:s}},735537:(e,t,i)=>{"use strict";i.d(t,{showAudioInfo:()=>s});var a=i(312263),o=i(501389);function s(e,t,i){if(t.showInfo&&!e.dataset.showedInfo){e.dataset.showedInfo=!0;var s=t.performer.split("], "),r=s.length>1?s[1]:s[0],l=encodeURI(r+" - "+t.title),d=`<a href="/search?c[section]=audio&c[q]=${l}" target="_blank">Найти VK</a>`,n=`<a href="${t.adminUrl}?act=audio&raw_id=${t.fullId}" target="_blank">Admin</a>`,u=`<a href="/away.php?to=${encodeURIComponent(t.umaQueryUrl+"?query="+l)}" target="_blank">Найти UMA</a>`,_=document.createElement("div");_.classList.add("AudioInfo__container"),_.innerHTML=" • "+u+" • "+d+" • "+n,_.style.fontSize="x-small",i&&_.classList.add("AudioInfo__container--secondary");var c=document.createElement("span");c.innerText="ID: "+t.fullId,c.classList.add("AudioInfo__copyLink"),c.onclick=e=>{(0,a.copyTextToClipboard)(t.fullId).then((()=>{(0,o.showDoneBox)("ID аудиозаписи скопирован в буфер обмена")}))},e.parentElement.insertBefore(_,e.nextSibling),_.prepend(c)}}},969442:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>AudioLayer});var _lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(769488),_web_lib_cancel_stack__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(810890),_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(873589);class AudioLayer{static prepare(e){window.stManager.add([window.jsc("web/audio.js"),"audio.css",window.jsc("web/suggester.js"),window.jsc("web/auto_list.js"),window.jsc("web/indexer.js")],(()=>{e&&e()}))}constructor(){this._els={layerPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.ge)("top_audio_layer_place"),topPlayBtn:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.geByClass1)("_top_audio_player_play"),topNotaBtn:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.geByClass1)("TopNavBtn__audio"),topNotaBtnGroup:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.ge)("top_audio_btn_group")}}toggle(e,t){this._initTooltip();var i=this._els.tooltip,a=void 0!==e?e:!i.isShown();a&&this.initPage(),a?(i.show(),(0,_web_lib_cancel_stack__WEBPACK_IMPORTED_MODULE_1__.cancelStackPush)("top_audio",(()=>{this.toggle(!1,!0)}),!0)):(t||(0,_web_lib_cancel_stack__WEBPACK_IMPORTED_MODULE_1__.cancelStackPop)(),i.hide()),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.toggleClass)(this._els.topNotaBtn,"TopNavBtn--active",a)}hide(){this._els.tooltip.hide()}isShown(){return this._els.tooltip&&this._els.tooltip.isShown()}updatePosition(){return this._els.tooltip&&this._els.tooltip.updatePosition()}_layerPosition(){var e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getXY)(this._els.layerPlace),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getXY)("ts_wrap")[0]-e[0]-1,i=0;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.isVisible)(this._els.topNotaBtnGroup)?i=-t+((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getXY)(this._els.topNotaBtn)[0]-e[0])+15:i=-t+((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.getXY)(this._els.topPlayBtn)[0]-e[0])+3;return{left:t,top:-1,arrowPosition:i}}getPageInstance(){return this._page}getTemplate(){return`\n      <div class="audio_layer_container">\n        <div class="top_audio_loading">\n          ${(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.rs)(vk.pr_tpl,{id:"",cls:"pr_big"})}\n        </div>\n      </div>\n    `}_initTooltip(){this._els.tooltip||(this._els.container=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.se)(this.getTemplate()),this._els.tooltip=new ElementTooltip(this._els.layerPlace,{id:"audio_layer_tt",content:this._els.container,width:660,offset:[22,5],autoShow:!1,customShow:!0,setPos:this._layerPosition.bind(this),forceSide:"bottom",onHide:()=>{this._page&&this._page.onLayerHide()},onShow:()=>{this._page&&this._page.onLayerShow(this._initSection)}}))}initPage(){this._page||ajax.post("al_audio.php",{act:"layer",is_layer:1,section:window.ap.getCurrentPlaylist()?"current":"all"},{onDone:(html,data,templatesScript)=>{if(this._els.tooltip.isShown()){try{eval(templatesScript)}catch(e){(0,_lib_debug_tools__WEBPACK_IMPORTED_MODULE_0__.logEvalError)(e,templatesScript)}this._els.container.innerHTML=html,this._page=new AudioPage((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_2__.geByClass1)("_audio_page_layout",this._els.container),data),this._initSection=data.initSection||void 0,this._page.onLayerShow(this._initSection)}},onFail:()=>!0})}}},59786:(e,t,i)=>{"use strict";i.d(t,{AudioPlayer:()=>ie});var a=i(722122),o=i(887757),s=i(692137),r=i(819086),l=i(840060),d=i(372650),n=i(274642),u=i(70162),_=i(769488),c=i(733164),p=i(146143),h=i(798262),g=i(152278),y=i(683609),A=i(501389),f=i(828430),P=i(342269),v=i(43873),E=i(873589),m=i(51488),w=i(950280),b=i(53721),I=i(874411),C=i(695353),T=i(11807),L=i(937884),O=i(171171),D=i(827648),k=i(331811),S=i(624715),U=i(522683),x=i(767356),M=i(14004),R=i(511492),B=i(842772),N=i(341487),j=i(408357),W=i(506770),F=i(859866),K=i(273271),H=i(383611),Y=i(842776),V=i(414325),G=i(722904),Q=i(333765),X=i(166773),$=i(924583),q=i(746785),z=i(262121);function J(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Z(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}var ee={},te=(0,R.throttledPromise)((()=>{}),1500,!0);class ie{constructor(){if(this.ensureUrlReject=null,this._currentAudio=!1,this._isPlaying=!1,this._prevPlaylist=null,this._currentPlaylist=null,this._playlists=[],this.subscribers=[],this._statusExport={},this._currentPlayingRows=[],this._podcastsActionRef={},this._podcastsActionLastId={},this._allowPrefetchNext=!0,!vk.isBanned){r.AudioUtils.debugLog("Player creation"),this.eventBus=new k.EventBus,this._playlistQueue=new w.PlaylistQueue(new V.FetchService,this.eventBus);var e=new m.WebPlayerAdapter(this);this.stats=new b.AudioStats(e),this.lyrics=new Q.AudioLyricsProvider,this.ads=new T.AudioAds(this,ie.getVersion()),this.connectEvents(),(0,M.connectListenQueue)(),this._restoreVolumeState(),this._initImpl(),this._initEvents(),this._podcastCleanStates(),this._listenStatusExport(),setTimeout((()=>{this.restoreState(),r.AudioUtils.toggleAudioHQBodyClass(),this.updateCurrentPlaying()}));var t=new Y.WebMediaSessionAdapter(this);new H.AudioMediaSession(t).init()}}static getVersion(){return 15}static _sendLCNotification(){var e=window.Notifier;e&&e.lcSend("audio_start");try{window.Videoview&&Videoview.togglePlay(!1)}catch(e){}}static showHQLabel(e){return void 0===e?!!ie._lsGet(ie.LS_SHOW_HQ_LABEL):(e=!!e,ie._lsSet(ie.LS_SHOW_HQ_LABEL,e),r.AudioUtils.toggleAudioHQBodyClass(),e)}static getAudioElementsByAudioId(e,t){return(0,E.geByClass)(`_audio_row_${e}`,t)}static getDeviceId(){var e=ie._lsGet(ie.LS_UUID);return e||(e=O(),ie._lsSet(ie.LS_UUID,e)),e}static showSubscriptionPopup(){(0,p.showBox)("/al_audio.php",{act:"subscription_box"},{params:{containerClass:"audio_subscription_popup",grey:!0,width:520}})}static getDurationType(){return ie._lsGet(ie.LS_DURATION_TYPE)}static _setTabIcon(e){(0,d.setFavIcon)(ie.tabIcons[e])}static _getLsFullKey(e){return`${ie.LS_PREFIX}${e}_${vk.id}`}static _lsGet(e){var t=ls.get(ie._getLsFullKey(e));if(null!==t)return t;var i=ls.get(`${ie.LS_PREFIX}${e}`);return null!==i&&(ls.set(ie._getLsFullKey(e),i),ls.remove(`${ie.LS_PREFIX}${e}`)),i}static _lsSet(e,t){return ls.set(ie._getLsFullKey(e),t)}static _podcastGetStates(){return(ie._lsGet(ie.LS_PODCASTS)||ee).states||{}}static _podcastSetStates(e){var t=ie._lsGet(ie.LS_PODCASTS)||ee;t.states=e,ie._lsSet(ie.LS_PODCASTS,t),ee=t}static podcastToggleFave(e,t){if(t){t=r.AudioUtils.audioTupleToAudioObject(t);var i=r.AudioUtils.getAudioExtra(t).faveHash;i&&window.bookmarkPodcast(e,t.fullId,i)}}static podcastGetPlaybackRate(){return(ie._lsGet(ie.LS_PODCASTS)||ee).rate||1}static getLang(e){var t=(0,n.getAudioPlayer)();return t&&t.langs?t.langs[e]:e}static clearDeprecatedCacheKeys(){ie._iterateCacheKeys((e=>e===ie.LS_VER))}static clearOutdatedCacheKeys(){(ie._lsGet(ie.LS_SAVED)||0)<(0,c.vkNow)()-72e5&&ie._iterateCacheKeys(((e,t)=>!(0,P.inArray)(t,[ie.LS_PL,ie.LS_TRACK,ie.LS_PROGRESS])))}getCurrentAudioLs(){return ap.getCurrentAudio()||ie._lsGet(ie.LS_TRACK)||null}static clearAllCacheKeys(){ie._iterateCacheKeys((()=>!1)),(0,f.setCookie)("remixcurr_audio","",-1)}static _iterateCacheKeys(e){U.vkLocalStorage.getPrefixedKeys(`${ie.LS_KEY_PREFIX}_`).forEach((t=>{var i=t.split("_"),a=i[1],o=i[2];e(a,o)||U.vkLocalStorage.removeItem(o)}))}_initImpl(){this._impl&&this._impl.destroy();var e=0,t=!1,i=t=>{if(-1!==e){if(t&&(e++,this.implTaskManager.delay(200),e>3)){e=-1;var i=new window.MessageBox({title:u.getLang("global_error")}).content(u.getLang("audio_error_loading")).setButtons("Ok",(function(){e=0,(0,A.curBox)().hide()}));return i.show(),(0,C.setWorkerTimeout)((function(){e=0,i.hide()}),3e3),this.notify(L.events.ENDED),void this.notify(L.events.FAILED)}r.AudioUtils.isPodcast(this.getCurrentAudio())?(this.setIsPlaying(!1),this.notify(L.events.PAUSE),this.notify(L.events.ENDED),this.stop()):this._repeatCurrent?(this._autoNext=!0,this.notify(L.events.ENDED),this.notify(L.events.PROGRESS,0),this.implTaskManager.seekImmediate(0),(0,C.setWorkerTimeout)((()=>{this._impl&&this._impl.clearAudioNode&&(this._impl.stop(),this._implSetUrl(this.getCurrentAudio())),this._implPlay()}))):(this.setIsPlaying(!1),this.notify(L.events.ENDED),this.playNext(!0))}},a={onPause:()=>{this.setIsPlaying(!1),this.notify(L.events.PAUSE),t=!1},onPlay:()=>{this.setIsPlaying(!0),this.setVolume(this.getVolume()),this.notify(L.events.PLAY),t=!1},onBufferUpdate:e=>{this.notify(L.events.BUFFERED,e)},onEnd:i,onFail:()=>{this._sendPlayerErrorStats(this._impl),i(!0)},onCanPlay:()=>this.notify(L.events.CAN_PLAY),onProgressUpdate:(e,i)=>{var a=this.getCurrentAudio();if(!this._muteProgressEvents&&a){var o=this._impl.getDuration()||a[r.AudioUtils.AUDIO_ITEM_INDEX_DURATION];this.notify(L.events.PROGRESS,e,o,i),!vk.id&&o-i<ie.UNAUTH_FADE_TIME&&!t&&(t=!0,this.fadeOut(1e3*ie.UNAUTH_FADE_TIME))}},onFrequency:e=>{this.notify(L.events.FREQ_UPDATE,e)},defaultVolume:this._userVolume};this._impl=new I.AudioPlayerHTML5(a),this.implTaskManager=new x.AudioTaskManager(this._impl),this.implTaskManager.setVolume(0)}fadeIn(e){void 0===e&&(e=300),this.implTaskManager.setVolume(this.getVolume(),!0,e)}fadeOut(e){void 0===e&&(e=300),this.implTaskManager.setVolume(0,!0,e)}onMediaKeyPressedEvent(e){if(this.getCurrentAudio())switch(e.keyCode){case 179:this.isPlaying()?this.pause():this.play();break;case 178:this.seek(0),this.pause();break;case 177:this.playPrev();break;case 176:this.playNext()}}setAdsConfig(e){this.ads&&this.ads.setAdsConfig(e)}deletePlaylist(e){for(var t=0;t<this._playlists.length;t++)this._playlists[t]===e&&this._playlists.splice(t,1)}mergePlaylistData(e,t){this._playlists.forEach((i=>{i.getId()===e.getId()&&i.getOwnerId()===e.getOwnerId()&&(i.hasMore()?i.mergeWith(t):i.mergeInfo(t))}))}deleteCurrentPlaylist(){this.getPlaylistQueue().removeSortedList(),delete this._currentAudio,delete this._currentPlaylist,this.notify(L.events.UPDATE),this.notify(L.events.PLAYLIST_CHANGED),this.stop(),this.updateCurrentPlaying()}updateCurrentPlaying(e){e=!!e;var t=r.AudioUtils.audioTupleToAudioObject(this.getCurrentAudio()),i=[];if(t){var a=(0,E.geByClass)("_audio_row_"+t.fullId);i=i.concat([].slice.call(a))}var o=document.querySelectorAll(".AudioRadiostationItem"),s=(0,X.isRadio)(t)&&this.isPlaying();Array.from(o).forEach((e=>{e.classList.toggle("AudioRadiostationItem--playing",s&&parseInt(e.dataset.id)===t.id)}));for(var l=0,d=this._currentPlayingRows.length;l<d;l++){var n=this._currentPlayingRows[l];n&&!(0,P.inArray)(n,i)&&this.toggleCurrentAudioRow(n,!1,e)}if(t)for(var u=0,_=i.length;u<_;u++){var c=i[u];if(c){if((0,E.gpeByClass)("article_editor_canvas",c))continue;this.toggleCurrentAudioRow(c,!0,e)}}this._currentPlayingRows=i,(0,P.each)((0,E.geByClass)("_audio_pl"),((e,t)=>(0,E.removeClass)(t,"audio_pl__playing")));var p=this.getCurrentPlaylist();if(this.isPlaying()&&p){var h=(0,E.geByClass)(`_audio_pl_${p.getOwnerId()}_${p.getPlaylistId()}`);h&&(0,P.each)(h,((e,t)=>(0,E.addClass)(t,"audio_pl__playing")))}}scrollToCurrentPlaying(e,t){var i=ie.getAudioElementsByAudioId(e);window.AudioPage&&i.forEach((e=>{var i=window.currentAudioPage(e);if(i&&i._scroll){var a=i.getCurrentSectionEl()||i.getPageContainer();ie.getAudioElementsByAudioId(t,a).length||i.drawMore(),i.scrollIntoView(ie.getAudioElementsByAudioId(t,a)[0],150)}}))}toggleCurrentAudioRow(e,t,i){var a=r.AudioUtils.getAudioFromEl(e,!0);(0,E.addClass)(e,r.AudioUtils.AUDIO_CURRENT_CLS),a.withInlinePlayer&&(0,E.toggleClass)(e,"audio_row__player_transition",i),(i=!!a.withInlinePlayer&&i)?setTimeout((()=>this._updateAudioEl(t,e,a,i)),0):this._updateAudioEl(t,e,a,i)}_updateAudioEl(e,t,i,a){var o=(0,E.geByClass1)("_audio_row__play_btn",t),s=(0,E.geByClass1)("_audio_row__title",t),l=(0,E.geByClass1)("_audio_row__duration",t),d=r.AudioUtils.getDurationMod(e?i.duration:i.duration*this.getCurrentProgress());e&&t&&!1===this.isPlaying()&&((0,E.removeClass)(t,"audio_row__playing"),o&&(0,E.attr)(o,"aria-label",u.getLang("global_audio_play")),s&&(0,E.attr)(s,"role",""));var n=function(e,t){if(void 0===t&&(t=""),l){var i=r.AudioUtils.getDurationMod(e);l.innerHTML=t+(0,y.formatTime)(e),i!==d&&((0,E.replaceClass)(l,r.AudioUtils.AUDIO_DURATION_CLS+"-"+d,r.AudioUtils.AUDIO_DURATION_CLS+"-"+i),d=i)}};if(i.withInlinePlayer&&(e?this._addRowPlayer(t):this._removeRowPlayer(t)),e){this.on(t,[L.events.PLAY,L.events.PLAY_REQUESTED],(e=>{r.AudioUtils.audioTupleToAudioObject(e).fullId===i.fullId&&((0,E.addClass)(t,r.AudioUtils.AUDIO_PLAYING_CLS),o&&(0,E.attr)(o,"aria-label",u.getLang("global_audio_pause")),s&&(0,E.attr)(s,"role","heading"))})),this.on(t,L.events.PROGRESS,((e,t,a)=>{if(i.withInlinePlayer||!this.ads.isPlaying()){a=parseInt(a);var o=0,s="";ie.getDurationType()?(o=Math.round(a-t*a),s="-"):o=Math.round(t*a),n(o,s)}else n(i.duration)}));var _=(0,E.data)(t,"bars");if(!_&&(i.isWithCovers||i.isNumeric||i.isPodcastListSnippet)){if(_=(0,E.se)('<canvas class="audio_row__sound_bars"></canvas>'),i.isPodcastListSnippet?(0,E.geByClass1)("podcast_list_snippet__cover",t).appendChild(_):t.appendChild(_),_.width=r.AudioUtils.AUDIO_ROW_COVER_SIZE*((0,c.isRetina)()?2:1),_.height=r.AudioUtils.AUDIO_ROW_COVER_SIZE*((0,c.isRetina)()?2:1),_.style.width=r.AudioUtils.AUDIO_ROW_COVER_SIZE,_.style.height=r.AudioUtils.AUDIO_ROW_COVER_SIZE,(0,c.isRetina)())_.getContext("2d").scale(2,2);var p=getComputedStyle(_).color;this.on(t,L.events.FREQ_UPDATE,((e,t)=>ae(_,t,p))),ae(_,[0,0,0,0],p),(0,E.data)(t,"bars",_)}(0,E.toggleClass)(t,r.AudioUtils.AUDIO_PLAYING_CLS,this.isPlaying())}else{this.off(t),(0,E.removeClass)(t,r.AudioUtils.AUDIO_PLAYING_CLS),(0,E.removeClass)(t,r.AudioUtils.AUDIO_CURRENT_CLS),n(i.duration),o&&(0,E.attr)(o,"aria-label",u.getLang("global_audio_play")),s&&(0,E.attr)(s,"role","");var h=(0,E.data)(t,"bars");h&&((0,E.re)(h),(0,E.data)(t,"bars",null))}a?setTimeout((()=>{var e=r.AudioUtils.getAudioFromEl(t,!0);(0,E.toggleClass)(t,r.AudioUtils.AUDIO_CURRENT_CLS,!!e.isCurrent)}),0):(0,E.toggleClass)(t,r.AudioUtils.AUDIO_CURRENT_CLS,e)}_removeRowPlayer(e){(0,E.removeClass)(e,r.AudioUtils.AUDIO_CURRENT_CLS);var t=(0,E.data)(e,"player_inited");if(t){setTimeout((()=>(0,E.re)((0,E.geByClass1)("_audio_inline_player",e))),200);var i=(0,E.geByClass1)("_audio_duration",e);i&&(i.innerHTML=(0,y.formatTime)(r.AudioUtils.getAudioFromEl(e,!0).duration)),this.off(e),(0,P.each)(t.sliders,((e,t)=>t.destroy())),(0,E.data)(e,"player_inited",!1);var a=(0,E.geByClass1)("has_audio_player",e);a&&(0,E.removeClass)(a,"has_audio_player")}}_addRowPlayer(e){if(!((0,E.geByClass1)("_audio_inline_player",e)||(0,E.hasClass)(e,"podcast_list_snippet")||(0,E.hasClass)(e,"podcast_snippet__controls")||(0,E.hasClass)(e,"PodcastWidget__player"))){var t=(0,E.se)(vk.audioInlinePlayerTpl||(0,P.getTemplate)("audio_inline_player")),i=(0,E.geByClass1)("_audio_player__place",e);i.appendChild(t),(0,E.addClass)(i,"has_audio_player");var a=new window.Slider((0,E.geByClass1)("audio_inline_player_volume",t),{value:this.getVolume(),backValue:0,size:1,hintClass:"audio_player_hint",withBackLine:!0,log:!0,formatHint:e=>Math.round(100*e)+"%",onChange:e=>this.setVolume(e)}),o=new window.Slider((0,E.geByClass1)("audio_inline_player_progress",t),{value:0,backValue:0,size:1,hintClass:"audio_player_hint",withBackLine:!0,formatHint:e=>(0,y.formatTime)(Math.round(e*this._impl.getDuration())),onEndDragging:e=>{var i=r.AudioUtils.audioTupleToAudioObject(this.getCurrentAudio());i&&r.AudioUtils.isPodcast(i)&&this.podcastSetActionRef(i,r.AudioUtils.PodcastsLogs.ACTION_SEEK,"",t),this.seek(e)}});this.ads.isPlaying()&&o.toggleAdState(!0),vk.id||o.setBlocked(!0),this.on(e,L.events.AD_DEINITED,(()=>{})),this.on(e,L.events.AD_READY,(()=>{})),this.on(e,L.events.AD_STARTED,(()=>{o.toggleAdState(!0),o.setBackValue(0)})),this.on(e,L.events.AD_COMPLETED,(()=>o.toggleAdState(!1))),this.on(e,L.events.START_LOADING,(()=>o.toggleLoading(!0))),this.on(e,L.events.CAN_PLAY,(()=>o.toggleLoading(!1))),this.on(e,L.events.BUFFERED,((e,t)=>o.setBackValue(t))),this.on(e,L.events.PROGRESS,((e,t)=>{o.toggleLoading(!1),o.setValue(t)})),this.on(e,L.events.VOLUME,((e,t)=>{a.setValue(t,!0)})),(0,E.data)(e,"player_inited",{sliders:[a,o]})}}hasStatusExport(){for(var e in this._statusExport)if(this._statusExport.hasOwnProperty(e)&&this._statusExport[e])return!0;return!1}getStatusExportInfo(){return this._statusExport}setStatusExportInfo(e,t){void 0===t&&(t=!1),this._statusExport=e,t&&this.setStatusExportInfoStorage(e)}setStatusExportInfoStorage(e){ie._lsSet(ie.LS_STATUS_EXPORT,e)}deleteAudioFromAllPlaylists(e){e=(0,c.isObject)(e)||(0,c.isArray)(e)?r.AudioUtils.audioTupleToAudioObject(e).fullId:e,(0,P.each)(this._playlists,((t,i)=>i.removeAudio(e))),this.getPlaylistQueue().removeAudio(e),this.saveStateCurrentPlaylist()}updateAudio(e,t){var i="";return(0,c.isString)(e)?i=e:(0,c.isArray)(e)&&(i=r.AudioUtils.audioTupleToAudioObject(e).fullId),t||(t=e),(0,P.each)(this._playlists,((a,o)=>{for(var s=o.getAudiosList(),l=0,d=s.length;l<d;l++)r.AudioUtils.getAudioFullId(s[l])===i&&(s[l]=(0,N.mergeAudioTupleWithoutContext)(e,t))})),this._currentAudio&&r.AudioUtils.getAudioFullId(this._currentAudio)===i&&(this._currentAudio=(0,N.mergeAudioTupleWithoutContext)(e,t),this.notify(L.events.CURRENT_CHANGED)),this.notify(L.events.UPDATE),e}_triggerTNSPixel(){var e=ie._lsGet("tns_triggered_time_v3")||0,t=(0,c.vkNow)();t-e<864e5||(ie._lsSet("tns_triggered_time_v3",t),(0,c.vkImage)().src=`https://www.tns-counter.ru/V13a****mail_ru/ru/CP1251/tmsec=mail_audiostart/${(0,c.irand)(1,1e9)}`)}_restoreVolumeState(){ie.clearDeprecatedCacheKeys(),ie.clearOutdatedCacheKeys();var e=ie._lsGet(ie.LS_VOLUME);this._userVolume=null==e||!1===e?D.DEFAULT_VOLUME:e}restoreState(){if(!vk.widget&&(ie.clearDeprecatedCacheKeys(),ie.clearOutdatedCacheKeys(),!window.cur.audioPreventRestoreTrack)){this._currentAudio=ie._lsGet(ie.LS_TRACK);var e=ie._lsGet(ie.LS_PL);if(e){e=JSON.parse(e);var t=this.hasPlaylist(e.type,e.ownerId,e.albumId);e.type===v.AudioPlaylist.TYPE_RADIO&&t?this._currentPlaylist=t:(this._currentPlaylist=new v.AudioPlaylist(e),e.originalPlaylistRawId&&(this._currentPlaylist._originalPlaylistRawId=e.originalPlaylistRawId)),this.getPlaylistQueue().setSortedQueue(e.list,e.source),this._initPlayingContext(this._currentPlaylist.getContext())}this._currentPlaylist&&this._currentAudio?this.notify(L.events.UPDATE):this._currentPlaylist=this._currentAudio=null;var i=0;if(r.AudioUtils.isPodcast(this._currentAudio)){var a=ie._podcastGetStates(),o=`${this._currentAudio[r.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]}_${this._currentAudio[r.AudioUtils.AUDIO_ITEM_INDEX_ID]}`;i=((a[o]||{}).position||0)/this._currentAudio[r.AudioUtils.AUDIO_ITEM_INDEX_DURATION]}else i=ie._lsGet(ie.LS_PROGRESS)||0;this._currentAudio&&this._impl&&this._implSetUrl(this._currentAudio,!0).then((()=>{i&&i<1?this.implTaskManager.seek(i):this.implTaskManager.setVolume(0),this.notify(L.events.CURRENT_CHANGED)})).catch((()=>{this.deleteCurrentPlaylist(),this.notify(L.events.CURRENT_CHANGED)})),this._updatePlaybackRate()}}_implPlay(){var e=r.AudioUtils.audioTupleToAudioObject(this.getCurrentAudio());this.implTaskManager.play().then((()=>{if(this._muteProgressEvents=!1,this._allowPrefetchNext=!l.browser.safari,e.actionHash&&((0,M.connectListenQueue)(),ajax.post("al_audio.php",{act:"start_playback",audio_id:e.id,owner_id:e.owner_id,hash:e.actionHash,uuid:ie.getDeviceId()},{onFail:()=>!0})),r.AudioUtils.isPodcast(e)){var t=this._podcastRestoreState();this._podcastUpdateState(e,t,0,r.AudioUtils.PodcastsLogs.ACTION_PLAY)}}))}_implSetUrl(e,t){this.implTaskManager.clearTask(x.TaskName.URL),t||this.notify(L.events.START_LOADING);var i=(0,S.audioTupleToAudioObject)(e);return this._ensureHasURL(i).then((e=>{if(e.url)return this.implTaskManager.setUrl(e.url).catch((()=>{this.implTaskManager.clearAllTasks(),this.notify(L.events.FAILED),this.isPlaying()&&(this.pause(),this.playNext(!0,!0))}));throw new Error}))}toggleDurationType(){var e=ie._lsGet(ie.LS_DURATION_TYPE);ie._lsSet(ie.LS_DURATION_TYPE,!e),this.notify(L.events.UPDATE,this.getCurrentProgress())}getCurrentProgress(){return this._impl?this._impl.getCurrentProgress():0}getCurrentBuffered(){return this._impl?this._impl.getCurrentBuffered():0}_initEvents(){var e=window.Notifier;e&&(e.addRecvClbk("audio_start","audio",(()=>{(this.isPlaying()||this.ads.isPlaying())&&(this.pausedByAudio=Date.now(),this.pause()),delete this.pausedByVideo})),e.addRecvClbk("video_start","audio",(()=>{(this.isPlaying()||this.ads.isPlaying())&&(this.pause(),this.pausedByVideo=Date.now())})),e.addRecvClbk("video_hide","audio",(()=>{!this.isPlaying()&&this.pausedByVideo&&(Date.now()-this.pausedByVideo<18e4&&this.play(),delete this.pausedByVideo)})),e.addRecvClbk("logged_off","audio",(()=>{cur.loggingOff=!0,ie.clearAllCacheKeys(),this.stop()})),e.addRecvClbk("stories_video_start","audio",(()=>{this.isPlaying()&&(this.pause(),this.pausedByStories=(0,c.vkNow)())})),e.addRecvClbk("stories_video_end","audio",(()=>{!this.isPlaying()&&this.pausedByStories&&((0,c.vkNow)()-this.pausedByStories<18e4&&this.play(),delete this.pausedByStories)}))),new q.RadiostationEventsHandling}addPlaylist(e){var t=this.hasPlaylist(e.getId());t?(t.mergeWith(e.asObject()),t.getType()===v.AudioPlaylist.TYPE_RADIO&&this._currentPlaylist===t&&this.getPlaylistQueue().setSortedQueue(t.getAudiosList())):this._playlists.push(e)}_cleanUpPlaylists(){for(var e=0,t=-1,i=this._playlists.length-1;i>=0;i--){var a=this._playlists[i];if(!a.isReference()&&(e+=a.getAudiosCount())>4e3){t=i;break}}if(-1!==t){t+=1;for(var o=this._playlists.slice(0,t),s=this.getCurrentPlaylist(),r=[],l=0;l<o.length;l++){var d=o[l];if(s===d&&(d=!1),d&&!d.isReference())for(var n=t;n<this._playlists.length;n++){var u=this._playlists[n];u.isReference()&&u.getSelf()===d&&(d=!1)}d&&r.push(l)}for(var c=0;c<r.length;c++){var p=r[c];this._playlists.splice(p,1)}r.length&&(0,_.debugLog)("AudioPlayer - "+r.length+" playlists removed")}}hasPlaylist(e,t,i,a){var o;if(a)return this._playlists.find((e=>e.getBlockId()===a||e.getAlbumId()===a))||!1;o=void 0!==t&&void 0!==i?`${e}_${t}_${i}`:e;for(var s=0;s<this._playlists.length;s++){var r=this._playlists[s];if(!r.isReference()&&r.getId()===o)return r}return!1}getPlaylistByBlockId(e){return this.hasPlaylist(null,null,null,e)||null}getPlaylistsByType(e){return this._playlists.filter((t=>t.getType()===e))||null}getPlaylist(e,t,i,a,o){if(void 0===o&&(o=""),e&&!t&&!i){var s=v.AudioPlaylist.splitId(e);e=s[0],t=s[1],i=s[2]}var r=this.hasPlaylist(e,t,i,o);return r?(r.mergeWith({accessHash:a}),r):new v.AudioPlaylist({type:e,ownerId:t,albumId:i,hasMore:e!==v.AudioPlaylist.TYPE_TEMP,accessHash:a,blockId:o})}getPlaylistQueue(){return this._playlistQueue}isFromNextSequence(){return 1===this._seq}isFromPrevSequence(){return-1===this._seq}isAutoPlayed(){return!!this._autoNext}hasPrevAudio(){return!(!this._prevAudio||r.AudioUtils.getAudioFullId(this._currentAudio)===r.AudioUtils.getAudioFullId(this._prevAudio))}hasPrevPlaylist(){return!!this._prevPlaylist}toggleRepeatCurrentAudio(){this._repeatCurrent=!this._repeatCurrent,this._repeatAll=!1}isRepeatCurrentAudio(){return!!this._repeatCurrent}toggleRepeatAll(){this._repeatAll=!this._repeatAll,this._repeatCurrent=!1}isRepeatAll(){return!!this._repeatAll}setNext(e,t){if(vk&&vk.widget&&!vk.id&&window.Widgets)return window.Widgets.oauth(),!1;var i="audio_row__added_next";if(!(0,E.hasClass)(e,i)){(0,E.addClass)(e,i);var a=this.getCurrentPlaylist(),o=this.getPlaylistQueue();if(a){var s=r.AudioUtils.audioTupleToAudioObject(this.getCurrentAudio());if(s&&t.fullId===s.fullId)return;var l=o.indexOfAudio(s);if(-1===l)return;this.notify(L.events.PLAY_NEXT,s.fullId,t.fullId);var d=this.getPlaylistQueue(),n=o.indexOfAudio(t);-1!==n?d.moveAudio(n,l+1):(d.addAudio((0,B.serializeAudio)(t),l+1),this.getCurrentPlaylist().pushAudio((0,B.serializeAudio)(t),l+1)),this.saveStateCurrentPlaylist()}else{var u=r.AudioUtils.getContextPlaylist(e);this.play(t,u.playlist,u.context)}var _=window.AudioPage&&window.currentAudioPage(e);if(_){var c=_.getPageCurrentPlaylist();c&&_.onUserAction(t,c)}}}on(e,t,i){(0,c.isArray)(t)||(t=[t]);for(var a,o=function(){return i(...arguments)},s=J(t);!(a=s()).done;){var r=a.value;this.subscribers.push({context:e,et:r,cb:o})}return()=>{this.subscribers=this.subscribers.filter((e=>e.cb!==o))}}off(e){this.subscribers=this.subscribers.filter((t=>t.context!==e))}connectEvents(){var e=this;this.eventBus.precheck=e=>!!this._impl&&!(!this.ads.isPlaying()&&this._muteProgressEvents&&(0,P.inArray)(e,[L.events.BUFFERED,L.events.PROGRESS])),this.eventBus.onAnyCallBack=function(t){for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return e.onEvent(t,...a)},this.subscribe(L.events.VOLUME,(()=>ie._lsSet(ie.LS_VOLUME,this._userVolume))),this.subscribe(L.events.PLAY_REQUESTED,(()=>{this.updateCurrentPlaying(!0),this.saveStateCurrentPlaylist(),this._saveStateCurrentAudio(),ie._setTabIcon("play"),this._sendStatusExport()})),this.subscribe(L.events.PLAY,(()=>this.updateCurrentPlaying(!0))),this.subscribe(L.events.PLAYLIST_CHANGED,(()=>{this.saveStateCurrentPlaylist(),this._saveStateCurrentAudio()})),this.subscribe(L.events.PROGRESS,function(){var t=(0,s.default)(o.mark((function t(i,a,s){var l,d,n,u;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=e.getCurrentAudio(),e.getPlaylistQueue(),d=(0,S.audioTupleToAudioObject)(l),e._listenedTime=s,!r.AudioUtils.isPodcast(d)){t.next=8;break}i&&s&&e._podcastUpdateState(d,i,s,r.AudioUtils.PodcastsLogs.ACTION_HEARTBEAT),t.next=16;break;case 8:if(e.ads.isPlaying()){t.next=16;break}if(n=e._impl.getCurrentProgress(),vk.widget||ie._lsSet(ie.LS_PROGRESS,n),!(!vk.widget&&e._allowPrefetchNext&&n>=.8)){t.next=16;break}return t.next=14,e.getNextAudio();case 14:(u=t.sent)&&e._impl.isFullyLoaded()&&(e._allowPrefetchNext=!1,e._prefetchAudio(u));case 16:case"end":return t.stop()}}),t)})));return function(e,i,a){return t.apply(this,arguments)}}()),this.subscribe(L.events.PAUSE,(()=>{this.updateCurrentPlaying(!0);var e=this.getCurrentAudio(),t=(0,S.audioTupleToAudioObject)(e);r.AudioUtils.isPodcast(t)&&this._podcastUpdateState(t,this.getCurrentProgress(),this._impl.getPlayedTime(),r.AudioUtils.PodcastsLogs.ACTION_PAUSE),ie._setTabIcon("pause")})),this.subscribe(L.events.SEEK,(()=>{var e=this.getCurrentAudio(),t=(0,S.audioTupleToAudioObject)(e);r.AudioUtils.isPodcast(t)&&this._podcastUpdateState(t,this.getCurrentProgress(),this._impl.getPlayedTime(),r.AudioUtils.PodcastsLogs.ACTION_SEEK)})),this.subscribe(L.events.ENDED,(()=>{var e=this.getCurrentAudio(),t=(0,S.audioTupleToAudioObject)(e);r.AudioUtils.isPodcast(t)&&this._podcastUpdateState(t,this.getCurrentProgress(),this._impl.getPlayedTime(),r.AudioUtils.PodcastsLogs.ACTION_HEARTBEAT),window.vk&&!window.vk.widget&&!window.vk.id&&(0,W.partConfigEnabled)("audio_unauth_preview_box")&&(this.stop(),K.Unauthorized.showMoreBox(null,0,F.UnauthorizedSourceType.AUDIO))})),this.subscribe(L.events.RADIOSTATION_FOLLOW,(e=>(0,$.updateFaveStatusAfterFollow)(e,!0))),this.subscribe(L.events.RADIOSTATION_UNFOLLOW,(e=>(0,$.updateFaveStatusAfterFollow)(e,!1)))}subscribe(e,t){this.eventBus.subscribe(e,t)}unsubscribe(e,t){this.eventBus.unsubscribe(e,t)}onEvent(e,t,i,a){(0,P.inArray)(e,[L.events.PLAY,L.events.PLAY_REQUESTED,L.events.PAUSE])&&(this.subscribers=this.subscribers.filter((e=>!(e.context instanceof Element)||bodyNode.contains(e.context)))),(0,P.each)(this.subscribers||[],((o,s)=>{s.et===e&&s.cb(this.getCurrentAudio(),t,i,a)}))}notify(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];this.eventBus.emit(e,...i)}addWithReplacePlaylists(e){var t=e.reduce(((e,t)=>(e[v.AudioPlaylist.getFullIdFromData(t)]=t,e)),{}),i={};this._playlists.forEach(((e,a)=>{var o=e.getFullId();if(t[o]){this._playlists.slice(a,1);var s=t[o];new v.AudioPlaylist(s),i[o]=!0}})),Object.keys(t).forEach((e=>{i[e]||new v.AudioPlaylist(t[e])}))}_sendPlayerErrorStats(e){var t=r.AudioUtils.audioTupleToAudioObject(this.getCurrentAudio());if(t){var i=t.full_id,a=(0,P.extend)({audio:i,progress:this.getCurrentProgress(),buffered:this.getCurrentBuffered()},e.getErrorData());ajax.post("al_audio.php?act=player_error_stats",a)}}playLive(e,t){var i=this.getPlaylist(v.AudioPlaylist.TYPE_LIVE,vk.id,E.data[0]),a=this.getPlaylistQueue();i.mergeWith({live:e,hasMore:!1}),e=i.getLiveInfo(),ajax.post("al_audio.php",{act:"a_play_audio_status",audio_id:e.audioId,host_id:e.hostId,hash:e.hash},(0,P.extend)(t,{onDone:(e,t,o)=>{i.mergeWith({title:t&&t.title,list:[e]}),a.addAudio(e),this.play(e,i,o)},onFail:()=>!0}))}_listenStatusExport(){window.addEventListener("storage",(e=>{if(e.key===ie.LS_PREFIX+ie.LS_STATUS_EXPORT){var t=ie._lsGet(ie.LS_STATUS_EXPORT);this.setStatusExportInfo(t),cur.audioPage&&cur.audioPage.updateStatusExportControls()}}))}_sendStatusExport(){var e=r.AudioUtils.audioTupleToAudioObject(this.getCurrentAudio());if(e){var t=this.statusSent?this.statusSent.split(","):[!1,0],i=(0,c.vkNow)()-parseInt(t[1]);if(this.hasStatusExport()&&!r.AudioUtils.isPodcast(e)&&(e.id!=t[0]||i>3e5)){var a=this.getCurrentPlaylist(),o=a?a.playbackParams:null;setTimeout(ajax.post.pbind("al_audio.php",{act:"audio_status",full_id:e.fullId,hash:vk.statusExportHash,top:o&&(o.top_audio||o.top)?1:0},{onFail:()=>!0}),0),this.statusSent=e.id+","+(0,c.vkNow)()}}}saveStateCurrentPlaylist(){var e=this.getCurrentPlaylist(),t=this.getPlaylistQueue();if(!vk.widget&&e&&t&&!(0,z.isArticleTts)(this._currentAudio)){var i=this._getPreparePlayQueueForSaving(e,t);ie._lsSet(ie.LS_PL,i),ie._lsSet(ie.LS_SAVED,(0,c.vkNow)())}}_getPreparePlayQueueForSaving(e,t){var i=e.asObject();i.type&&(i.type=v.AudioPlaylist.TYPE_TEMP);var o=this.getCurrentAudio(),s=Math.max(0,t.indexOfAudio(o)),l=(0,a.default)({},i,{list:(0,P.clone)(t.list.slice(Math.max(0,s-100),s+300),!0),source:t.source});return(0,P.each)(l.list,(function(e,t){(0,X.isRadio)(t)||(t[r.AudioUtils.AUDIO_ITEM_INDEX_URL]="")})),JSON.stringify(l)}_saveStateCurrentAudio(){if(!vk.widget){var e=this.getCurrentAudio();if(!e||(0,z.isArticleTts)(e))ie._lsSet(ie.LS_TRACK,null),(0,f.setCookie)("remixcurr_audio",null,1);else{var t=(0,P.clone)(e);(0,X.isRadio)(e)||(t[r.AudioUtils.AUDIO_ITEM_INDEX_URL]=""),ie._lsSet(ie.LS_TRACK,t),(0,f.setCookie)("remixcurr_audio",`${e[r.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]}_${e[r.AudioUtils.AUDIO_ITEM_INDEX_ID]}`,1)}}}getListenedTime(){return this._listenedTime}seekCurrentAudio(e,t){if(this.ads.isPlaying())return!1;var i=(t=t||10)/r.AudioUtils.audioTupleToAudioObject(this.getCurrentAudio()).duration,a=this.getCurrentProgress()+(e?i:-i);a=Math.max(0,Math.min(1,a)),this.seek(a)}setVolume(e,t){void 0===t&&(t=!1);var i=Math.min(1,Math.max(0,e));this._userVolume!==i&&(this._userVolume=i,this.notify(L.events.VOLUME,i)),this.implTaskManager.setVolume(i,t),this.ads.updateVolume()}getVolume(){return void 0===this._userVolume?.8:this._userVolume}seek(e){this.implTaskManager.seek(e),this.notify(L.events.SEEK)}seekToTime(e,t){var i=this.getCurrentAudio();if(!i)return 0;var a=e/i[r.AudioUtils.AUDIO_ITEM_INDEX_DURATION];if(a=Math.max(0,a),a=Math.min(a,1),this.seek(a),r.AudioUtils.isPodcast(i)){var o="",s=r.AudioUtils.audioTupleToAudioObject(i);t&&(o=r.AudioUtils.PodcastsLogs.ACTION_TIME_MARKER,this.podcastSetActionRef(s,r.AudioUtils.PodcastsLogs.ACTION_SEEK,t)),this._podcastUpdateState(s,a,0,o)}return a}_ensureHasURL(e){this._currentUrlEnsure=this._currentUrlEnsure||{};var t=[];if(!e)return Promise.reject();if(e.url)return Promise.resolve(e);var i=this.getPlaylistQueue(),a=i.indexOfAudio(e);return a>=0?i.getAudioAt(a).then((e=>r.AudioUtils.audioTupleToAudioObject(e))):(this._currentUrlEnsure[e.fullId]||t.push(e.fullId+"_"+e.actionHash+"_"+e.urlHash),(()=>{var i;return!t.length&&this.currentEnsureUrlPromise?i=this.currentEnsureUrlPromise:(i=new Promise(((e,i)=>{this.ensureUrlReject&&this.ensureUrlReject(),this.ensureUrlReject=i,te().then((()=>this.fetchAudioUrls(t))).then((t=>{this.ensureUrlReject=null,e(t)})).catch((a=>{switch(a){case"bad_hash":this.ensureUrlReject=null,this.fetchAudios(t).then((e=>this.fetchAudioUrls(e))).then(e).catch((()=>!0));break;case"no_audios":this.ensureUrlReject=null,i()}return!0}))})),this.currentEnsureUrlPromise=i),i.then((t=>(Array.isArray(t)&&t.forEach((t=>{if(e.fullId===(0,j.getAudioFullId)(t)){var i=(0,S.audioTupleToAudioObject)(t);e.url=i.url,e.ads=i.ads,e.flags=i.flags,e.extra=i.extra}})),e)))})())}fetchAudioUrls(e){return new Promise(((t,i)=>{ajax.post("al_audio.php?act=reload_audio",{ids:e.join(",")},{onDone:(e,i,a)=>{this.setStatusExportInfo(i),a&&this._podcastSaveData(a),(0,P.each)(e,((e,t)=>{t=r.AudioUtils.audioTupleToAudioObject(t);var i={};i[r.AudioUtils.AUDIO_ITEM_INDEX_URL]=t.url,i[r.AudioUtils.AUDIO_ITEM_INDEX_ADS]=t.ads,i[r.AudioUtils.AUDIO_ITEM_INDEX_FLAGS]=t.flags,i[r.AudioUtils.AUDIO_ITEM_INDEX_EXTRA]=t.extra,this.updateAudio(t.fullId,i),this._currentAudio&&(0,j.getAudioFullId)(this._currentAudio)===t.fullId&&(this._currentAudio[r.AudioUtils.AUDIO_ITEM_INDEX_URL]=t.url,this._currentAudio[r.AudioUtils.AUDIO_ITEM_INDEX_ADS]=t.ads,this._currentAudio[r.AudioUtils.AUDIO_ITEM_INDEX_FLAGS]=t.flags,this._currentAudio[r.AudioUtils.AUDIO_ITEM_INDEX_EXTRA]=t.extra),delete this._currentUrlEnsure[t.fullId]})),t(e)},onFail:e=>(i(e),!0)})}))}fetchAudios(e){return new Promise(((t,i)=>{ajax.post("al_audio.php?act=reload_audios",{audio_ids:e.join(",")},{onDone:e=>{var a=[],o=this.getCurrentPlaylist().getAudiosList();if(Array.isArray(e)){for(var s=e.reduce(((e,t)=>(e[(0,j.getAudioFullId)(t)]=t,e)),{}),r=0;r<o.length;r++){var l=(0,j.getAudioFullId)(o[r]);if(s[l]){o[r]=s[l];var d=(0,S.audioTupleToAudioObject)(s[l]);a.push(`${d.fullId}_${d.actionHash}_${d.urlHash}`)}}t(a)}else i()}})}))}toggleAudio(e,t){if(vk&&vk.widget&&window.Widgets&&!vk.widgetPodcast&&!vk.id&&!(0,W.partConfigEnabled)("audio_unauth_preview"))return window.Widgets.oauth(),!1;if((0,E.domClosest)("_audio_row__tt",t.target))return(0,g.cancelEvent)(t);var i=(0,E.domClosest)("_audio_row",e),a=r.AudioUtils.getAudioFromEl(i,!0);if(window.getSelection&&window.getSelection().rangeCount){var o=window.getSelection().getRangeAt(0);if(o){var s=o.commonAncestorContainer;if(s&&(0,E.domClosest)("_audio_row",s)===i&&o.startOffset!==o.endOffset)return!1}}if(t&&(0,E.hasClass)(t.target,"mem_link"))return nav.go((0,E.attr)(t.target,"href"),t,{navigateToUploader:!0}),(0,g.cancelEvent)(t);if((0,E.hasClass)(t.target,"_audio_row__title_inner")){if(r.AudioUtils.isPodcast(a))return(0,n.showPodcast)(i,a.fullId),(0,g.cancelEvent)(t);if(a.lyrics&&!a.isInAttach&&!(0,W.partConfigEnabled)("audio_use_web_new_version_lyrics"))return r.AudioUtils.toggleAudioLyrics(i,a),(0,g.cancelEvent)(t);if(a.hasTrackPage&&!a.isClaimed)return;(0,g.cancelEvent)(t)}if((0,E.hasClass)(t.target.parentNode,"audio_row__performers")){if((0,g.checkEvent)(t)||vk.widget)return!0;if(!(0,E.gpeByClass)("_ape_audio_item",t.target)){var l=(0,E.domData)(t.target,"performer");if(l)return r.AudioUtils.audioSearchPerformer(t.target,l,t),(0,g.cancelEvent)(t)}return!0}var d=cur.cancelClick||t&&((0,E.hasClass)(t.target,"audio_lyrics")||(0,E.domClosest)("_audio_duration_wrap",t.target)||(0,E.domClosest)("_audio_inline_player",t.target)||(0,E.domClosest)("audio_performer",t.target)),u=(0,E.hasClass)(t.target,"slider")||(0,E.domClosest)("slider",t.target),_=cur._sliderMouseUpNowEl&&(cur._sliderMouseUpNowEl===(0,E.geByClass1)("audio_inline_player_progress",i)||cur._sliderMouseUpNowEl===(0,E.geByClass1)("audio_inline_player_volume",i));if((u||_)&&(d=!0),delete cur.cancelClick,delete cur._sliderMouseUpNowEl,d)return!0;if(r.AudioUtils.isClaimedAudio(a)||a.isReplaceable){var c=r.AudioUtils.getAudioExtra(a).claim;if(c)return void((0,E.hasClass)(i,"no_actions")||a.isInEditBox||window.showAudioClaimWarning(a,c,r.AudioUtils.replaceWithOriginal.bind(r.AudioUtils,i,a)))}if(this.podcastSetActionRef(a,a.isPlaying?r.AudioUtils.PodcastsLogs.ACTION_PAUSE:r.AudioUtils.PodcastsLogs.ACTION_PLAY,"",i),a.isPlaying)this.pause();else{var p=r.AudioUtils.getContextPlaylist(i);if(this.getPlaylistQueue().shuffled&&window.AudioPage){var h=window.currentAudioPage(e),y=h&&h.getCurrentSection();(!h||!(y&&"current"===y&&("placeholder_audios_wrapper"===p.context||"autoplay"===p.context)))&&this.getPlaylistQueue().resetShuffle()}(0,W.partConfigEnabled)("autoplay_web")&&"autoplay"===p.context?this.play(a.fullId,null,a.context):(this.play(a.fullId,p.playlist,a.context||p.context),cur.audioPage&&cur.audioPage.onUserAction(a,p.playlist))}r.AudioUtils.onRowOver(i,!1,!0)}playNextPlaylist(e,t,i){var a=this.getPlaylist(v.AudioPlaylist.TYPE_PLAYLIST,e,t,i);a.loadAll((()=>{var e=this.getCurrentPlaylist(),t=this.getPlaylistQueue();e?(e.pushAudio(a.getAudiosList()),t.addPlaylist(a)):(t.addPlaylist(a),this._currentPlaylist=new v.AudioPlaylist(a),t.getAudioAt(0).then((e=>{e&&(this._currentAudio=e,this.notify(L.events.UPDATE),this.notify(L.events.PLAYLIST_CHANGED),this.updateCurrentPlaying(),this.isPlaying()||this.play(e.fullId,a))}))),boxQueue&&boxQueue.hideAll(),layers&&layers.fullhide&&layers.fullhide()}))}setNextPlaylist(e,t,i){var a=this.getPlaylist(v.AudioPlaylist.TYPE_PLAYLIST,e,t,i);a.loadAll((()=>{var e,t=this.getCurrentPlaylist(),i=this.getPlaylistQueue(),o=a.getAudiosList(),s=this._currentAudio?i.indexOfAudio(this._currentAudio):-1,r=this._currentAudio&&null!=(e=null==t?void 0:t.indexOfAudio(this._currentAudio))?e:-1;i.addAudio(o,s+1),t?t.pushAudio(o,r+1):(this._currentPlaylist=new v.AudioPlaylist(a),i.getAudioAt(0).then((e=>{if(e&&(this._currentAudio=e,this.notify(L.events.UPDATE),this.notify(L.events.PLAYLIST_CHANGED),this.updateCurrentPlaying(),!this.isPlaying())){var t=e[0],i=`${e[1]}_${t}`;this.play(i,this._currentPlaylist)}})))}))}playPlaylist(e,t,i,a,o){if(vk&&vk.widget&&!vk.id&&window.Widgets&&!(0,W.partConfigEnabled)("audio_unauth_preview"))return window.Widgets.oauth(),!1;this.playNextInPlaylist(e,t,i,a,{shuffled:o,preDoPlay:e=>{o&&(e.shuffled&&e.resetShuffle(),e.shuffle(!0,!0),cur.audioPage&&cur.audioPage.updateShuffleButton())}})}playBlock(e,t,i,a,o,s){void 0===s&&(s="default"),this.playNextInPlaylist(e,t,i,a,{type:o,trackType:s,shuffled:!1})}playNextInPlaylist(e,t,i,a,o){void 0===o&&(o={});var s=this.getCurrentPlaylist(),r=this.getPlaylist(o.type||v.AudioPlaylist.TYPE_PLAYLIST,e,t,i),l=this.getPlaylistQueue();if(r.setContext(a),s&&s.getId()===r.getId()&&this.isPlaying()&&!o.shuffled)this.pause();else{var d=!1,n=()=>{d||(l.setSortedQueue(r.getAudiosList()),d=!0,o.shuffled&&(this._currentPlaylist=r),o.preDoPlay&&o.preDoPlay(l),l.getFirstAudio().then((e=>{e&&this.play(e,r,a)})))};if(r.getAudiosCount()&&!o.shuffled&&!r.isExpired())return void n();this._impl&&this._impl.preparePlay&&!this.ads.isPlaying()&&this._impl.preparePlay(),r.load(0,n,null,o.trackType)}}_initPlayingContext(e){this._playingContext=e}_getPlayingContext(){return this._playingContext||""}_getPlayingContextSection(){return this._getPlayingContext().split(":")[0]}play(e,t,i,a,l){var d=this;return(0,s.default)(o.mark((function n(){var u,p,h,g,y,A,f,P,E,m,w,b,I;return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!cur.loggingOff){n.next=2;break}return n.abrupt("return");case 2:if(d._impl){n.next=4;break}return n.abrupt("return");case 4:if(d._seq=a,d._autoNext=l,d._prevAudio=d._currentAudio,((0,c.isObject)(e)||(0,c.isArray)(e))&&(u=e,(e=r.AudioUtils.audioTupleToAudioObject(e))&&(e=e.fullId)),p=d.getPlaylistQueue(),h=r.AudioUtils.audioTupleToAudioObject(d._currentAudio),g=d.getCurrentPlaylist(),!e&&h&&(e=h.fullId),y=!1,A=e&&h&&e==h.fullId,f=function(){var i=(0,s.default)(o.mark((function i(s){return o.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(A){i.next=13;break}if(!s||!t){i.next=9;break}if(!(0,W.partConfigEnabled)("autoplay_web")||!t.getNoConsecutivePlay()){i.next=7;break}return i.next=5,p.addNoConsecutivePlaylist(t,s);case 5:i.next=9;break;case 7:return i.next=9,p.addPlaylist(t);case 9:p.list.length<t.getAudiosCount()&&p.addAudio(t.getAudiosList()),t&&t.getType()===v.AudioPlaylist.TYPE_SEARCH&&t.indexOfAudio(s)>=t.getLocalFoundCount()&&t.sendSearchStats("search_play"),h&&r.AudioUtils.isPodcast(h)&&d.isPlaying()&&d._podcastUpdateState(h,d.getCurrentProgress(),d._impl.getPlayedTime(),r.AudioUtils.PodcastsLogs.ACTION_PAUSE,{needResetListen:!0}),d.ads.isPlaying()||d.ads.deinit();case 13:if(ie._sendLCNotification(),!A){i.next=17;break}return d.ads.isPlaying()?d.ads.resume():d.isPlaying()||(d.setIsPlaying(!0),d.implTaskManager.clearAllTasks(),d._implSetUrl(h).then((()=>{d._implPlay(),d._updatePlaybackRate(),d.implTaskManager.setVolume(d.getVolume(),!!d._impl.getCurrentProgress()),r.AudioUtils.isPodcast(s)&&d._podcastUpdateState(r.AudioUtils.audioTupleToAudioObject(s),d.getCurrentProgress(),d._impl.getPlayedTime())})).catch((()=>{}))),i.abrupt("return");case 17:e&&s&&(!l&&h&&d._impl.setUrl(D.SILENCE),d._currentAudio=s,d.setIsPlaying(!0),d.ads.isPlaying()?d.ads.resume():(d.notify(L.events.PLAY_REQUESTED,!0,parseInt(a),l),d._muteProgressEvents=!0,d.implTaskManager.clearAllTasks(),d._impl.preparePlay&&d._impl.preparePlay(),d.ads.startPlay(r.AudioUtils.audioTupleToAudioObject(s),(()=>d.playAfterAd())),d.notify(L.events.PROGRESS,0)),d.updateCurrentPlaying(!0),h&&d.scrollToCurrentPlaying(h.fullId,e));case 18:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}(),!((0,W.partConfigEnabled)("autoplay_web")&&"autoplay"===i||(0,c.isArray)(u)&&"autoplay"===u[r.AudioUtils.AUDIO_ITEM_INDEX_CONTEXT])){n.next=21;break}if(P=p.autoplayQueue,!(E=P.getAudioById(e))){n.next=21;break}return d.eventBus.emit(L.AudioPlayerEventType.PLAY_TRACK_FROM_AUTOPLAY,E),n.abrupt("return",f(E));case 21:if(t?g&&(y=A?t.getFullId()===g.getSelf().getFullId():t===g.getSelf()||t===g):(t=g,y=!0),y||i||(0,_.debugLog)("New playlist play init without context"),i&&(d._prevContext=d._playingContext,d._initPlayingContext(i)),y){n.next=40;break}if(d._cleanUpPlaylists(),!d._currentPlaylist){n.next=38;break}if(d._prevPlaylist=d._currentPlaylist,d._prevAudio=d._currentAudio,!(0,W.partConfigEnabled)("autoplay_web")||!t.getNoConsecutivePlay()){n.next=36;break}return t.getAudio(e),m=Array.isArray(u)?u:t.getAudio(e),n.next=34,p.addNoConsecutivePlaylist(t,m);case 34:n.next=38;break;case 36:return n.next=38,p.setSortedQueueByPlaylist(t);case 38:d._currentPlaylist=new v.AudioPlaylist(t),d.notify(L.events.PLAYLIST_CHANGED);case 40:return p.indexOfAudio(e)>=0||(!(b=null==(w=t)?void 0:w.getAudio(e))&&u&&(b=u),p.addAudio(b)),n.next=44,p.getAudio(e);case 44:I=n.sent,f(I);case 46:case"end":return n.stop()}}),n)})))()}playAfterAd(){this.notify(L.events.CURRENT_CHANGED);var e=this.getCurrentAudio();e&&(this.notify(L.events.UPDATE),this._implSetUrl(e).then((()=>{this._implPlay(),this._updatePlaybackRate(),vk.id?this.implTaskManager.setVolume(this.getVolume()):this.fadeIn(1e3*ie.UNAUTH_FADE_TIME),this._triggerTNSPixel()})).catch((()=>(this.pause(),!0))))}instantPlay(e,t,i){var a=!l.browser.safari&&t&&t.shiftKey;this.playPlaylist(vk.id,v.AudioPlaylist.DEFAULT_PLAYLIST_ID,i,"header",a),(0,h.statlogsValueEvent)("client_header_play_button",a?"shuffle":"play"),setTimeout((()=>{(0,E.addClass)(e,"loading")}),400)}_prefetchAudio(e){(e=r.AudioUtils.audioTupleToAudioObject(e))&&e.url&&this._impl.prefetch(e.url)}getCurrentPlaylist(){return this._currentPlaylist}getPlaylists(){return(0,P.clone)(this._playlists)}pause(){this.ads.isPlaying()&&setTimeout((()=>this.ads.pause()),100),this.implTaskManager.setVolume(0,!0),this.implTaskManager.pause()}stop(){this.setIsPlaying(!1),this.ads.isPlaying()?this.ads.stop():this._impl.stop(),this.notify(L.events.STOP)}isPlaying(){return this._isPlaying}setIsPlaying(e){this._isPlaying=e}getCurrentAudio(){return this._currentAudio}getPreviousAudio(){return this._prevAudio}playNext(e){this._playNext(1,e)}playPrev(){this._playNext(-1)}_playNext(e,t){if(!this.ads.isPlaying()){var i=this.getCurrentAudio(),a=this.getCurrentPlaylist(),o=this.getPlaylistQueue(),s=(e,i)=>{r.AudioUtils.isClaimedAudio(e)||this.play(e,a,!1,i,t)};if(i&&a)if(e>0)o.getNextAudio(i,{ignoreClaimed:!0,repeat:this.isRepeatAll()}).then((e=>{e?s(e,1):a.isLive()?(this._muteProgressEvents=!0,a.fetchNextLiveAudio((e=>{if(e){var t=this.getPlaylistQueue(),i=t.indexOfAudio(e);i>=0?t.moveAudio(i,t.length-1):t.addAudio(e)}s(e)}))):o.getFirstAudio(!0).then((t=>{if(t){if(e=t,!this.isRepeatAll())if(o.indexOfAudio(i)+1===o.length)return this.implTaskManager.seekImmediate(0),this.stop(),void(r.AudioUtils.isClaimedAudio(e)||(this._currentAudio=e,this._implSetUrl(this._currentAudio),this.updateCurrentPlaying(!0),this.notify(L.events.CURRENT_CHANGED),this.notify(L.events.UPDATE)));s(e,1)}}))}));else o.indexOfAudio(this._currentAudio)<1||this._impl.getCurrentTime()>5?this.seek(0):o.getPrevAudio(i,{ignoreClaimed:!0}).then((e=>{e?s(e,-1):this.seek(0)}))}}getPrevAudio(){var e=this;return(0,s.default)(o.mark((function t(){var i,a;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.getPlaylistQueue(),!(a=e.getCurrentAudio())){t.next=4;break}return t.abrupt("return",i.getPrevAudio(a,{ignoreClaimed:!0,repeat:e.isRepeatAll()}));case 4:return t.abrupt("return",i.getLastAudio(!0));case 5:case"end":return t.stop()}}),t)})))()}getNextAudio(){var e=this;return(0,s.default)(o.mark((function t(){var i,a;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.getPlaylistQueue(),!(a=e.getCurrentAudio())){t.next=4;break}return t.abrupt("return",i.getNextAudio(a,{ignoreClaimed:!0,repeat:e.isRepeatAll()}));case 4:return t.abrupt("return",i.getFirstAudio(!0));case 5:case"end":return t.stop()}}),t)})))()}adsGetCurrentProgress(){return this.ads.getCurrentProgress()}_podcastUpdateState(e,t,i,a,o){var s=ie._podcastGetStates(),r=Math.round(e.duration*t);s[e.fullId]={t:(0,c.vkNow)(),position:r},ie._podcastSetStates(s),a&&this._podcastSendLogs(a,e,i,r,o)}_podcastSendLogs(e,t,i,a,o){if(t&&e&&r.AudioUtils.isPodcast(t)&&(!cur._podcastsActionId||!cur._podcastsActionId[e]||this._podcastsActionLastId[e]!==cur._podcastsActionId[e])){var s=this._podcastsActionRef[t.fullId]||{},l=s[e]||{};r.AudioUtils.PodcastsLogs.log(e,(0,P.extend)({audio:t,position:a,listen:i},l,o||{})),delete s[e],this._podcastsActionLastId[e]=cur._podcastsActionId?cur._podcastsActionId[e]:null}}podcastSetActionRef(e,t,i,a){e=r.AudioUtils.audioTupleToAudioObject(e),t&&r.AudioUtils.isPodcast(e)&&(this._podcastsActionRef[e.fullId]=this._podcastsActionRef[e.fullId]||{},this._podcastsActionRef[e.fullId][t]={ref:i,refEl:a},cur._podcastsActionId=cur._podcastsActionId||{},cur._podcastsActionId[t]=(0,c.irand)(0,1e6))}toggleRadio(e,t){var i=this.getPlaylist(v.AudioPlaylist.TYPE_RADIO,t,v.AudioPlaylist.RADIO_PLAYLIST_ID),a=i.getAudiosList().find((t=>t[G.EAudioTupleIndex.ID]===e));a&&(this.isPlaying()&&(0,X.isRadio)(this._currentAudio)&&a[G.EAudioTupleIndex.ID]===this._currentAudio[G.EAudioTupleIndex.ID]?this.pause():this.play(a,i))}_podcastCleanStates(){var e=ie._podcastGetStates(),t=!1;return(0,P.each)(e,((i,a)=>{Date.now()-a.t>2419200&&(delete e[i],t=!0)})),t&&ie._podcastSetStates(e),e}_podcastSaveData(e){var t=ie._podcastGetStates();(0,P.each)(e,((e,i)=>{var a=i.state;if(a){var o=+a[1];(!t[e]||!t[e][1]||o&&o>t[e][1])&&(t[e]={position:+a[0],t:Date.now()})}})),ie._podcastSetStates(t)}_podcastRestoreState(){var e=r.AudioUtils.audioTupleToAudioObject(this.getCurrentAudio());if(!r.AudioUtils.isPodcast(e))return 0;var t=0;cur.podcastSeekToTime?(t=this.seekToTime(cur.podcastSeekToTime,cur.podcastSeekToTimeRef),delete cur.podcastSeekToTime,delete cur.podcastSeekToTimeRef):(t=((ie._podcastGetStates()[e.fullId]||{}).position||0)/e.duration)&&t<1&&this.implTaskManager.seek(t);return t&&t<1?(this.updateCurrentPlaying(),t):0}getCurrentFaveStatus(){return!!r.AudioUtils.isPodcast(this._currentAudio)&&r.AudioUtils.getAudioExtra(this._currentAudio).fave}_updatePlaybackRate(){var e=r.AudioUtils.isPodcast(this._currentAudio)||r.AudioUtils.isArticleTts(this._currentAudio),t=!this.ads.isPlaying()&&e?ie.podcastGetPlaybackRate():1;this.implTaskManager.updatePlaybackRate(t)}podcastChangePlaybackRate(e){var t=ie._lsGet(ie.LS_PODCASTS)||ee,i=t.rate||1;e?i-=ie.PLAYBACK_RATE_STEP:i+=ie.PLAYBACK_RATE_STEP,!e&&i>ie.PLAYBACK_RATE_MAX?i=1:e&&i<1&&(i=ie.PLAYBACK_RATE_MAX),t.rate=i,ie._lsSet(ie.LS_PODCASTS,t),ee=t,this._updatePlaybackRate()}playAudio(e){var t=v.AudioPlaylist.TYPE_TEMP;(0,z.isArticleTts)(e)&&(t=v.AudioPlaylist.TYPE_ARTICLE_TTS);var i=new v.AudioPlaylist(t);i.mergeWith({list:[e]}),this.play(e,i)}}function ae(e,t,i){var a=e.getContext("2d");a.clearRect(0,0,e.width,e.height),a.fillStyle=i;for(var o=0;o<4;o++){var s=2+12*t[o];a.fillRect(13+4*o,12-s+14,2,s)}}ie.UNAUTH_FADE_TIME=.8,ie.LS_VER="v20",ie.LS_KEY_PREFIX="audio",ie.LS_PREFIX=ie.LS_KEY_PREFIX+"_"+ie.LS_VER+"_",ie.LS_STATUS_EXPORT=ie.LS_KEY_PREFIX+"_status_export",ie.LS_VOLUME="vol",ie.LS_PL="pl",ie.LS_TRACK="track",ie.LS_SAVED="saved",ie.LS_PROGRESS="progress",ie.LS_PODCASTS="podcasts",ie.LS_DURATION_TYPE="dur_type",ie.LS_UUID="uuid",ie.LS_ADS_CURRENT_DELAY="ads_current_delay_v4",ie.LS_SHOW_HQ_LABEL="_audio_show_hq_label",ie.PLAYBACK_RATE_STEP=.5,ie.PLAYBACK_RATE_MAX=l.browser.safari?2:3,ie.tabIcons={def:"/images/icons/favicons/fav_logo.ico",play:"/images/icons/favicons/fav_play.ico",pause:"/images/icons/favicons/fav_pause.ico"}},415012:(e,t,i)=>{"use strict";i.d(t,{init:()=>n});var a=i(969442),o=i(819086),s=i(183945),r=i(43873),l=i(59786),d=i(669729);function n(){window.AudioLayer=a.default,window.AudioUtils=o.AudioUtils,window.TopAudioPlayer=s.TopAudioPlayer,window.AudioPlaylist=r.AudioPlaylist,window.AudioPlayer=l.AudioPlayer,window.AudioPlayerUI=d.AudioPlayerUI}},356090:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={credits:"AudioLyricsCredits-module__credits--SkXG0"}},663922:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={content:"AudioLyricsLayout-module__content--Yn4uA",scroll:"AudioLyricsLayout-module__scroll--y9bX1"}},638253:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={line:"AudioLyricsLine-module__line--CPc2q",clickable:"AudioLyricsLine-module__clickable--ZTmww",inactive:"AudioLyricsLine-module__inactive--paBlE",text:"AudioLyricsLine-module__text--mhAkK",interlude:"AudioLyricsLine-module__interlude--rYx8B"}},528915:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={countdown:"AudioLyricsLottieCountdown-module__countdown--nQD7J",animation:"AudioLyricsLottieCountdown-module__animation--YL5aK"}},409398:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={countdown:"KaraokeAudioLyrics-module__countdown--SUEK6",hidden:"KaraokeAudioLyrics-module__hidden--BlBBx"}},426629:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={layout:"AudioLyricsModal-module__layout--XqLk5",header:"AudioLyricsModal-module__header--EnprT",player:"AudioLyricsModal-module__player--JBxan",content:"AudioLyricsModal-module__content--YNjA4",headerWrapper:"AudioLyricsModal-module__headerWrapper--D6CJM",playerWrapper:"AudioLyricsModal-module__playerWrapper--ytzeE"}},456382:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={cover:"AudioCover-module__cover--uI1am",placeholder:"AudioCover-module__placeholder--bCJ5D",blur:"AudioCover-module__blur--OX7g9",image:"AudioCover-module__image--Di5vf"}},524801:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={header:"AudioLyricsModalHeader-module__header--w1tIW",cover:"AudioLyricsModalHeader-module__cover--BlJ5F",info:"AudioLyricsModalHeader-module__info--gyBbt",titleContainer:"AudioLyricsModalHeader-module__titleContainer--wjE3G",title:"AudioLyricsModalHeader-module__title--pd16O",explicit:"AudioLyricsModalHeader-module__explicit--fFVIG",performer:"AudioLyricsModalHeader-module__performer--uVZty"}},463216:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={player:"AudioLyricsPlayer-module__player--uS_Gz",progress:"AudioLyricsPlayer-module__progress--MECMp",slider:"AudioLyricsPlayer-module__slider--nab_T",time:"AudioLyricsPlayer-module__time--ZRZ2S",controls:"AudioLyricsPlayer-module__controls--IJTno"}},594448:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={button:"PlayButton-module__button--SjSi8"}},767664:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={button:"TertiaryIconButton-module__button--IZGFX"}},969230:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={slider:"AudioSlider-module__slider--f7gJP",ads:"AudioSlider-module__ads--t4MV3"}},169893:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});const a={view:"CustomScrollView-module__view--Lc_gX",box:"CustomScrollView-module__box--niVOQ",barY:"CustomScrollView-module__barY--MAlaL",trackerY:"CustomScrollView-module__trackerY--g_aoZ",hidden:"CustomScrollView-module__hidden--E3Eu7"}},677865:(e,t,i)=>{"use strict";i.d(t,{MarusiaWebPlayerAdapter:()=>o});var a=i(819086);class o{constructor(e){this.player=e}play(e,t,i){this.player.play(e,t,i)}pause(){this.player.pause()}playNext(e){this.player.playNext(e)}playPrev(){this.player.playPrev()}seekToTime(e){this.player.seekToTime(e)}toggleRepeatCurrentAudio(){this.player.toggleRepeatCurrentAudio()}toggleRepeatAll(){this.player.toggleRepeatAll()}getVolume(){return this.player.getVolume()}setVolume(e){this.player.setVolume(e)}getCurrentPlaylist(){var e;return null===(e=this.player.getCurrentPlaylist())||void 0===e?void 0:e.getSelf()}deleteCurrentPlaylist(){this.player.deleteCurrentPlaylist()}addPlaylist(e){this.player.addPlaylist(e)}isPlaying(){return this.player.isPlaying()}getCurrentAudio(){return this.player.getCurrentAudio()}getProgressInSeconds(){const e=this.player.getCurrentAudio();return e?Math.round(this.player.getCurrentProgress()*e[a.AudioUtils.AUDIO_ITEM_INDEX_DURATION]):0}getPlayerData(){var e,t,i,a;return{position:null!==(t=null===(e=this.getCurrentPlaylist())||void 0===e?void 0:e.indexOfAudio(this.getCurrentAudio()))&&void 0!==t?t:0,duration:null!==(a=null===(i=this.player._impl)||void 0===i?void 0:i.getDuration())&&void 0!==a?a:0,elapsed:this.getProgressInSeconds(),state:this.isPlaying()?"PLAY":"PAUSE",volume:Math.round(100*this.getVolume())}}preparePlay(){var e;null===(e=this.player._impl)||void 0===e||e.preparePlay()}}},285132:(e,t,i)=>{"use strict";i.d(t,{followOwner:()=>s});var a=i(937884),o=i(274642);function s(e,t){window.ajax.post("/al_audio.php?act=follow_owner",{owner_id:e,hash:t},{onDone:()=>{(0,o.getAudioPlayer)().notify(a.events.MUSIC_OWNERS_FOLLOW)}})}},291976:(e,t,i)=>{"use strict";i.d(t,{unfollowOwner:()=>s});var a=i(937884),o=i(274642);function s(e,t){window.ajax.post("/al_audio.php?act=unfollow_owner",{owner_id:e,hash:t},{onDone:()=>{(0,o.getAudioPlayer)().notify(a.events.MUSIC_OWNERS_UNFOLLOW)}})}},746785:(e,t,i)=>{"use strict";i.d(t,{RadiostationEventsHandling:()=>l});var a=i(182804),o=i(274642),s=i(719927),r=i(333097);class l{constructor(){try{this.tq=(0,a.tq)()}catch(e){return}this.connectFollowingEvents(),this.connectUnFollowingEvents(),this.connectPlayToggleEvent()}connectFollowingEvents(){this.tq.setInteractiveHandler("Music/follow_radiostation",(({payload:e})=>{e.dataAttrs&&e.dataAttrs.stationId&&e.dataAttrs.hash&&(0,s.followRadiostation)(parseInt(e.dataAttrs.stationId,10),e.dataAttrs.hash).then((()=>{e.target instanceof HTMLElement&&(e.target.dataset.taskClick="Music/unfollow_radiostation")}))}))}connectUnFollowingEvents(){this.tq.setInteractiveHandler("Music/unfollow_radiostation",(({payload:e})=>{e.dataAttrs&&e.dataAttrs.stationId&&e.dataAttrs.hash&&(0,r.unfollowRadiostation)(parseInt(e.dataAttrs.stationId,10),e.dataAttrs.hash).then((()=>{e.target instanceof HTMLElement&&(e.target.dataset.taskClick="Music/follow_radiostation")}))}))}connectPlayToggleEvent(){this.tq.setInteractiveHandler("Music/toggle_radio_play",(({payload:e})=>{if(e.dataAttrs){const{stationId:t,playlistOwnerId:i}=e.dataAttrs;if(!t||!i)return;const a=(0,o.getAudioPlayer)();a&&a.toggleRadio(parseInt(t,10),parseInt(i,10))}}))}}},719927:(e,t,i)=>{"use strict";i.d(t,{followRadiostation:()=>d});var a=i(414325),o=i(274642),s=i(937884),r=i(501389),l=i(70162);function d(e,t){return(new a.FetchService).followRadiostation(e,t).then((t=>{if(t){const t=(0,o.getAudioPlayer)();t&&t.notify(s.events.RADIOSTATION_FOLLOW,e),(0,r.showDoneBoxFull)("",{},{title:l.getLang("audio_follow_radiostation_success_notification_title"),text:l.getLang("audio_follow_radiostation_success_notification_text")})}}))}},333097:(e,t,i)=>{"use strict";i.d(t,{unfollowRadiostation:()=>r});var a=i(414325),o=i(274642),s=i(937884);function r(e,t){return(new a.FetchService).unfollowRadiostation(e,t).then((t=>{if(t){const t=(0,o.getAudioPlayer)();t&&t.notify(s.events.RADIOSTATION_UNFOLLOW,e)}}))}},924583:(e,t,i)=>{"use strict";i.d(t,{updateFaveStatusAfterFollow:()=>n});var a=i(166773),o=i(722904),s=i(43873),r=i(377673),l=i(896438),d=i(274642);function n(e,t){const i=(0,d.getAudioPlayer)();i.getPlaylistsByType(s.AudioPlaylist.TYPE_RADIO).forEach((i=>{i.getAudiosList().forEach((i=>{i[o.EAudioTupleIndex.ID]===e&&u(i,t)}))})),Array.from(document.querySelectorAll(".audio_player_radio_station._audio_page_player")).forEach((i=>{const a=(0,r.getAudioFromEl)(i);a&&a[o.EAudioTupleIndex.ID]===e&&(u(a,t),i.dataset.audio=JSON.stringify(a))}));const l=i.getCurrentPlaylist();l&&l.getType()===s.AudioPlaylist.TYPE_RADIO&&i.saveStateCurrentPlaylist();const n=i.getCurrentAudio();(0,a.isRadio)(n)&&(u(n,t),i._saveStateCurrentAudio())}function u(e,t){const i=(0,l.getAudioExtra)(e);i&&i.fave!==t&&(i.fave=t,e[o.EAudioTupleIndex.EXTRA]=i)}},442246:(e,t,i)=>{"use strict";i.d(t,{WebAudioPlayerAdapter:()=>l});var a=i(51488),o=i(43873),s=i(65751),r=i(35764);class l{constructor(e){this.webAudioPlayer=e,this.ads=e.ads}playAudio(e,t,i,s){const l=new a.WebPlayerAdapter(this.webAudioPlayer).getPlaylistId(),d=s?this.webAudioPlayer.getPlaylist(s.type,s.ownerId,s.albumId):l?this.webAudioPlayer.getCurrentPlaylist():this.webAudioPlayer.getPlaylist(o.AudioPlaylist.TYPE_TEMP,window.vk.id),n=(0,r.apiAudioToAudioTuple)(e),u=null==t?void 0:t.map(r.apiAudioToAudioTuple);this.webAudioPlayer.getPlaylistQueue().setSortedQueue(u),this.webAudioPlayer.play(n,d,i)}playPlaylist(e,t){this.webAudioPlayer.playPlaylist(e.owner_id,e.id,e.access_key,t)}playPreviousAudio(){this.webAudioPlayer.playPrev()}playNextAudio(){this.webAudioPlayer.playNext()}pause(){this.webAudioPlayer.pause()}stop(){this.webAudioPlayer.stop()}setVolume(e){this.webAudioPlayer.setVolume(e)}setCurrentAudioProgress(e){this.webAudioPlayer.seek(e)}getCurrentAudio(){return(0,s.audioTupleToApiAudio)(this.webAudioPlayer.getCurrentAudio())}getCurrentAudioProgress(){return this.webAudioPlayer.getCurrentProgress()}getCurrentAudioVolume(){return this.webAudioPlayer.getVolume()}getCurrentPlaylist(){var e;const t=this.webAudioPlayer.getCurrentPlaylist();if(!t)return null;const i=t.getPlaylistId(),a=t.getOwnerId();if("string"==typeof i)return null;const o=t.getCoverUrl(),s=o?{width:300,height:300,photo_300:o,sizes:[{width:300,height:300,src:o,type:"z"}]}:void 0,r={access_key:t.getAccessHash(),title:t.getTitle(),subtitle:t.getSubtitle(),count:t.getTotalCount(),plays:t.getListens(),update_time:t.getLastUpdated(),is_following:t.isFollowed(),album_type:t.getType(),description:t.getDescription(),photo:s,thumbs:s?[s]:void 0};return(null===(e=null==t?void 0:t.isFollowed)||void 0===e?void 0:e.call(t))?r.original={owner_id:a,playlist_id:i,access_key:t.getAccessHash()}:(r.owner_id=a,r.id=i),r}subscribe(e,t,i){return this.webAudioPlayer.on(i,e,t)}unsubscribe(e,t,i){if(void 0!==i)return this.webAudioPlayer.off(i)}isPlaying(){return this.webAudioPlayer.isPlaying()}}},511867:(e,t,i)=>{"use strict";i.d(t,{WebQueueListener:()=>o});var a=i(772703);class o extends a.QueueListener{constructor(e){super(e)}connect(e){e&&this.listenQueueKey!==e.key&&(this.connected=!0,this.listenQueueKey=e.key,window.Notifier.addKey({key:e.key,ts:e.timestamp},((e,t)=>this.queueHandler(t))))}}},735179:(e,t,i)=>{"use strict";i.d(t,{voiceMessagePlayerLoader:()=>a,speechLoader:()=>o});const a=()=>window.AudioMessagePlayer&&window.AudioMessagePlayer.loaded?Promise.resolve(window.AudioMessagePlayer):Promise.all([i.e(40885),i.e(68592),i.e(9375)]).then(i.bind(i,352547)).then((()=>window.AudioMessagePlayer)),o=()=>Promise.all([i.e(40885),i.e(28762)]).then(i.bind(i,991682))},991682:(e,t,i)=>{"use strict";i.r(t);var a=i(10593),o=i(376504);const s={isSupport:()=>!(!window.AudioContext||!(navigator.getUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)),getAvailableMicrophones:()=>a.AudioRecorder.isSupport()?a.AudioRecorder.getAvailableMicrophones():Promise.resolve([]),newRecorder:()=>(window.Promise||(window.Promise=Promise),new a.AudioRecorder),resample:(e,t,i)=>(0,o.fastResample)(e,t,i),createVisualization:i(397392).createVisualization};window.Speech=s},669729:(e,t,i)=>{"use strict";i.d(t,{AudioPlayerUI:()=>o});var a=i(817608);class o{constructor({audioPlayer:e}){this.lyrics=new a.AudioPlayerLyricsUI({audioPlayer:e})}}},691180:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsModalController:()=>r});var a=i(570655),o=i(667294),s=i(261508);class r{constructor({audioPlayer:e}){this.unmountFn=null,this.unmount=()=>{this.unmountFn&&this.unmountFn(),this.unmountFn=null},this.handleClosed=()=>{this.unmount()},this.audioPlayer=e}load(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){yield this.loadApplication()}))}open(e){this.mount(e)}destroy(){this.unmount()}mount({audio:e,playlist:t,context:i}){return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(this.unmountFn)return;const a=yield this.loadApplication();(0,s.showComponentInBox)((0,o.createElement)(a,{audio:e,playlist:t,context:i,audioPlayer:this.audioPlayer,onClosed:this.handleClosed}),{onDestroy:this.unmount,width:490}),this.unmountFn=()=>{(0,s.destroyComponentInBox)()}}))}loadApplication(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return(yield Promise.all([i.e(40885),i.e(38288),i.e(96816)]).then(i.bind(i,141337))).AudioLyricsModalApplication}))}}},276724:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsCredits:()=>s});var a=i(785893),o=i(356090);function s({children:e}){return(0,a.jsx)("div",Object.assign({className:o.default.credits},{children:e}),void 0)}},528594:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsLayout:()=>r});var a=i(785893),o=i(840402),s=i(663922);function r({children:e,scrollRef:t,compensationTop:i,height:r,width:l,onWheel:d,onScroll:n,onTouchStart:u,onTouchMove:_,onTouchEnd:c,onTrackerDragStart:p,onTrackerDragStop:h}){return(0,a.jsx)("div",Object.assign({style:{height:r,width:l}},{children:(0,a.jsx)(o.CustomScrollView,Object.assign({boxRef:t,className:s.default.scroll,onWheel:d,onScroll:n,onTouchStart:u,onTouchMove:_,onTouchEnd:c,onTrackerDragStart:p,onTrackerDragStop:h},{children:(0,a.jsx)("div",Object.assign({className:s.default.content,style:{paddingTop:i||void 0}},{children:e}),void 0)}),void 0)}),void 0)}},902092:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsLine:()=>d});var a=i(785893),o=i(667294),s=i(659397),r=i(22390),l=i(638253);const d=(0,o.forwardRef)((function({text:e,interlude:t,active:i,onClick:o},d){const n=(0,s.classNames)(l.default.line,!1===i&&l.default.inactive,o&&l.default.clickable),u=()=>{o&&o()};return e?(0,a.jsx)("div",Object.assign({ref:d,className:n,onClick:u},{children:(0,a.jsx)("div",Object.assign({className:l.default.text},{children:e}),void 0)}),void 0):t?(0,a.jsx)("div",Object.assign({ref:d,className:(0,s.classNames)(n,l.default.interlude),onClick:u},{children:(0,a.jsx)("div",Object.assign({className:(0,s.classNames)("foo",l.default.text)},{children:(0,a.jsx)(r.default,{},void 0)}),void 0)}),void 0):null}))},386064:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsLottieCountdown:()=>u});var a,o=i(785893),s=i(667294),r=i(809499),l=i(405507),d=i(383047),n=i(528915);function u({time:e,playing:t}){const i=(0,s.useRef)(null),u=(0,s.useRef)(null),c=(0,s.useRef)(null),p=(0,s.useRef)(null),h=(0,s.useRef)(null),g=function(e){if(e<=0)return a.None;if(e<=4330)return a.S3;return a.Dots}(e);return(0,s.useLayoutEffect)((()=>{const e=i.current,t=u.current;e&&t&&(c.current=r.lottie.loadAnimation({container:e,loop:!0,autoplay:!1,renderer:"svg",animationData:l}),c.current.hide(),p.current=r.lottie.loadAnimation({container:t,loop:!1,autoplay:!1,renderer:"svg",animationData:d}),p.current.hide())}),[]),(0,s.useLayoutEffect)((()=>{const e=e=>{!function(e,t){if(!e)return;e.show(),t&&e.play()}(e,t),h.current=e},i=t=>{const i=h.current;if(!i)return void e(t);if(!i.loop)return _(i),void e(t);const a=()=>{_(i),e(t),i.removeEventListener("loopComplete",a)};return i.addEventListener("loopComplete",a)};switch(g){case a.None:{const e=setTimeout((()=>{i(null)}),1e3);return()=>{clearTimeout(e)}}case a.Dots:return i(c.current);case a.S3:return i(p.current)}}),[g]),(0,s.useLayoutEffect)((()=>{const e=h.current;if(e){if(!t){e.loop||e.pause();const t=()=>{e.pause(),e.removeEventListener("loopComplete",t)};return e.addEventListener("loopComplete",t)}e.play()}}),[t]),(0,s.useEffect)((()=>()=>{var e,t;null===(e=c.current)||void 0===e||e.destroy(),null===(t=p.current)||void 0===t||t.destroy()}),[]),(0,o.jsxs)("div",Object.assign({className:n.default.countdown},{children:[(0,o.jsx)("div",{ref:i,className:n.default.animation},void 0),(0,o.jsx)("div",{ref:u,className:n.default.animation},void 0)]}),void 0)}function _(e){e&&(e.hide(),e.stop())}!function(e){e[e.None=0]="None",e[e.Dots=1]="Dots",e[e.S3=2]="S3"}(a||(a={}))},461901:(e,t,i)=>{"use strict";i.d(t,{KaraokeAudioLyrics:()=>g});var a=i(785893),o=i(667294),s=i(659397),r=i(429904),l=i(528594),d=i(902092),n=i(276724),u=i(386064),_=i(215723),c=i(28697),p=i(696560),h=i(409398);function g({lines:e,credits:t,timeMs:i,isPlaying:g,compensationTop:y=0,height:A,width:f}){const P=e[0].begin,v=P>=5e3,E=i-P>2e3,{isManualScrollMode:m,onManualScroll:w,setScrollModeAuto:b}=(0,c.useManualScrollMode)({isPlaying:g}),{currentLineIndex:I}=(0,p.useTimingLines)({lines:e,timeMs:i,withCountdown:v}),C=(0,o.useRef)(null),T=(0,o.useRef)(null);(0,o.useLayoutEffect)((()=>{if(m)return;const e=T.current,t=C.current;if(t){const i=Math.max(0,((null==e?void 0:e.offsetTop)||0)-y);t.scrollTo({top:i,behavior:"smooth"})}}),[I,m,v]);const L=(0,_.useEventProcess)({timeout:3e3}),O=(0,_.useEventProcess)({timeout:3e3}),D=(0,_.useEventProcess)({timeout:100}),k=(0,o.useMemo)((()=>(0,s.throttle)((()=>{w()}),50)),[w]),S=(0,r.useEventCallback)((()=>{D.start()})),U=(0,o.useMemo)((()=>(0,s.throttle)((()=>{S()}),50)),[S]),x=(0,r.useEventCallback)((()=>{L.ref.current&&L.update();(L.ref.current||O.ref.current||D.ref.current)&&k()})),M=(0,o.useMemo)((()=>(0,s.throttle)((()=>{x()}),50)),[x]);return(0,a.jsxs)(l.AudioLyricsLayout,Object.assign({scrollRef:C,onWheel:U,onTrackerDragStart:L.start,onTrackerDragStop:L.end,onTouchStart:O.start,onTouchEnd:O.end,onTouchMove:O.update,onScroll:M,compensationTop:y,height:A,width:f},{children:[v&&(0,a.jsx)("div",Object.assign({className:(0,s.classNames)(h.default.countdown,E&&h.default.hidden)},{children:(0,a.jsx)(u.AudioLyricsLottieCountdown,{time:Math.max(0,P-i),playing:g},void 0)}),void 0),e.map(((e,t)=>{const{changeProgress:i}=e,o=t===I,s=i&&(()=>{i(),L.end(),O.end(),D.end(),b()});return(0,a.jsx)(d.AudioLyricsLine,{ref:o?T:void 0,text:e.text,interlude:e.interlude,active:o||m,onClick:s},t)})),!!t&&(0,a.jsx)(n.AudioLyricsCredits,{children:t},void 0)]}),void 0)}},215723:(e,t,i)=>{"use strict";i.d(t,{useEventProcess:()=>s});var a=i(667294),o=i(429904);function s({timeout:e,onChange:t}={}){const i=(0,a.useRef)(!1),s=(0,a.useRef)(),r=e=>{i.current=e,t&&t(e)},l=()=>{"number"==typeof e&&(clearTimeout(s.current),s.current=setTimeout((()=>{s.current=void 0,r(!1)}),5e3))},d=(0,o.useEventCallback)((()=>{r(!0),l()})),n=(0,o.useEventCallback)((()=>{i.current&&null===s.current||l()})),u=(0,o.useEventCallback)((()=>{r(!1)}));return{ref:i,start:d,update:n,end:u}}},28697:(e,t,i)=>{"use strict";i.d(t,{useManualScrollMode:()=>o});var a=i(667294);function o({isPlaying:e}){const[t,i]=function(){const e=(0,a.useRef)(),[t,i]=(0,a.useState)(!1),o=(0,a.useCallback)((t=>{i(t),clearTimeout(e.current),t&&(e.current=setTimeout((()=>{i(!1)}),5e3))}),[]);return(0,a.useEffect)((()=>()=>{clearTimeout(e.current)}),[]),[t,o]}(),[o,s]=(0,a.useState)(t);(0,a.useEffect)((()=>{s(e?t:e=>e||t)}),[e,t]);const r=(0,a.useCallback)((()=>{i(!0)}),[]);return{isManualScrollMode:o,setScrollModeAuto:(0,a.useCallback)((()=>{i(!1)}),[]),onManualScroll:r}}},696560:(e,t,i)=>{"use strict";i.d(t,{useTimingLines:()=>o});var a=i(667294);function o({lines:e,timeMs:t,withCountdown:i}){const o=(0,a.useRef)(-1),s=(0,a.useRef)(0);let r,l;const d=()=>{l=e[o.current],r=e[s.current]};for(d(),l&&l.begin>t&&(o.current=e.findIndex((e=>e.begin>=t))-Number(i),s.current=o.current+1,d());r&&t>=r.begin;)o.current=s.current,s.current++,d();return{currentLine:l,nextLine:r,currentLineIndex:o.current,nextLineIndex:s.current}}},964733:(e,t,i)=>{"use strict";i.d(t,{StaticAudioLyrics:()=>l});var a=i(785893),o=i(528594),s=i(902092),r=i(276724);function l({lines:e,credits:t,compensationTop:i,height:l,width:d}){return(0,a.jsxs)(o.AudioLyricsLayout,Object.assign({height:l,width:d,compensationTop:i},{children:[e.map(((e,t)=>(0,a.jsx)(s.AudioLyricsLine,{text:e.text,interlude:e.interlude},t))),!!t&&(0,a.jsx)(r.AudioLyricsCredits,{children:t},void 0)]}),void 0)}},267150:(e,t,i)=>{"use strict";i.d(t,{StaticAudioLyrics:()=>a.StaticAudioLyrics,KaraokeAudioLyrics:()=>o.KaraokeAudioLyrics});var a=i(964733),o=i(461901)},677245:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsAds:()=>l});var a=i(785893),o=i(86894),s=i(365801),r=i(70162);function l(){return(0,a.jsx)(o.Placeholder,Object.assign({icon:(0,a.jsx)(s.default,{},void 0)},{children:r.getLang("audio_lyrics_ads")}),void 0)}},962707:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsError:()=>l});var a=i(785893),o=i(86894),s=i(74971),r=i(70162);function l({onRetryClick:e}){return(0,a.jsx)(o.Placeholder,Object.assign({action:(0,a.jsx)(o.Button,Object.assign({size:"l",mode:"secondary",before:(0,a.jsx)(s.default,{},void 0),onClick:()=>{e()}},{children:r.getLang("audio_lyrics_error_btn_retry")}),void 0)},{children:r.getLang("audio_lyrics_error")}),void 0)}},148313:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsModal:()=>l});var a=i(785893),o=i(623122),s=i(86894),r=i(426629);function l({header:e,content:t,player:i,onClose:l}){return(0,a.jsxs)(o.ModalBox,{children:[(0,a.jsx)(s.ModalDismissButton,{onClick:()=>l()},void 0),(0,a.jsxs)("div",Object.assign({className:r.default.layout},{children:[(0,a.jsx)("div",Object.assign({className:r.default.headerWrapper},{children:(0,a.jsx)("div",Object.assign({className:r.default.header},{children:e}),void 0)}),void 0),(0,a.jsx)("div",Object.assign({className:r.default.content},{children:t}),void 0),(0,a.jsx)("div",Object.assign({className:r.default.playerWrapper},{children:(0,a.jsx)("div",Object.assign({className:r.default.player},{children:i}),void 0)}),void 0)]}),void 0)]},void 0)}},235096:(e,t,i)=>{"use strict";i.d(t,{AudioCover:()=>n});var a=i(785893),o=i(667294),s=i(659397),r=i(564139),l=i(840060),d=i(456382);function n({url:e}){const[t,i]=(0,o.useState)(!1);return(0,o.useLayoutEffect)((()=>{i(!1)}),[e]),!e||t?(0,a.jsx)("div",Object.assign({className:(0,s.classNames)(d.default.cover,d.default.placeholder)},{children:(0,a.jsx)(r.default,{},void 0)}),void 0):(0,a.jsxs)("div",Object.assign({className:d.default.cover},{children:[!l.browser.safari&&(0,a.jsx)("div",{className:d.default.blur,style:{backgroundImage:`url(${e})`}},void 0),(0,a.jsx)("img",{src:e,className:d.default.image,onError:()=>{i(!0)}},void 0)]}),void 0)}},709459:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsModalHeader:()=>l});var a=i(785893),o=i(765098),s=i(235096),r=i(524801);function l({title:e,explicit:t,performer:i,coverUrl:l}){return(0,a.jsxs)("div",Object.assign({className:r.default.header},{children:[(0,a.jsx)("div",Object.assign({className:r.default.cover},{children:(0,a.jsx)(s.AudioCover,{url:l},void 0)}),void 0),(0,a.jsxs)("div",Object.assign({className:r.default.info},{children:[(0,a.jsxs)("div",Object.assign({className:r.default.titleContainer},{children:[(0,a.jsx)("span",Object.assign({className:r.default.title},{children:e}),void 0),t&&(0,a.jsx)("div",Object.assign({className:r.default.explicit},{children:(0,a.jsx)(o.default,{},void 0)}),void 0)]}),void 0),(0,a.jsx)("span",Object.assign({className:r.default.performer},{children:i}),void 0)]}),void 0)]}),void 0)}},737590:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsNotFound:()=>l});var a=i(785893),o=i(86894),s=i(867484),r=i(70162);function l(){return(0,a.jsx)(o.Placeholder,Object.assign({icon:(0,a.jsx)(s.default,{},void 0)},{children:r.getLang("audio_track_has_no_lyrics_yet")}),void 0)}},455434:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsPlayer:()=>u});var a=i(785893),o=i(676733),s=i(711746),r=i(169409),l=i(666445),d=i(210127),n=i(463216);function u(e){const{isPlaying:t,isAds:i}=e;return(0,a.jsxs)("div",Object.assign({className:n.default.player},{children:[(0,a.jsxs)("div",Object.assign({className:n.default.progress},{children:[(0,a.jsx)("div",Object.assign({className:n.default.slider},{children:(0,a.jsx)(r.AudioSlider,{value:e.progress,backValue:e.buffered,onDragEnd:e.onChangeProgress,disabled:e.sliderDisabled,type:i?"ads":"audio"},void 0)}),void 0),(0,a.jsx)("div",Object.assign({className:n.default.time},{children:e.time}),void 0)]}),void 0),(0,a.jsxs)("div",Object.assign({className:n.default.controls},{children:[(0,a.jsx)(d.TertiaryIconButton,Object.assign({onClick:e.onPlayPrev,disabled:e.prevDisabled},{children:(0,a.jsx)(o.default,{},void 0)}),void 0),(0,a.jsx)(l.PlayButton,{icon:t?"pause":"play",onClick:e.onTogglePlaying,disabled:e.playDisabled},void 0),(0,a.jsx)(d.TertiaryIconButton,Object.assign({onClick:e.onPlayNext,disabled:e.nextDisabled},{children:(0,a.jsx)(s.default,{},void 0)}),void 0)]}),void 0)]}),void 0)}},666445:(e,t,i)=>{"use strict";i.d(t,{PlayButton:()=>l});var a=i(785893),o=i(362873),s=i(774608),r=i(594448);function l(e){return(0,a.jsx)("button",Object.assign({type:"button"},e,{className:r.default.button},{children:"play"===e.icon?(0,a.jsx)(o.default,{},void 0):(0,a.jsx)(s.default,{},void 0)}),void 0)}},210127:(e,t,i)=>{"use strict";i.d(t,{TertiaryIconButton:()=>s});var a=i(785893),o=i(767664);function s(e){return(0,a.jsx)("button",Object.assign({type:"button"},e,{className:o.default.button}),void 0)}},169409:(e,t,i)=>{"use strict";i.d(t,{AudioSlider:()=>u});var a=i(785893),o=i(667294),s=i(659397),r=i(429904),l=i(830169),d=i(866914),n=i(969230);function u({value:e,backValue:t,disabled:i,onDragEnd:u,type:_}){const c=(0,o.useRef)(null),p=(0,o.useRef)(),h=(0,r.useEventCallback)(u);return(0,o.useEffect)((()=>{const a=c.current,o=new d.default(a,{value:e,backValue:t,size:1,withBackLine:"number"==typeof t,onEndDragging:h});return p.current=o,o.setBlocked(i),()=>{o.destroy()}}),[]),(0,o.useLayoutEffect)((()=>{const e=p.current;e&&e.toggleAdState("ads"===_)}),["ads"===_]),(0,l.useUpdateLayoutEffect)((()=>{const e=p.current;e&&e.setBlocked(i)}),[i]),(0,l.useUpdateLayoutEffect)((()=>{const t=p.current;t&&t.setValue(e)}),[e]),(0,l.useUpdateLayoutEffect)((()=>{const e=p.current;e&&e.setBackValue(t)}),[t]),(0,a.jsx)("div",Object.assign({className:(0,s.classNames)(n.default.slider,"ads"===_&&n.default.ads)},{children:(0,a.jsx)("div",{ref:c},void 0)}),void 0)}},840402:(e,t,i)=>{"use strict";i.d(t,{CustomScrollView:()=>c});var a=i(785893),o=i(667294),s=i(659397),r=i(181498),l=i(214542),d=i(428253),n=i(151571),u=i(392844),_=i(169893);const c=({className:e,children:t,boxRef:i,windowResize:c,autoHideScrollbar:p=!1,autoHideScrollbarDelay:h,onWheel:g,onScroll:y,onTouchStart:A,onTouchMove:f,onTouchEnd:P,onTrackerDragStart:v,onTrackerDragStop:E})=>{const{document:m,window:w}=(0,r.useDOM)(),b=o.useRef(NaN),I=o.useRef(0),C=o.useRef(0),T=o.useRef(0),L=o.useRef(0),O=o.useRef(""),D=o.useRef(0),k=o.useRef(0),S=(0,d.useExternRef)(i),U=o.useRef(null),x=o.useRef(null),M=e=>{const t=e/(L.current-C.current);(e=>{I.current=e,null!==x.current&&(x.current.style[O.current]=`translate(0, ${e}px)`)})((C.current-T.current)*t)},R=()=>{if(!S.current||!U.current||!x.current)return;const e=S.current.clientHeight,t=S.current.scrollHeight,i=e/t,a=Math.max(e*i,40);b.current=i,C.current=e,L.current=t,T.current=a,i>=1?U.current.style.display="none":(U.current.style.display="",x.current.style.height=`${a}px`,M(S.current.scrollTop))},B=(0,n.useEventListener)("resize",R);(0,l.useIsomorphicLayoutEffect)((()=>{c&&w&&B.add(w)}),[c,w]),(0,l.useIsomorphicLayoutEffect)((()=>{var e;let t=null===(e=x.current)||void 0===e?void 0:e.style,i="";void 0!==t&&("transform"in t?i="transform":"webkitTransform"in t&&(i="webkitTransform")),O.current=i}),[]),(0,l.useIsomorphicLayoutEffect)(R);const{trackerVisible:N,onTargetScroll:j,onTrackerDragStart:W,onTrackerDragStop:F,onTrackerMouseEnter:K,onTrackerMouseLeave:H}=(0,u.useTrackerVisibility)(p,h),Y=[(0,n.useEventListener)("mousemove",(e=>{e.preventDefault();const t=e.clientY-D.current;(e=>{const t=e/(C.current-T.current);null!==S.current&&(S.current.scrollTop=(L.current-C.current)*t)})(Math.min(Math.max(k.current+t,0),C.current-T.current))})),(0,n.useEventListener)("mouseup",(e=>{e.preventDefault(),p&&F(),E&&E(),Y.forEach((e=>e.remove()))}))];return(0,a.jsxs)("div",Object.assign({className:(0,s.classNames)(_.default.view,e)},{children:[(0,a.jsx)("div",Object.assign({className:(0,s.classNames)(_.default.barY,"lyrics_CustomScrollView__barY"),ref:U},{children:(0,a.jsx)("div",{className:(0,s.classNames)(_.default.trackerY,!N&&_.default.hidden),onMouseEnter:p?K:void 0,onMouseLeave:p?H:void 0,ref:x,onMouseDown:e=>{var t;e.preventDefault(),D.current=e.clientY,k.current=I.current,p&&W(),v&&v(),(t=m)&&Y.forEach((e=>e.add(t)))}},void 0)}),void 0),(0,a.jsx)("div",Object.assign({className:_.default.box,tabIndex:-1,ref:S,onScroll:()=>{b.current>=1||!S.current||(p&&j(),M(S.current.scrollTop),y&&y())},onWheel:g,onTouchStart:A,onTouchMove:f,onTouchEnd:P},{children:t}),void 0)]}),void 0)}},392844:(e,t,i)=>{"use strict";i.d(t,{useTrackerVisibility:()=>s});var a=i(667294),o=i(855356);const s=(e=!1,t=500)=>{const[i,s]=a.useState(!e),r=a.useRef(!1),l=a.useRef(!1),{set:d,clear:n}=(0,o.useTimeout)((()=>s(!1)),t),u=a.useCallback((()=>{n(),s(!0),l.current=!0}),[n]),_=a.useCallback((()=>{l.current=!1,r.current||d()}),[d,r]),c=a.useCallback((()=>{l.current||(s(!0),d())}),[d]);return{trackerVisible:i,onTrackerDragStart:u,onTrackerDragStop:_,onTrackerMouseEnter:a.useCallback((()=>{n(),r.current=!0,s(!0)}),[n]),onTrackerMouseLeave:a.useCallback((()=>{c(),r.current=!1}),[c]),onTargetScroll:a.useCallback((()=>{c()}),[c])}}},914819:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsContainer:()=>d});var a=i(785893),o=i(667294),s=i(548239),r=i(582278),l=i(267150);function d({lines:e,credits:t,compensationTop:i,height:d,width:n}){const{audio:u,player:{isPlaying:_,isCurrentAudio:c,progress:{ms:p,duration:h},actions:{changeProgress:g}}}=(0,r.useAudioLyricsModalStore)(),y=(0,o.useMemo)((()=>{var t;return null===(t=e.karaoke)||void 0===t?void 0:t.map((e=>c?Object.assign(Object.assign({},e),{changeProgress:()=>{const t=e.begin/(1e3*h);g(t),s.AudioLyricsStatCollector.ensure().changeAudioProgressByLine(u)}}):e))}),[e.karaoke,c,u,h]);if(y)return(0,a.jsx)(l.KaraokeAudioLyrics,{lines:y,credits:t,timeMs:p,isPlaying:_,compensationTop:i,height:d,width:n},void 0);const A=e.static||e.ugc;return A?(0,a.jsx)(l.StaticAudioLyrics,{lines:A,credits:t,compensationTop:i,height:d,width:n},void 0):null}},141337:(e,t,i)=>{"use strict";i.r(t),i.d(t,{AudioLyricsModalApplication:()=>l});var a=i(785893),o=i(99656),s=i(727764),r=i(582278);function l({audioPlayer:e,audio:t,playlist:i,context:l,onClosed:d}){return(0,a.jsx)(o.AppRootProvider,Object.assign({mode:"partial"},{children:(0,a.jsx)(r.AudioLyricsModalStoreProvider,Object.assign({audio:t,playlist:i,context:l,audioPlayer:e},{children:(0,a.jsx)(s.AudioLyricsModalContainer,{onClosed:d},void 0)}),void 0)}),void 0)}},727764:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsModalContainer:()=>d});var a=i(785893),o=i(588986),s=i(630719),r=i(71316),l=i(148313);function d(e){return(0,a.jsx)(l.AudioLyricsModal,{header:(0,a.jsx)(o.AudioLyricsModalHeaderContainer,{},void 0),content:(0,a.jsx)(s.AudioLyricsModalContentContainer,{},void 0),player:(0,a.jsx)(r.AudioLyricsPlayerContainer,{},void 0),onClose:e.onClosed},void 0)}},630719:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsModalContentContainer:()=>u});var a=i(785893),o=i(86894),s=i(914819),r=i(582278),l=i(737590),d=i(677245),n=i(962707);function u(){const{lyrics:{isLoading:e,isError:t,data:i,actions:{fetchCurrent:u}},player:{isAds:_}}=(0,r.useAudioLyricsModalStore)();return _?(0,a.jsx)(d.AudioLyricsAds,{},void 0):e?(0,a.jsx)(o.Spinner,{size:"large"},void 0):t?(0,a.jsx)(n.AudioLyricsError,{onRetryClick:u},void 0):i?(0,a.jsx)(s.AudioLyricsContainer,{lines:i.lines,credits:i.credits,compensationTop:24,height:"100%",width:"100%"},void 0):(0,a.jsx)(l.AudioLyricsNotFound,{},void 0)}},588986:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsModalHeaderContainer:()=>l});var a=i(785893),o=i(405894),s=i(709459),r=i(582278);function l(){const{audioObject:e}=(0,r.useAudioLyricsModalStore)();return(0,a.jsx)(s.AudioLyricsModalHeader,{title:(0,o.decodeHTML)(e.title||""),performer:(0,o.decodeHTML)(e.performer||""),explicit:e.isExplicit,coverUrl:e.coverUrl_s||void 0},void 0)}},603667:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsModalStoreProvider:()=>_});var a=i(785893),o=i(667294),s=i(624715),r=i(552378),l=i(430727),d=i(516341),n=i(915282),u=i(10215);function _({audioPlayer:e,audio:t,playlist:i,context:_,children:c}){const[p,h]=(0,o.useState)(t),g=(0,o.useMemo)((()=>(0,s.audioTupleToAudioObject)(p)),[p]),y=(0,r.usePlayerStore)({audioPlayer:e,audio:p,playlist:i,context:_,setAudio:h}),A=(0,l.useLyricsStore)({audioPlayer:e,audio:p,prevAudio:y.prevAudio,nextAudio:y.nextAudio}),f=(0,o.useMemo)((()=>({player:y,lyrics:A,audio:p,audioObject:g,audioPlayer:e})),[y,A,p,g,e]);return(0,d.usePrefetchEffect)(f),(0,n.useMountEventsEffect)(f),(0,a.jsx)(u.AudioLyricsModalStoreContext.Provider,Object.assign({value:f},{children:c}),void 0)}},10215:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsModalStoreContext:()=>o,useAudioLyricsModalStore:()=>s});var a=i(442370);const{Context:o,useContext:s}=(0,a.makeStrictContext)({name:"AudioLyricsModalStore"})},582278:(e,t,i)=>{"use strict";i.d(t,{useAudioLyricsModalStore:()=>a.useAudioLyricsModalStore,AudioLyricsModalStoreProvider:()=>o.AudioLyricsModalStoreProvider});var a=i(10215),o=i(603667)},785069:(e,t,i)=>{"use strict";i.d(t,{useLyricsActions:()=>s});var a=i(667294),o=i(429904);function s({audioPlayer:e,audio:t,prevAudio:i,nextAudio:s}){const r=(0,o.useEventCallback)((()=>{e.lyrics.fetch(t)})),l=(0,o.useEventCallback)((()=>{i&&e.lyrics.fetch(i)})),d=(0,o.useEventCallback)((()=>{s&&e.lyrics.fetch(s)}));return(0,a.useMemo)((()=>({fetchCurrent:r,fetchPrev:l,fetchNext:d})),[r,l,d])}},430727:(e,t,i)=>{"use strict";i.d(t,{useLyricsStore:()=>l});var a=i(667294),o=i(770328),s=i(563234),r=i(785069);function l({audioPlayer:e,audio:t,prevAudio:i,nextAudio:l}){const[d,n]=(0,a.useState)((()=>e.lyrics.get((0,o.getAudioTupleFullId)(t))));(0,a.useEffect)((()=>{const i=(0,o.getAudioTupleFullId)(t);e.lyrics.fetch(t),n(e.lyrics.get(i));const a=e.lyrics.listen(i,n);return()=>{a()}}),[t]);const u=(0,r.useLyricsActions)({audioPlayer:e,audio:t,prevAudio:i,nextAudio:l});return(0,a.useMemo)((()=>{const{status:e,data:t}=d;return{isLoading:e===s.EAudioLyricsStatus.Loading||e===s.EAudioLyricsStatus.Pending,isError:e===s.EAudioLyricsStatus.Error,data:t||null,actions:u}}),[d])}},341018:(e,t,i)=>{"use strict";i.d(t,{useAdjacentAudios:()=>s});var a=i(667294),o=i(137894);function s({audioPlayer:e,audio:t}){const i=(0,o.useMountedStateRef)(),s=(0,a.useRef)(null),[r,l]=(0,a.useState)(null),[d,n]=(0,a.useState)(null);return(0,a.useEffect)((()=>{const a=e.getPlaylistQueue(),o=e.isRepeatAll();s.current=t,Promise.all([a.getPrevAudio(t,{ignoreClaimed:!0,repeat:o}).catch((()=>null)),a.getNextAudio(t,{ignoreClaimed:!0,repeat:o}).catch((()=>null))]).then((([e,a])=>{i.current&&s.current===t&&(l(e),n(a))}))}),[t]),[r,d]}},423390:(e,t,i)=>{"use strict";i.d(t,{useAdsState:()=>s});var a=i(667294),o=i(937884);function s({audioPlayer:e}){const[t,i]=(0,a.useState)((()=>{var t;return!!(null===(t=e.ads)||void 0===t?void 0:t.isPlaying())}));return(0,a.useEffect)((()=>{const t=e.on(null,o.AudioPlayerEventType.AD_STARTED,(()=>{i(!0)})),a=e.on(null,o.AudioPlayerEventType.AD_COMPLETED,(()=>{i(!1)}));return()=>{t(),a()}}),[]),t}},895133:(e,t,i)=>{"use strict";i.d(t,{usePlayerActions:()=>o});var a=i(429904);function o({audioPlayer:e,audio:t,playlist:i,context:o,isPlaying:s,isCurrentAudio:r}){return{togglePlaying:(0,a.useEventCallback)((()=>{s?e.pause():r?e.play():e.play(t,i,o)})),playPrev:(0,a.useEventCallback)((()=>{e.playPrev()})),playNext:(0,a.useEventCallback)((()=>{e.playNext()})),changeProgress:(0,a.useEventCallback)((t=>{var i;r&&!(null===(i=e.ads)||void 0===i?void 0:i.isPlaying())&&e.seek(t)}))}}},41779:(e,t,i)=>{"use strict";i.d(t,{usePlayerProgress:()=>l});var a=i(667294),o=i(708284),s=i(624715),r=i(937884);function l({audioPlayer:e,audio:t,isCurrentAudio:i,isAds:l}){const[d,n]=(0,a.useState)((()=>i?l?e.ads.getCurrentProgress():e.getCurrentProgress():0)),[u,_]=(0,a.useState)((()=>!i||l?0:e.getCurrentBuffered())),[c,p]=(0,a.useState)((()=>i?(0,s.audioTupleToAudioObject)(t).duration:0));(0,a.useLayoutEffect)((()=>{p(i?(0,s.audioTupleToAudioObject)(t).duration:0)}),[i,t]),(0,a.useLayoutEffect)((()=>{_(i&&!l?e.getCurrentBuffered():0)}),[i,l,e]),(0,a.useEffect)((()=>{if(!i)return;const t=e.on(null,r.AudioPlayerEventType.PROGRESS,((e,t,i)=>{n(t),p(i)})),a=e.on(null,r.AudioPlayerEventType.BUFFERED,((e,t)=>{_(t)}));return()=>{t(),a()}}),[i,t,e]);const h=Math.round(d*c*1e3);return{time:(0,o.formatAudioTime)({progress:d,duration:c}),progress:d,buffered:u,duration:c,ms:h}}},552378:(e,t,i)=>{"use strict";i.d(t,{usePlayerStore:()=>u});var a=i(667294),o=i(937884),s=i(624715),r=i(423390),l=i(341018),d=i(41779),n=i(895133);function u({audioPlayer:e,audio:t,playlist:i,context:u,setAudio:_}){const c=e,[p,h]=(0,a.useState)((()=>c.getCurrentAudio())),[g,y]=(0,l.useAdjacentAudios)({audioPlayer:e,audio:t}),A=(0,a.useMemo)((()=>(0,s.audioTupleToAudioObject)(t)),[t]),f=(0,a.useMemo)((()=>{if(!p)return!1;return(0,s.audioTupleToAudioObject)(p).fullId===A.fullId}),[A,p]),[P,v]=(0,a.useState)(f),[E,m]=(0,a.useState)((()=>f&&c.isPlaying()));(0,a.useLayoutEffect)((()=>{v((e=>e||f))}),[f]),(0,a.useEffect)((()=>c.on(null,o.AudioPlayerEventType.CURRENT_CHANGED,(()=>{const e=c.getCurrentAudio();h(e),P&&_(e)}))),[P]);const w=P&&f;(0,a.useEffect)((()=>{if(!w)return void m(!1);const e=c.on(null,o.AudioPlayerEventType.PLAY,(()=>{m(!0)})),t=c.on(null,o.AudioPlayerEventType.PAUSE,(()=>{m(!1)})),i=c.on(null,o.AudioPlayerEventType.STOP,(()=>{m(!1)}));return()=>{e(),t(),i()}}),[w]);const b=(0,r.useAdsState)({audioPlayer:e}),I=(0,d.usePlayerProgress)({audio:t,isCurrentAudio:f,isAds:b,audioPlayer:e}),C=(0,n.usePlayerActions)({audioPlayer:e,audio:t,playlist:i,context:u,isCurrentAudio:f,isPlaying:E});return(0,a.useMemo)((()=>({isPlaying:E,isPlayingMode:P,isAds:b,isCurrentAudio:f,prevAudio:g,nextAudio:y,progress:I,actions:C})),[I,C,E,P,b,f])}},915282:(e,t,i)=>{"use strict";i.d(t,{useMountEventsEffect:()=>r});var a=i(667294),o=i(667358),s=i(548239);function r(e){const t=(0,o.useValueRef)(e);(0,a.useEffect)((()=>(s.AudioLyricsStatCollector.ensure().open(e.audio),()=>{s.AudioLyricsStatCollector.ensure().close(t.current.audio)})),[])}},516341:(e,t,i)=>{"use strict";i.d(t,{usePrefetchEffect:()=>o});var a=i(667294);function o(e){const{player:t,lyrics:i}=e,{progress:o}=t,s=o.duration-o.progress*o.duration<5;(0,a.useEffect)((()=>{s&&i.actions.fetchNext()}),[s])}},71316:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsPlayerContainer:()=>r});var a=i(785893),o=i(455434),s=i(582278);function r(){const{player:{actions:e,isPlaying:t,isPlayingMode:i,isAds:r,progress:l,nextAudio:d},lyrics:{actions:n}}=(0,s.useAudioLyricsModalStore)();return(0,a.jsx)(o.AudioLyricsPlayer,{time:l.time,progress:l.progress,buffered:l.buffered,isPlaying:t,isAds:r,sliderDisabled:!i,prevDisabled:!i||r,nextDisabled:!i||r||!d,onPlayPrev:()=>{n.fetchPrev(),e.playPrev()},onPlayNext:()=>{n.fetchNext(),e.playNext()},onTogglePlaying:()=>{e.togglePlaying()},onChangeProgress:e.changeProgress},void 0)}},379146:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsOnboardingController:()=>l});var a=i(182804),o=i(624715),s=i(937884),r=i(506404);class l{constructor({audioPlayer:e}){this.unlistenAudio=null,this.registered=!1,this.audioPlayer=e,this.setStartupHandlers()}destroy(){this.closeTooltip()}setStartupHandlers(){try{(0,a.tq)().setStartupHandler("Audio/Player/LyricsButton/OnboardinHint",(e=>{if(this.registered)return;const{target:t,data:i}=e.payload;if(!t)throw new Error("Target is not defined");const{tooltip:a}=(0,r.helpHintTooltip)(t,{content:i.content,helpHintHash:i.hash,helpHintId:i.id},{width:"215px",offset:[0,8],forceSide:"bottom",align:"right",appendToParent:!0,withCloseButton:!0,autoAdjustToViewport:!0,noAutoHideOnWindowClick:!0});this.tooltip=a,this.listenAudio()}))}catch(e){}}listenAudio(){if(this.unlistenAudio)return;const{audioPlayer:e}=this,t=e=>{if(!e)return!1;return!!(0,o.audioTupleToAudioObject)(e).hasLyrics&&(this.openTooltip(),this.unlistenAudio&&(this.unlistenAudio(),this.unlistenAudio=null),!0)};t(e.getCurrentAudio())||(this.unlistenAudio=e.on(null,s.AudioPlayerEventType.CURRENT_CHANGED,t))}openTooltip(){const{tooltip:e}=this;e&&e.show()}closeTooltip(){const{tooltip:e}=this;e&&e.hide()}}},548239:(e,t,i)=>{"use strict";i.d(t,{AudioLyricsStatCollector:()=>l});var a=i(214547),o=i(556750),s=i(722904);let r=null;class l{constructor(){this.productionCollector=new a.ProductionStatCollector,this.actionCollector=new a.ActionStatCollector(this.productionCollector)}static ensure(){return r||(r=new l),r}open(e){this.logEvent(this.createEventItem(o.EAudioLyricsEventType.SHOW,e))}close(e){this.logEvent(this.createEventItem(o.EAudioLyricsEventType.HIDE,e))}changeAudioProgressByLine(e){this.logEvent(this.createEventItem(o.EAudioLyricsEventType.GO_TO_TIMECODE,e))}logEvent(e){this.actionCollector.logEvent({type:o.EVENT_ITEM_TYPE,[o.EVENT_ITEM_TYPE]:e})}createEventItem(e,t){return{event_type:e,item:{id:t[s.EAudioTupleIndex.ID],owner_id:t[s.EAudioTupleIndex.OWNER_ID]}}}}},817608:(e,t,i)=>{"use strict";i.d(t,{AudioPlayerLyricsUI:()=>r});var a=i(506770),o=i(691180),s=i(379146);class r{constructor({audioPlayer:e}){this.audioPlayer=e,this.modal=new o.AudioLyricsModalController({audioPlayer:e}),this.onboarding=new s.AudioLyricsOnboardingController({audioPlayer:e})}open(e){this.enabled&&(this.audioPlayer.lyrics.fetch(e.audio),this.modal.open(e))}get enabled(){return(0,a.partConfigEnabled)("audio_use_web_new_version_lyrics")}}},352547:(e,t,i)=>{"use strict";i.r(t);var a=i(729891),o=i(152278),s=i(873589),r=i(376504),l=i(342269);const d="audio-msg-track--transcriptToggle",n="audio-msg-track--transcript_on";let u=null;function _(e){let t=(0,s.geByClass)("audio-msg-track--wave-wrapper",e),i=0;for(let e=0;e<t.length;e++){try{i=parseInt(window.getComputedStyle(t[e],null).getPropertyValue("width"))}catch(a){i=parseInt(t[e].currentStyle.width)}if(i>0)break}return i}function c(e,t){t=Math.round(t),e.length!=t&&(e=(0,r.fastResample)(e,t));let i="",a=0;for(let t=0;t<e.length;t++)a=Math.floor(10*Number(e[t])*.95),0==a&&(a=.5),i+="M"+(3*t+1)+","+(10-a)+"v"+2*a+"Z";return`<svg class="audio-msg-track--wave" width="${3*e.length}px"><path d="${i}"></path></svg>`}function p(){let e=(0,s.geByClass)("audio-msg-track");for(let t=0;t<e.length;t++){let i=(0,s.attr)(e[t],"data-wave");(0,s.hasClass)(e[t],"audio-msg-player")&&t>0&&(i=(0,s.attr)(e[t-1],"data-wave"));let a=_(e[t]);if(i&&a){i=i.split(",");let o=(0,s.geByClass)("audio-msg-track--wave",e[t]),r=c(i,a/3);for(let e=0;e<o.length;e++){let t=(0,s.ce)("div",{innerHTML:r}).firstChild;o[e].parentNode.replaceChild(t,o[e])}}}}function h(){if(!u){const e='<div class="audio-msg-player audio-msg-track"><button class="audio-msg-track--btn"></button>'+(0,l.getTemplate)("sImAudioMsgPlayerASRToggle")+'<div class="audio-msg-track--duration"></div><div class="audio-msg-track--wave-wrapper"><div class="audio-msg-track--slider"></div></div></div>',t="audio-msg-track--with-asr-toggle",i="audio-msg-track--shortened";u=new a.VoiceMessagePlayer({onListened:e=>{window.AudioMessagePlayer.events.emit("listened",e)},voiceMessageHTML:e,onInit:(e,a)=>{var o,s;e.classList.contains(t)&&a.classList.add(t),e.classList.contains(i)&&a.classList.add(i),(null===(o=e.querySelector(`.${d}`))||void 0===o?void 0:o.classList.contains(n))&&(null===(s=a.querySelector(`.${d}`))||void 0===s||s.classList.add(n)),window.AudioMessagePlayer.events.emit("initialized",e)},onPlay:e=>{window.AudioMessagePlayer.events.emit("playing",e)},onPause:e=>{window.AudioMessagePlayer.events.emit("paused",e)},onEnd:e=>{window.AudioMessagePlayer.events.emit("finished",e)},onProgress:(e,t)=>{window.AudioMessagePlayer.events.emit("progress",e,t)},fcOnPause:e=>{window.AudioMessagePlayer.events.emit("fc_paused",e)}})}return u}(0,o.addEvent)(window,"orientationchange",(()=>setTimeout(p,500))),window.mail&&window.mail.onMessagesRepainted&&(window.onDOMReady(p),window.mail.onMessagesRepainted(p)),window.AudioMessagePlayer={loaded:!0,events:new EventEmitter,togglePlay:function(e){let t=h(),i=t.attachTo(e);!0===i?t.play():i.then((()=>{t.play()}))},toggle:function(){h().toggle()},seek:function(e){h().seek(e)},detachPlayer:function(e){h().detach(e)},pauseGlobalMedia:function(){a.VoiceMessagePlayer.pauseGlobalMedia()},resumeGlobalMedia:function(){a.VoiceMessagePlayer.resumeGlobalMedia()},redrawWaves:p,getWave:c,toggleTranscript:function(e,t){(0,o.cancelEvent)(t),e.classList.toggle(n),this.events.emit("transcription_toggle",e)}}},842776:(e,t,i)=>{"use strict";i.d(t,{WebMediaSessionAdapter:()=>o});var a=i(570655);class o{constructor(e){this.player=e,this.player.eventBus&&(this.subscriptions=this.player.eventBus.subscriptions),this.ads=this.player.ads}play(){return this.player.play()}pause(){return this.player.pause()}isPlaying(){const e=this.player.getCurrentPlaylist();return!!(null==e?void 0:e.isLive)&&e.isLive()||!1}getPrevAudio(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this.player.getPrevAudio()}))}getNextAudio(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){return this.player.getNextAudio()}))}next(){return this.player.playNext()}prev(){return this.player.playPrev()}seek(e){return this.player.seek(e)}getCurrentPlaylist(){return this.player.getCurrentPlaylist()}subscribe(e,t){var i;return null===(i=this.player.eventBus)||void 0===i?void 0:i.subscribe(e,t)}unsubscribe(e,t){var i;return null===(i=this.player.eventBus)||void 0===i?void 0:i.unsubscribe(e,t)}getCurrentAudio(){return this.player.getCurrentAudio()}getCurrentProgress(){return this.player.getCurrentProgress()}}},405507:e=>{"use strict";e.exports=JSON.parse('{"v":"4.8.0","ip":0,"op":31,"fr":30,"w":34,"h":24,"nm":"d","assets":[],"layers":[{"ind":1,"ty":4,"nm":"0","sr":1,"ks":{"o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[6.97,11.66,0]},"a":{"a":0,"k":[-30.886,-653.921,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"R","bm":0,"it":[{"ty":"rc","nm":"R","d":1,"s":{"a":1,"k":[{"i":{"x":[0,0],"y":[1,1]},"o":{"x":[0,0],"y":[0,0]},"t":0,"s":[18,18]},{"t":30,"s":[36,18]}]},"p":{"a":1,"k":[{"i":{"x":0,"y":1},"o":{"x":0,"y":0},"t":0,"s":[-9,0]},{"t":30,"s":[0,0]}]},"r":{"a":0,"k":10}},{"ty":"fl","nm":"F","bm":0,"c":{"a":0,"k":[0,0,0,1]},"o":{"a":0,"k":100},"r":1},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[-30.886,-653.921]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]}],"ip":0,"op":31,"st":0},{"ind":2,"ty":4,"nm":"0","sr":1,"ks":{"o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[6.97,11.66,0]},"a":{"a":0,"k":[-30.886,-653.921,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"R","bm":0,"it":[{"ty":"rc","nm":"R","d":1,"s":{"a":1,"k":[{"i":{"x":[0,0],"y":[1,1]},"o":{"x":[0,0],"y":[0,0]},"t":0,"s":[36,18]},{"t":30,"s":[24,18]}]},"p":{"a":1,"k":[{"i":{"x":0,"y":1},"o":{"x":0,"y":0},"t":0,"s":[0,0]},{"t":30,"s":[39,0]}]},"r":{"a":0,"k":10}},{"ty":"fl","nm":"F","bm":0,"c":{"a":0,"k":[0,0,0,1]},"o":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[100]},{"t":30,"s":[50]}]},"r":1},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[-30.886,-653.921]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]}],"ip":0,"op":31,"st":0},{"ind":3,"ty":4,"nm":"0","sr":1,"ks":{"o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[6.97,11.66,0]},"a":{"a":0,"k":[-30.886,-653.921,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"R","bm":0,"it":[{"ty":"rc","nm":"R","d":1,"s":{"a":1,"k":[{"i":{"x":[0,0],"y":[1,1]},"o":{"x":[0,0],"y":[0,0]},"t":0,"s":[24,18]},{"t":30,"s":[18,18]}]},"p":{"a":1,"k":[{"i":{"x":0,"y":1},"o":{"x":0,"y":0},"t":0,"s":[39,0]},{"t":30,"s":[69,0]}]},"r":{"a":0,"k":10}},{"ty":"fl","nm":"F","bm":0,"c":{"a":0,"k":[0,0,0,1]},"o":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[50]},{"t":30,"s":[15]}]},"r":1},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[-30.886,-653.921]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]}],"ip":0,"op":31,"st":0},{"ind":4,"ty":4,"nm":"0","sr":1,"ks":{"o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[6.97,11.66,0]},"a":{"a":0,"k":[-30.886,-653.921,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"R","bm":0,"it":[{"ty":"rc","nm":"R","d":1,"s":{"a":0,"k":[18,18]},"p":{"a":0,"k":[69,0]},"r":{"a":0,"k":10}},{"ty":"fl","nm":"F","bm":0,"c":{"a":0,"k":[0,0,0,1]},"o":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[15]},{"t":30,"s":[0]}]},"r":1},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[-30.886,-653.921]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]}],"ip":0,"op":31,"st":0}],"markers":[]}')},383047:e=>{"use strict";e.exports=JSON.parse('{"v":"4.8.0","ip":0,"op":121,"fr":30,"w":34,"h":24,"nm":"n","assets":[],"layers":[{"ind":1,"ty":4,"nm":"l","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0],"y":[0]},"t":100,"s":[100]},{"t":110,"s":[0]}]},"r":{"a":0,"k":90},"p":{"a":0,"k":[18.539,11.699,0]},"a":{"a":0,"k":[4.527,1.49,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"2","bm":0,"it":[{"ty":"sh","nm":"P","ind":0,"ks":{"k":{"i":[[0,0],[0,0]],"o":[[0,0],[0,0]],"v":[[4.501,-32.747],[4.516,44.228]],"c":false},"a":0}},{"ty":"st","nm":"S","bm":0,"lc":2,"lj":3,"o":{"a":0,"k":100},"w":{"a":0,"k":18},"c":{"a":0,"k":[0,0,0,1]}},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]},{"ty":"tm","nm":"T","s":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":95,"s":[50]},{"t":105,"s":[0]}]},"e":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":100,"s":[50]},{"t":110,"s":[1]}]},"o":{"a":0,"k":0},"m":2}],"ip":95,"op":111,"st":92},{"ind":2,"ty":4,"nm":"l","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0],"y":[0]},"t":100,"s":[100]},{"t":110,"s":[0]}]},"r":{"a":0,"k":90},"p":{"a":0,"k":[18.539,11.699,0]},"a":{"a":0,"k":[4.527,1.49,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"2","bm":0,"it":[{"ty":"sh","nm":"P","ind":0,"ks":{"k":{"i":[[0,0],[0,0]],"o":[[0,0],[0,0]],"v":[[4.501,-32.747],[4.516,44.228]],"c":false},"a":0}},{"ty":"st","nm":"S","bm":0,"lc":2,"lj":3,"o":{"a":0,"k":100},"w":{"a":0,"k":18},"c":{"a":0,"k":[0,0,0,1]}},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]},{"ty":"tm","nm":"T","s":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":100,"s":[50]},{"t":110,"s":[99]}]},"e":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":95,"s":[50]},{"t":105,"s":[100]}]},"o":{"a":0,"k":0},"m":2}],"ip":95,"op":111,"st":92},{"ind":3,"ty":4,"nm":"N","sr":1,"ks":{"o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[17.653,12.216,0]},"a":{"a":0,"k":[1.921,1.634,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"2","bm":0,"it":[{"ty":"sh","nm":"P","ind":0,"ks":{"k":{"i":[[0,0],[0,0]],"o":[[0,0],[0,0]],"v":[[4.526,26.978],[4.528,-23.372]],"c":false},"a":0}},{"ty":"sh","nm":"P","ind":1,"ks":{"k":{"i":[[0,0],[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0],[0,0]],"v":[[4.528,-23.372],[4.497,-19.52],[2.461,-15.732],[-0.906,-14.009],[-9.719,-14]],"c":false},"a":0}},{"ty":"st","nm":"S","bm":0,"lc":1,"lj":2,"o":{"a":0,"k":100},"w":{"a":0,"k":8},"c":{"a":0,"k":[0,0,0,1]}},{"ty":"tm","nm":"T","s":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":67,"s":[36]},{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":77,"s":[0]},{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":90,"s":[0]},{"t":100,"s":[36]}]},"e":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":67,"s":[36]},{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":77,"s":[100]},{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":90,"s":[100]},{"t":100,"s":[36]}]},"o":{"a":0,"k":0},"m":2},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]}],"ip":60,"op":121,"st":60},{"ind":4,"ty":4,"nm":"N","sr":1,"ks":{"o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[17.653,12.216,0]},"a":{"a":0,"k":[1.921,1.634,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"2","bm":0,"it":[{"ty":"sh","nm":"P","ind":0,"ks":{"k":{"i":[[3.84,11.664],[-0.855,4.89],[0,0],[-10.5,0],[0,-5.375],[0,0],[0,0],[0,0],[0,0],[0,0]],"o":[[-1.903,-5.78],[0.639,-3.656],[0,0],[9.376,0],[0,6.812],[0,0],[0,0],[0,0],[0,0],[0,0]],"v":[[-12.75,14.062],[-12.201,-2.907],[-10.875,-9.5],[1.125,-20.453],[14.438,-9.875],[9.805,0.862],[-11.867,21.133],[-7.828,22.906],[-14.437,23],[18.871,22.98]],"c":false},"a":0}},{"ty":"st","nm":"S","bm":0,"lc":1,"lj":3,"o":{"a":0,"k":100},"w":{"a":0,"k":8},"c":{"a":0,"k":[0,0,0,1]}},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]},{"ty":"tm","nm":"T","s":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":38,"s":[0]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0],"y":[0]},"t":50,"s":[16]},{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":60,"s":[16]},{"t":70,"s":[53]}]},"e":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":30,"s":[0]},{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":50,"s":[100]},{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":60,"s":[100]},{"t":70,"s":[53]}]},"o":{"a":0,"k":0},"m":2}],"ip":30,"op":71,"st":30},{"ind":5,"ty":4,"nm":"N","sr":1,"ks":{"o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[17.653,12.216,0]},"a":{"a":0,"k":[1.921,1.634,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"N","bm":0,"it":[{"ty":"sh","nm":"P","ind":0,"ks":{"k":{"i":[[0,0],[-12,0],[0,0],[-10.5,0],[0,-5.375],[0,0],[0,0],[0,0],[0,-9.875],[8.172,0],[0,0]],"o":[[0,0],[12,0],[0,0],[9.376,0],[0,9.125],[0,0],[0,0],[0,0],[0,6.625],[-11.875,0],[0,0]],"v":[[-38.562,0],[-23.062,0],[-10.875,-10.875],[1.125,-20.453],[14.094,-9.875],[4.93,0.925],[-3.875,1],[4.996,0.918],[14.75,12.75],[2.25,24.25],[-12.875,13.375]],"c":false},"a":0}},{"ty":"tm","nm":"T","s":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[0]},{"i":{"x":[0],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":20,"s":[24]},{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":30,"s":[24]},{"t":38,"s":[97]}]},"e":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[11]},{"t":20,"s":[97]}]},"o":{"a":0,"k":0},"m":1},{"ty":"st","nm":"S","bm":0,"lc":2,"lj":3,"o":{"a":0,"k":100},"w":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[18]},{"t":20,"s":[8]}]},"c":{"a":0,"k":[0,0,0,1]}},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]},{"ty":"gr","nm":"N","bm":0,"it":[{"ty":"sh","nm":"P","ind":0,"ks":{"k":{"i":[[0,0],[-12,0],[0,0],[-10.5,0],[0,-5.375],[0,0],[0,0],[0,0],[0,-9.875],[8.172,0],[0,0]],"o":[[0,0],[12,0],[0,0],[9.376,0],[0,9.125],[0,0],[0,0],[0,0],[0,6.625],[-11.875,0],[0,0]],"v":[[-38.562,0],[-23.062,0],[-10.875,-10.875],[1.125,-20.453],[14.094,-9.875],[4.93,0.925],[-3.875,1],[4.996,0.918],[14.75,12.75],[2.25,24.25],[-12.875,13.375]],"c":false},"a":0}},{"ty":"tm","nm":"T","s":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[0]},{"i":{"x":[0],"y":[1]},"o":{"x":[0.167],"y":[0]},"t":20,"s":[21]},{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":30,"s":[21]},{"t":40,"s":[100]}]},"e":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[11]},{"t":20,"s":[100]}]},"o":{"a":0,"k":0},"m":1},{"ty":"st","nm":"S","bm":0,"lc":1,"lj":3,"o":{"a":0,"k":100},"w":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[18]},{"t":20,"s":[8]}]},"c":{"a":0,"k":[0,0,0,1]}},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]}],"ip":0,"op":121,"st":0},{"ind":6,"ty":4,"nm":"0","sr":1,"ks":{"o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[6.97,11.66,0]},"a":{"a":0,"k":[-30.886,-653.921,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"R","bm":0,"it":[{"ty":"rc","nm":"R","d":1,"s":{"a":1,"k":[{"i":{"x":[0,0],"y":[1,1]},"o":{"x":[0,0],"y":[0,0]},"t":0,"s":[24,18]},{"t":20,"s":[18,18]}]},"p":{"a":1,"k":[{"i":{"x":0,"y":1},"o":{"x":0,"y":0},"t":0,"s":[39,0]},{"t":20,"s":[69,0]}]},"r":{"a":0,"k":10}},{"ty":"fl","nm":"F","bm":0,"c":{"a":0,"k":[0,0,0,1]},"o":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[50]},{"t":20,"s":[0]}]},"r":1},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[-30.886,-653.921]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]}],"ip":0,"op":121,"st":0},{"ind":7,"ty":4,"nm":"0","sr":1,"ks":{"o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[6.97,11.66,0]},"a":{"a":0,"k":[-30.886,-653.921,0]},"s":{"a":0,"k":[34,34,100]}},"shapes":[{"ty":"gr","nm":"R","bm":0,"it":[{"ty":"rc","nm":"R","d":1,"s":{"a":0,"k":[18,18]},"p":{"a":0,"k":[69,0]},"r":{"a":0,"k":10}},{"ty":"fl","nm":"F","bm":0,"c":{"a":0,"k":[0,0,0,1]},"o":{"a":1,"k":[{"i":{"x":[0],"y":[1]},"o":{"x":[0],"y":[0]},"t":0,"s":[15]},{"t":20,"s":[0]}]},"r":1},{"ty":"tr","o":{"a":0,"k":100},"r":{"a":0,"k":0},"p":{"a":0,"k":[-30.886,-653.921]},"a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"nm":"T","sk":{"a":0,"k":0},"sa":{"a":0,"k":0}}]}],"ip":0,"op":121,"st":0}],"markers":[]}')}}]);try{stManager.done("dist/audioplayer.d2c3894127499337c9bf.js")}catch(e){}